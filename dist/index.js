!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}([function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(36),a=function(e){function t(){var t=e.call(this)||this;return t.cursorStyle=null,t._x=0,t._y=0,t._z=1,t._sx=1,t._sy=1,t._sz=1,t._w=0,t._h=0,t._layoutX=0,t._layoutY=0,t._layoutParentX=0,t._layoutParentY=0,t._layoutW=0,t._layoutH=0,t.interactionEventListenerCount=null,t.worldTransformNeedsUpdate=!0,t.worldTransformMat4=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),t.computedX=0,t.computedY=0,t.computedWidth=0,t.computedHeight=0,t.eventEmitter=new i.EventEmitter,t.resetEventListenerCount(),t.render=!1,t}return r(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(e){this._z=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sx",{get:function(){return this._sx},set:function(e){this._sx=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sy",{get:function(){return this._sy},set:function(e){this._sy=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sz",{get:function(){return this._sz},set:function(e){this._sz=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._w},set:function(e){this._w=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"h",{get:function(){return this._h},set:function(e){this._h=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutX",{get:function(){return this._layoutX},set:function(e){this._layoutX=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutY",{get:function(){return this._layoutY},set:function(e){this._layoutY=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutParentX",{get:function(){return this._layoutParentX},set:function(e){this._layoutParentX=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutParentY",{get:function(){return this._layoutParentY},set:function(e){this._layoutParentY=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutW",{get:function(){return this._layoutW},set:function(e){this._layoutW=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutH",{get:function(){return this._layoutH},set:function(e){this._layoutH=e,this.worldTransformNeedsUpdate=!0},enumerable:!0,configurable:!0}),t.prototype.add=function(t){e.prototype.add.call(this,t),t.worldTransformNeedsUpdate=!0,t.onAdded()},t.prototype.remove=function(t){if(!e.prototype.remove.call(this,t))return!1;t.onRemoved()},t.prototype.addEventListener=function(e,t){-1!==Object.keys(this.interactionEventListenerCount).indexOf(e)?this.addInteractionListener(e,t):this.eventEmitter.addListener(e,t)},t.prototype.removeEventListener=function(e,t){-1!==Object.keys(this.interactionEventListenerCount).indexOf(e)?this.removeInteractionListener(e,t):this.eventEmitter.removeListener(e,t)},t.prototype.addInteractionListener=function(e,t){this.eventEmitter.addListener(e,t),this.interactionEventListenerCount[e]++},t.prototype.removeInteractionListener=function(e,t){this.eventEmitter.listenerCount(e)>0&&(this.eventEmitter.removeListener(e,t),this.interactionEventListenerCount[e]--)},t.prototype.removeAllListeners=function(e){var t,n;if(this.eventEmitter.removeAllListeners(),this.resetEventListenerCount(),e)try{for(var r=o(this.children),i=r.next();!i.done;i=r.next()){i.value.removeAllListeners(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},t.prototype.emit=function(e,t){this.eventEmitter.emit(e,t)},t.prototype.applyTransformToSubNodes=function(e){var t,n;void 0===e&&(e=!0),e&&this.worldTransformNeedsUpdate&&(this.computeLayout(0,0),this.applyWorldTransform(null));try{for(var r=o(this.children),i=r.next();!i.done;i=r.next()){var a=i.value;a.worldTransformNeedsUpdate&&(a.computeLayout(this.computedWidth,this.computedHeight),a.applyWorldTransform(this.worldTransformMat4)),a.applyTransformToSubNodes(!1)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},t.prototype.getWorldBounds=function(){var e=this.worldTransformMat4,t=this.getLocalBounds();return{l:e[0]*t.l+e[12],r:e[0]*t.r+e[12],t:e[5]*t.t+e[13],b:e[5]*t.b+e[13]}},t.prototype.getWorldZ=function(){return this.worldTransformMat4[14]},t.prototype.getComputedWidth=function(){return this.computedWidth},t.prototype.getComputedHeight=function(){return this.computedHeight},t.prototype.getComputedX=function(){return this.computedX},t.prototype.getComputedY=function(){return this.computedY},t.prototype.onAdded=function(){},t.prototype.onRemoved=function(){},t.prototype.getLocalBounds=function(){return{l:0,r:this.computedWidth,t:0,b:this.computedHeight}},t.prototype.computeLayout=function(e,t){this.computedWidth=Math.max(this._w+e*this._layoutW,0),this.computedHeight=Math.max(this._h+t*this._layoutH,0),this.computedX=this._x+e*this._layoutParentX+this.computedWidth*this._layoutX,this.computedY=this._y+t*this._layoutParentY+this.computedHeight*this._layoutY},t.prototype.applyWorldTransform=function(e){var t,n,r,i;if(null==e){var a=this.computedX,s=this.computedY;this.worldTransformMat4.set([this._sx,0,0,0,0,this._sy,0,0,0,0,this._sz,0,a,s,this._z,1]),this.worldTransformNeedsUpdate=!1;try{for(var l=o(this.children),u=l.next();!u.done;u=l.next()){u.value.worldTransformNeedsUpdate=!0}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}}else{var c=e,f=c[0]*this._sx,d=c[5]*this._sy,h=c[10]*this._sz,p=c[0]*this.computedX+c[12],v=c[5]*this.computedY+c[13],y=c[10]*this._z+c[14],g=this.worldTransformMat4;g[0]=f,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=d,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=h,g[11]=0,g[12]=p,g[13]=v,g[14]=y,g[15]=1,this.worldTransformNeedsUpdate=!1;try{for(var m=o(this.children),x=m.next();!x.done;x=m.next()){x.value.worldTransformNeedsUpdate=!0}}catch(e){r={error:e}}finally{try{x&&!x.done&&(i=m.return)&&i.call(m)}finally{if(r)throw r.error}}}this.renderOrderZ=this.worldTransformMat4[14]},t.prototype.resetEventListenerCount=function(){this.interactionEventListenerCount={pointermove:0,pointerdown:0,pointerup:0,pointerenter:0,pointerleave:0,click:0,dblclick:0,wheel:0,dragstart:0,dragmove:0,dragend:0}},t}(n(20).Renderable);t.Object2D=a,t.default=a},function(e,t,n){"use strict";var r=n(43),o=n(85),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function s(e){return null!==e&&"object"==typeof e}function l(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),a(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:l,isStream:function(e){return s(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(87);t.Canis=r;var o=n(67);t.SiriusApi=o.SiriusApi;var i=n(66);t.AnnotationTileset=i;var a=n(65);t.EntityType=a.EntityType;var s=n(38);t.QueryType=s.QueryType,t.QueryBuilder=s.QueryBuilder;var l=n(64);t.buildQueryParser=l.buildQueryParser,t.buildVariantQueryParser=l.buildVariantQueryParser;var u=n(37);t.Strand=u.default;var c=n(63);t.Gff3Parser=c.default},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(36),a=n(8),s=function(){function e(e,t,n){void 0===e&&(e=1024),void 0===t&&(t=8),void 0===n&&(n=1/0),this.tileWidth=e,this.tilesPerBlock=t,this.maximumX=n,this.lods=new Array,this.blockSize=e*t}return e.prototype.getTiles=function(e,t,n,r,i){if(e=Math.max(e,0),t=Math.max(t,0),e=Math.min(e,this.maximumX),!((t=Math.min(t,this.maximumX))<=e)){var s=a.default.log2(Math.max(n,1)),l=Math.floor(s);l=this.mapLodLevel(l);for(var u=Math.pow(2,l),c=Math.floor(e/u),f=Math.ceil(t/u),d=this.blockIndex(c),h=this.tileRowIndex(c),p=this.blockIndex(f),v=this.tileRowIndex(f),y=d;y<=p;y++)for(var g=this.getBlock(l,y),m=y===d?h:0,x=y===p?v:this.tilesPerBlock-1,_=m;_<=x;_++){var b=g.rows[_];r&&b.state===o.Empty&&this.loadTilePayload(b),i(b)}}},e.prototype.getTile=function(e,t,n){e=Math.max(e,0),e=Math.min(e,this.maximumX);var r=a.default.log2(Math.max(t,1)),o=Math.floor(r);o=this.mapLodLevel(o);var i=Math.pow(2,o),s=Math.floor(e/i);return this.getTileFromLodX(o,s,n)},e.prototype.isWithinInitializedLodRange=function(e){var t=a.default.log2(Math.max(e,1)),n=Math.floor(t);return(n=this.mapLodLevel(n))>=0&&n<this.lods.length},e.prototype.getBlockPayload=function(e){var t=this.blockIndex(e.lodX),n=this.getBlock(e.lodLevel,t);return null==n.payload&&(n.payload=this.createBlockPayload(e.lodLevel,t,this.tileWidth,this.tilesPerBlock)),n.payload},e.prototype.clear=function(){var e,t;try{for(var n=r(this.lods),o=n.next();!o.done;o=n.next()){var i=o.value;for(var a in i){var s=i[a];void 0!==s&&void 0!==s.payload&&this.releaseBlockPayload(s.payload)}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.lods=new Array},e.prototype.getTilePayload=function(e){return null},e.prototype.createBlockPayload=function(e,t,n,r){return null},e.prototype.releaseBlockPayload=function(e){},e.prototype.mapLodLevel=function(e){return e},e.prototype.getTileFromLodX=function(e,t,n){var r=this.blockIndex(t),i=this.tileRowIndex(t),a=this.getBlock(e,r).rows[i];return n&&a.state===o.Empty&&this.loadTilePayload(a),a},e.prototype.loadTilePayload=function(e){var t=this;e._state=o.Loading;try{var n=this.getTilePayload(e);Promise.resolve(n)===n?n.then(function(n){return t.tileLoadComplete(e,n)}).catch(function(n){return t.tileLoadFailed(e,n)}):this.tileLoadComplete(e,n)}catch(t){this.tileLoadFailed(e,t)}},e.prototype.tileLoadComplete=function(e,t){var n=e;n._payload=t,n._state=o.Complete,n.emitComplete()},e.prototype.tileLoadFailed=function(e,t){var n=e;n._state=o.Empty,n.emitLoadFailed(t),console.warn("Tile payload request failed: "+t,e)},e.prototype.getBlock=function(e,t){var n=this.getBlocks(e),r=this.blockId(t),o=n[r];if(void 0===o){o={lastUsedTimestamp:-1,rows:new Array(this.tilesPerBlock),payload:null};for(var i=t*this.blockSize,a=0;a<this.tilesPerBlock;a++){var s=a*this.tileWidth+i;o.rows[a]=new l(o,e,s,this.tileWidth,a)}n[r]=o}return o},e.prototype.getBlocks=function(e){var t=this.lods[e];return void 0===t&&(t=this.lods[e]={}),t},e.prototype.tileRowIndex=function(e){return Math.floor(e%this.blockSize/this.tileWidth)},e.prototype.blockIndex=function(e){return Math.floor(e/this.blockSize)},e.prototype.blockId=function(e){return e.toString()},e}();t.TileStore=s,function(e){e[e.Empty=0]="Empty",e[e.Loading=1]="Loading",e[e.Complete=2]="Complete"}(o=t.TileState||(t.TileState={}));var l=function(){function e(e,t,n,r,a){this.block=e,this.lodLevel=t,this.lodX=n,this.lodSpan=r,this.blockRowIndex=a,this._state=o.Empty,this.eventEmitter=new i.EventEmitter;var s=Math.pow(2,t);this.x=n*s,this.span=r*s,this.key=this.lodLevel+"_"+this.lodX}return Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"payload",{get:function(){return this._payload},set:function(e){},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){this.eventEmitter.addListener(e,t)},e.prototype.removeEventListener=function(e,t){this.eventEmitter.removeListener(e,t)},e.prototype.markLastUsed=function(){this.block.lastUsedTimestamp=performance.now()},e.prototype.emitComplete=function(){this.eventEmitter.emit("complete",this,this._payload)},e.prototype.emitLoadFailed=function(e){this.eventEmitter.emit("load-failed",this,e)},e}();t.Tile=l,t.default=s},function(e,t,n){"use strict";var r,o,i,a,s=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var u,c,f,d,h,p,v,y=function(){function e(e){var t=this;this.capabilities={vertexArrayObjects:!1,instancing:!1,availableTextureUnits:0},this.vertexStateIds=new T(!0),this.programIds=new T(!0),this.vertexShaderCache=new w(function(e){return t.gl.deleteShader(e)}),this.fragmentShaderCache=new w(function(e){return t.gl.deleteShader(e)}),this.textureUnitUsageCounter=0,this._programCount=0,this._vertexStateCount=0,this._bufferCount=0,this._textureCount=0,this.gl=e,this.extVao=e.getExtension("OES_vertex_array_object"),this.extInstanced=e.getExtension("ANGLE_instanced_arrays");var n=e.getExtension("WEBGL_debug_renderer_info");this.name=e.getParameter(null==n?e.RENDERER:n.UNMASKED_RENDERER_WEBGL);var r=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);this.textureUnitState=new Array(r),this.capabilities.vertexArrayObjects=null!=this.extVao,this.capabilities.instancing=null!=this.extInstanced,this.capabilities.availableTextureUnits=r}return Object.defineProperty(e.prototype,"programCount",{get:function(){return this._programCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertexStateCount",{get:function(){return this._vertexStateCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferCount",{get:function(){return this._bufferCount},enumerable:!0,configurable:!0}),e.prototype.createBuffer=function(e){var t=this.gl,n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e.data||e.size,e.usageHint||f.STATIC),t.bindBuffer(t.ARRAY_BUFFER,null);var r=new g(this,n);return this._bufferCount++,r},e.prototype.createIndexBuffer=function(e){var t=this.gl,n=e.dataType;if(null==n){if(null==e.data)throw"dataType field is required if data is not set";switch(e.data.BYTES_PER_ELEMENT){case 1:n=u.UNSIGNED_BYTE;break;case 2:n=u.UNSIGNED_SHORT;break;case 4:n=u.UNSIGNED_INT}}if(n==u.UNSIGNED_INT&&null==t.getExtension("OES_element_index_uint"))throw"OES_element_index_uint is required but unavailable";var r=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.data||e.size,e.usageHint||f.STATIC),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var o=new m(this,r,n);return this._bufferCount++,o},e.prototype.updateBufferData=function(e,t,n){void 0===n&&(n=0);var r=this.gl,o=e instanceof m?r.ELEMENT_ARRAY_BUFFER:r.ARRAY_BUFFER;this.gl.bindBuffer(o,e.native),this.gl.bufferSubData(o,n,t),this.gl.bindBuffer(o,null)},e.prototype.deleteBuffer=function(e){this.gl.deleteBuffer(e.native),this._bufferCount--},e.prototype.createVertexState=function(e){this.gl;var t,n=this.extVao,r=null!=e.indexBuffer?e.indexBuffer.dataType:null;if(null!=n){var o=n.createVertexArrayOES();n.bindVertexArrayOES(o),this.applyVertexStateDescriptor(e),n.bindVertexArrayOES(null),t=new x(this,this.vertexStateIds.assign(),o,e.attributeLayout,r)}else(t=new x(this,this.vertexStateIds.assign(),null,e.attributeLayout,r))._vaoFallbackDescriptor=e;return this._vertexStateCount++,t},e.prototype.deleteVertexState=function(e){null!=this.extVao&&this.extVao.deleteVertexArrayOES(e.native),this.vertexStateIds.release(e.id),this._vertexStateCount--},e.prototype.createTexture=function(e){var t=this.gl,n=t.createTexture(),r=this.assignTextureUnit();t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,n);var o=l({magFilter:p.LINEAR,minFilter:p.LINEAR,wrapT:v.CLAMP_TO_EDGE,wrapS:v.CLAMP_TO_EDGE},e.samplingParameters);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,o.magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,o.minFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,o.wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,o.wrapT);var i,a,s=l({packAlignment:4,unpackAlignment:4,flipY:!1,premultiplyAlpha:!1,colorSpaceConversion:h.DEFAULT},e.pixelStorage);if(t.pixelStorei(t.PACK_ALIGNMENT,s.packAlignment),t.pixelStorei(t.UNPACK_ALIGNMENT,s.unpackAlignment),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,s.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.colorSpaceConversion),null!=e.mipmapData)for(var u=0;u<e.mipmapData.length;u++){var c=e.mipmapData[u],f=1/(1<<u);ArrayBuffer.isView(c)?t.texImage2D(t.TEXTURE_2D,u,e.format,Math.round(e.width/f),Math.round(e.height/f),0,e.format,e.dataType,c):t.texImage2D(t.TEXTURE_2D,u,e.format,e.format,e.dataType,c)}else t.texImage2D(t.TEXTURE_2D,0,e.format,e.width,e.height,0,e.format,e.dataType,null);if(e.generateMipmaps&&t.generateMipmap(t.TEXTURE_2D),null!==e.mipmapData){c=e.mipmapData[0];ArrayBuffer.isView(c)?(i=e.width,a=e.height):(i=c.width,a=c.height)}else i=e.width,a=e.height;var d=new _(this,n,i,a,e.dataType);return d.boundUnit=r,this.textureUnitState[r]={usageMetric:++this.textureUnitUsageCounter,texture:d},this._textureCount++,d},e.prototype.updateTextureData=function(e,t,n,r,o,i,a,s){void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=e.w),void 0===s&&(s=e.h);var l=this.gl,u=e;this.bindTexture(e),ArrayBuffer.isView(r)?l.texSubImage2D(l.TEXTURE_2D,t,o,i,a,s,n,u.type,r):l.texSubImage2D(l.TEXTURE_2D,t,o,i,n,u.type,r)},e.prototype.deleteTexture=function(e){var t=this.gl,n=e;-1!==n.boundUnit&&this.clearTextureUnit(n.boundUnit),t.deleteTexture(e.native),this._textureCount--},e.prototype.createProgram=function(e,n,r){var o=this.gl,i=this.vertexShaderCache.reference(e),a=this.fragmentShaderCache.reference(n);null==i&&(i=this.compileShader(e,o.VERTEX_SHADER),this.vertexShaderCache.add(e,i)),null==a&&(a=this.compileShader(n,o.FRAGMENT_SHADER),this.fragmentShaderCache.add(n,a));var s=o.createProgram();o.attachShader(s,i),o.attachShader(s,a);for(var l=0,u=0;u<r.length;u++){var c=r[u],f=(t.shaderTypeLength[c.type],t.shaderTypeRows[c.type]);o.bindAttribLocation(s,l,c.name),l+=f}if(o.linkProgram(s),!o.getProgramParameter(s,o.LINK_STATUS))throw"[program link]: "+o.getProgramInfoLog(s);var d=o.getProgramParameter(s,o.ACTIVE_UNIFORMS),h={},p={};for(u=0;u<d;u++){var v=o.getActiveUniform(s,u);h[v.name]=v,p[v.name]=o.getUniformLocation(s,v.name)}var y=new b(this,this.programIds.assign(),s,e,n,r,h,p);return this._programCount++,y},e.prototype.deleteProgram=function(e){this.gl.deleteProgram(e.native),this.vertexShaderCache.release(e.vertexCode),this.fragmentShaderCache.release(e.fragmentCode),this.programIds.release(e.id),this._programCount--},e.prototype.compileShader=function(e,t){var n=this.gl,r=n.createShader(t);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){var o=null;switch(t){case n.VERTEX_SHADER:o="vertex";break;case n.FRAGMENT_SHADER:o="fragment"}throw"["+o+" compile]: "+n.getShaderInfoLog(r)}return r},e.prototype.applyVertexStateDescriptor=function(e){var n=this.gl;null!=e.indexBuffer?n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer.native):n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null);for(var r=0,o=0;o<e.attributeLayout.length;o++){var i=e.attributeLayout[o],a=i.name,s=i.type,l=t.shaderTypeLength[s],u=t.shaderTypeRows[s],f=l/u,d=e.attributes[a];if(null!=d)if(void 0!==d.buffer){var h=d,p=h.sourceDataType;null==p&&(p=c.FLOAT),n.bindBuffer(n.ARRAY_BUFFER,h.buffer.native);for(var v=0;v<u;v++){var y=r+v,g=null!=h.sourceColumns?h.sourceColumns:f,m=v*g*t.dataTypeByteLength[p];n.enableVertexAttribArray(y),n.vertexAttribPointer(y,g,p,!!h.normalize,h.strideBytes,h.offsetBytes+m),this.extInstanced&&this.extInstanced.vertexAttribDivisorANGLE(y,null!=h.instanceDivisor?h.instanceDivisor:0)}}else{var x=d;if(1===u)n.disableVertexAttribArray(r),n.vertexAttrib4fv(r,x.data);else for(v=0;v<u;v++)n.disableVertexAttribArray(r+v),n.vertexAttrib4fv(r+v,x.data.subarray(4*v,4*v+4))}else for(v=0;v<u;v++)n.disableVertexAttribArray(r+v),n.vertexAttrib4f(r+v,0,0,0,0);r+=u}},e.prototype.assignTextureUnit=function(){for(var e=1/0,t=void 0,n=0;n<this.textureUnitState.length;n++){var r=this.textureUnitState[n];if(void 0===r)return n;r.usageMetric<e&&(t=n,e=r.usageMetric)}return this.clearTextureUnit(t),t},e.prototype.bindTexture=function(e){var t=this.gl,n=e;if(-1===n.boundUnit){var r=this.assignTextureUnit();t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,e.native),n.boundUnit=r,this.textureUnitState[r]={usageMetric:++this.textureUnitUsageCounter,texture:e}}else t.activeTexture(t.TEXTURE0+n.boundUnit),t.bindTexture(t.TEXTURE_2D,e.native),this.textureUnitState[n.boundUnit].usageMetric=++this.textureUnitUsageCounter},e.prototype.clearTextureUnit=function(e){var t=this.gl,n=this.textureUnitState[e].texture,r=n;t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,null),this.textureUnitState[e]=void 0,void 0!==n&&(r.boundUnit=-1)},e.prototype.markTextureUsage=function(e){var t=e;this.textureUnitState[t.boundUnit].usageMetric=++this.textureUnitUsageCounter},e}();t.GPUDevice=y,function(e){e[e.UNSIGNED_BYTE=WebGLRenderingContext.UNSIGNED_BYTE]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=WebGLRenderingContext.UNSIGNED_SHORT]="UNSIGNED_SHORT",e[e.UNSIGNED_INT=WebGLRenderingContext.UNSIGNED_INT]="UNSIGNED_INT"}(u=t.IndexDataType||(t.IndexDataType={})),function(e){e[e.BYTE=WebGLRenderingContext.BYTE]="BYTE",e[e.SHORT=WebGLRenderingContext.SHORT]="SHORT",e[e.UNSIGNED_BYTE=WebGLRenderingContext.UNSIGNED_BYTE]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=WebGLRenderingContext.UNSIGNED_SHORT]="UNSIGNED_SHORT",e[e.FLOAT=WebGLRenderingContext.FLOAT]="FLOAT"}(c=t.VertexAttributeSourceType||(t.VertexAttributeSourceType={})),function(e){e[e.STREAM=WebGLRenderingContext.STREAM_DRAW]="STREAM",e[e.STATIC=WebGLRenderingContext.STATIC_DRAW]="STATIC",e[e.DYNAMIC=WebGLRenderingContext.DYNAMIC_DRAW]="DYNAMIC"}(f=t.BufferUsageHint||(t.BufferUsageHint={})),function(e){e[e.FLOAT=WebGLRenderingContext.FLOAT]="FLOAT",e[e.VEC2=WebGLRenderingContext.FLOAT_VEC2]="VEC2",e[e.VEC3=WebGLRenderingContext.FLOAT_VEC3]="VEC3",e[e.VEC4=WebGLRenderingContext.FLOAT_VEC4]="VEC4",e[e.IVEC2=WebGLRenderingContext.INT_VEC2]="IVEC2",e[e.IVEC3=WebGLRenderingContext.INT_VEC3]="IVEC3",e[e.IVEC4=WebGLRenderingContext.INT_VEC4]="IVEC4",e[e.BOOL=WebGLRenderingContext.BOOL]="BOOL",e[e.BVEC2=WebGLRenderingContext.BOOL_VEC2]="BVEC2",e[e.BVEC3=WebGLRenderingContext.BOOL_VEC3]="BVEC3",e[e.BVEC4=WebGLRenderingContext.BOOL_VEC4]="BVEC4",e[e.MAT2=WebGLRenderingContext.FLOAT_MAT2]="MAT2",e[e.MAT3=WebGLRenderingContext.FLOAT_MAT3]="MAT3",e[e.MAT4=WebGLRenderingContext.FLOAT_MAT4]="MAT4",e[e.SAMPLER_2D=WebGLRenderingContext.SAMPLER_2D]="SAMPLER_2D",e[e.SAMPLER_CUBE=WebGLRenderingContext.SAMPLER_CUBE]="SAMPLER_CUBE"}(d=t.UniformType||(t.UniformType={})),function(e){e[e.FLOAT=WebGLRenderingContext.FLOAT]="FLOAT",e[e.VEC2=WebGLRenderingContext.FLOAT_VEC2]="VEC2",e[e.VEC3=WebGLRenderingContext.FLOAT_VEC3]="VEC3",e[e.VEC4=WebGLRenderingContext.FLOAT_VEC4]="VEC4",e[e.MAT2=WebGLRenderingContext.FLOAT_MAT2]="MAT2",e[e.MAT3=WebGLRenderingContext.FLOAT_MAT3]="MAT3",e[e.MAT4=WebGLRenderingContext.FLOAT_MAT4]="MAT4"}(t.AttributeType||(t.AttributeType={})),function(e){e[e.UNSIGNED_BYTE=WebGLRenderingContext.UNSIGNED_BYTE]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT_5_6_5=WebGLRenderingContext.UNSIGNED_SHORT_5_6_5]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=WebGLRenderingContext.UNSIGNED_SHORT_4_4_4_4]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=WebGLRenderingContext.UNSIGNED_SHORT_5_5_5_1]="UNSIGNED_SHORT_5_5_5_1",e[e.FLOAT=WebGLRenderingContext.FLOAT]="FLOAT"}(t.TextureDataType||(t.TextureDataType={})),function(e){e[e.ALPHA=WebGLRenderingContext.ALPHA]="ALPHA",e[e.RGB=WebGLRenderingContext.RGB]="RGB",e[e.RGBA=WebGLRenderingContext.RGBA]="RGBA",e[e.LUMINANCE=WebGLRenderingContext.LUMINANCE]="LUMINANCE",e[e.LUMINANCE_ALPHA=WebGLRenderingContext.LUMINANCE_ALPHA]="LUMINANCE_ALPHA"}(t.TextureFormat||(t.TextureFormat={})),function(e){e[e.NONE=WebGLRenderingContext.NONE]="NONE",e[e.DEFAULT=WebGLRenderingContext.BROWSER_DEFAULT_WEBGL]="DEFAULT"}(h=t.ColorSpaceConversion||(t.ColorSpaceConversion={})),function(e){e[e.NEAREST=WebGLRenderingContext.NEAREST]="NEAREST",e[e.LINEAR=WebGLRenderingContext.LINEAR]="LINEAR"}(p=t.TextureMagFilter||(t.TextureMagFilter={})),function(e){e[e.NEAREST=WebGLRenderingContext.NEAREST]="NEAREST",e[e.LINEAR=WebGLRenderingContext.LINEAR]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=WebGLRenderingContext.NEAREST_MIPMAP_NEAREST]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=WebGLRenderingContext.LINEAR_MIPMAP_NEAREST]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=WebGLRenderingContext.NEAREST_MIPMAP_LINEAR]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=WebGLRenderingContext.LINEAR_MIPMAP_LINEAR]="LINEAR_MIPMAP_LINEAR"}(t.TextureMinFilter||(t.TextureMinFilter={})),function(e){e[e.REPEAT=WebGLRenderingContext.REPEAT]="REPEAT",e[e.CLAMP_TO_EDGE=WebGLRenderingContext.CLAMP_TO_EDGE]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=WebGLRenderingContext.MIRRORED_REPEAT]="MIRRORED_REPEAT"}(v=t.TextureWrapMode||(t.TextureWrapMode={})),function(e){e[e.LONG_LIFE=1]="LONG_LIFE",e[e.TRANSIENT=0]="TRANSIENT"}(t.TextureUsageHint||(t.TextureUsageHint={})),t.shaderTypeLength=((r={})[d.FLOAT]=1,r[d.VEC2]=2,r[d.VEC3]=3,r[d.VEC4]=4,r[d.IVEC2]=1,r[d.IVEC3]=2,r[d.IVEC4]=3,r[d.BOOL]=1,r[d.BVEC2]=2,r[d.BVEC3]=3,r[d.BVEC4]=4,r[d.MAT2]=4,r[d.MAT3]=9,r[d.MAT4]=16,r),t.shaderTypeRows=((o={})[d.FLOAT]=1,o[d.VEC2]=1,o[d.VEC3]=1,o[d.VEC4]=1,o[d.IVEC2]=1,o[d.IVEC3]=1,o[d.IVEC4]=1,o[d.BOOL]=1,o[d.BVEC2]=1,o[d.BVEC3]=1,o[d.BVEC4]=1,o[d.MAT2]=2,o[d.MAT3]=3,o[d.MAT4]=4,o),t.shaderTypeColumns=((i={})[d.FLOAT]=1,i[d.VEC2]=2,i[d.VEC3]=3,i[d.VEC4]=4,i[d.IVEC2]=2,i[d.IVEC3]=3,i[d.IVEC4]=4,i[d.BOOL]=1,i[d.BVEC2]=2,i[d.BVEC3]=3,i[d.BVEC4]=4,i[d.MAT2]=2,i[d.MAT3]=3,i[d.MAT4]=4,i),t.dataTypeByteLength=((a={})[WebGLRenderingContext.BYTE]=1,a[WebGLRenderingContext.UNSIGNED_BYTE]=1,a[WebGLRenderingContext.SHORT]=2,a[WebGLRenderingContext.UNSIGNED_SHORT]=2,a[WebGLRenderingContext.INT]=4,a[WebGLRenderingContext.UNSIGNED_INT]=4,a[WebGLRenderingContext.FLOAT]=4,a);var g=function(){function e(e,t){this.device=e,this.native=t}return e.prototype.updateBufferData=function(e,t){void 0===t&&(t=0),this.device.updateBufferData(this,e,t)},e.prototype.delete=function(){this.device.deleteBuffer(this)},e}();t.GPUBuffer=g;var m=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.dataType=r,o}return s(t,e),t}(g);t.GPUIndexBuffer=m;var x=function(){function e(e,t,n,r,o){this.device=e,this.id=t,this.native=n,this.attributeLayout=r,this.indexType=o}return e.prototype.delete=function(){this.device.deleteVertexState(this)},e}();t.GPUVertexState=x;var _=function(){function e(e,t,n,r,o){this.device=e,this.native=t,this.w=n,this.h=r,this.type=o,this.boundUnit=-1}return e.prototype.updateTextureData=function(e,t,n,r,o,i,a){this.device.updateTextureData(this,e,t,n,r,o,i,a)},e.prototype.delete=function(){this.device.deleteTexture(this)},e}();t.GPUTexture=_;var b=function(){function e(e,t,n,r,o,i,a,s){this.device=e,this.id=t,this.native=n,this.vertexCode=r,this.fragmentCode=o,this.attributeLayout=i,this.uniformInfo=a,this.uniformLocation=s,this.stateCache={}}return e.prototype.delete=function(){this.device.deleteProgram(this)},e}();t.GPUProgram=b,t.default=y;var T=function(){function e(e){this.minimize=e,this.top=0,this.availableIdQueue=new Array}return e.prototype.assign=function(){return this.availableIdQueue.length>0?this.availableIdQueue.pop():this.top++},e.prototype.release=function(e){return-1===this.availableIdQueue.indexOf(e)&&(this.availableIdQueue.push(e),this.minimize&&this.availableIdQueue.sort(function(e,t){return t-e}),!0)},e.prototype.count=function(){return this.top-this.availableIdQueue.length},e}(),w=function(){function e(e){this.onZeroReferences=e,this.map={}}return e.prototype.add=function(e,t){this.map[e]={value:t,refs:1}},e.prototype.reference=function(e){var t=this.map[e];return null==t?null:(t.refs++,t.value)},e.prototype.release=function(e){var t=this.map[e];return null!=t&&(t.refs--,0!==t.refs||(this.onZeroReferences(t.value),delete this.map[e],!1))},e}()},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(7),a=n(6),s=n(9),l=n(13),u=n(10),c=function(e){function t(t){var n=e.call(this,0,0,[.1,.1,.1,1])||this;n.model=t,n.defaultCursor="crosshair",n.axisPointers={},n.activeAxisPointerColor=[1,1,1,.8],n.secondaryAxisPointerColor=[.2,.2,.2,1],n.displayNeedUpdate=!0,n._pendingTiles=new a.default,n.createTileLoadingDependency=function(e){return e.addEventListener("complete",n.onDependentTileComplete),e},n.removeTileLoadingDependency=function(e){e.removeEventListener("complete",n.onDependentTileComplete)},n.onDependentTileComplete=function(){n.updateDisplay()},n.cursorStyle=n.defaultCursor,n.addInteractionListener("pointerdown",function(){return n.cursorStyle="pointer"}),n.addInteractionListener("pointerup",function(){return n.cursorStyle=n.defaultCursor}),n.addInteractionListener("dragend",function(){return n.cursorStyle=n.defaultCursor}),n.loadingIndicator=new d,n.loadingIndicator.cursorStyle="pointer",n.loadingIndicator.layoutY=-1,n.loadingIndicator.layoutParentY=1,n.loadingIndicator.x=10,n.loadingIndicator.y=-10,n.loadingIndicator.mask=n,n.add(n.loadingIndicator),n.toggleLoadingIndicator(!1,!1);var r=[.1,.1,.1,1];return n.focusRegionRectLeft=new s.default(0,0,r),n.focusRegionRectRight=new s.default(0,0,r),n.focusRegionRectLeft.opacity=n.focusRegionRectRight.opacity=.7,n.focusRegionRectLeft.layoutH=n.focusRegionRectRight.layoutH=1,n.focusRegionRectLeft.z=n.focusRegionRectRight.z=1.9,n.add(n.focusRegionRectLeft),n.add(n.focusRegionRectRight),n.disableFocusRegion(),n}return r(t,e),t.prototype.setContig=function(e){this.contig=e,this.displayNeedUpdate=!0},t.prototype.setRange=function(e,t){this.x0=e,this.x1=t,this.displayNeedUpdate=!0},t.prototype.setAxisPointer=function(e,t,n){var r=t>=0&&t<=1,o=this.axisPointers[e];if(void 0===o){if(!r)return;(o=new f(n,this.activeAxisPointerColor,this.secondaryAxisPointerColor)).z=2,this.add(o),this.axisPointers[e]=o}o.render=r,r&&(o.layoutParentX=t),o.style!==n&&o.setStyle(n)},t.prototype.removeAxisPointer=function(e){var t=this.axisPointers[e];void 0!==t&&(this.remove(t),delete this.axisPointers[e])},t.prototype.setFocusRegion=function(e,t){this.focusRegionRectLeft.layoutParentX=0,this.focusRegionRectLeft.layoutW=Math.max(Math.min(e,t),0),this.focusRegionRectLeft.render=!0,this.focusRegionRectRight.layoutParentX=Math.max(e,t),this.focusRegionRectRight.layoutW=Math.max(1-this.focusRegionRectRight.layoutParentX,0),this.focusRegionRectRight.render=!0},t.prototype.disableFocusRegion=function(){this.focusRegionRectLeft.render=!1,this.focusRegionRectRight.render=!1},t.prototype.applyTransformToSubNodes=function(t){(this._lastComputedWidth!==this.getComputedWidth()||this.displayNeedUpdate)&&(this.updateDisplay(),this._lastComputedWidth=this.getComputedWidth()),e.prototype.applyTransformToSubNodes.call(this,t)},t.prototype.updateDisplay=function(){this._pendingTiles.markAllUnused(),this.displayNeedUpdate=!1,this._pendingTiles.removeUnused(this.removeTileLoadingDependency),this.toggleLoadingIndicator(this._pendingTiles.count>0,!0)},t.prototype.toggleLoadingIndicator=function(e,t){var n=e?1:-.1;t?i.default.springTo(this.loadingIndicator,{opacity:n},50):(i.default.stop(this.loadingIndicator,["opacity"]),this.loadingIndicator.opacity=n)},t}(s.default);t.TrackObject=c,function(e){e[e.Active=0]="Active",e[e.Secondary=1]="Secondary"}(o=t.AxisPointerStyle||(t.AxisPointerStyle={}));var f=function(e){function t(t,n,r){var o=e.call(this,0,0)||this;return o.activeColor=n,o.secondaryColor=r,o.layoutX=-.5,o.layoutH=1,o.w=1,o.setStyle(t),o}return r(t,e),t.prototype.setStyle=function(e){switch(e){case o.Active:this.color.set(this.activeColor);break;case o.Secondary:this.color.set(this.secondaryColor)}this.style=e},t}(s.default),d=function(e){function t(){return e.call(this,u.OpenSansRegular,"Loading",12,[1,1,1,1])||this}return r(t,e),t}(l.default);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.cache={},this.count=0}return e.prototype.get=function(e,t){var n=this.cache[e];if(void 0===n){var r=t(e);n=this.cache[e]={value:r,used:!0},this.count++}return n.used=!0,n.value},e.prototype.keys=function(){return Object.keys(this.cache)},e.prototype.markUnused=function(e){this.cache[e].used=!1},e.prototype.markAllUnused=function(){for(var e in this.cache)this.cache[e].used=!1},e.prototype.remove=function(e,t){var n=this.cache[e];void 0!==n&&(this.count--,t(n.value),delete this.cache[e])},e.prototype.removeUnused=function(e){for(var t in this.cache){var n=this.cache[t];n.used||(this.count--,e(n.value),delete this.cache[t])}},e.prototype.removeAll=function(e){this.markAllUnused(),this.removeUnused(e)},e}();t.UsageCache=r,t.default=r},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.springTo=function(t,n,r,o){var i=r instanceof Object?r:{tension:r,friction:2*Math.sqrt(r)};e.animation(t,n,e.stringStep,i,!0,o)},e.spring=function(t,n,r,o){var i=r instanceof Object?r:{tension:r,friction:2*Math.sqrt(r)};e.animation(t,n,e.stringStep,i,!1,o)},e.animation=function(t,n,o,i,a,s){var l,u,c=window.performance.now()/1e3,f=e.getActive(t);null==f&&(f={object:t,animatingFields:{}},e.active.add(f));var d=Object.keys(n);try{for(var h=r(d),p=h.next();!p.done;p=h.next()){var v=p.value,y=n[v],g=t[v],m=f.animatingFields[v];null==m?(m={state:{x:y-g,v:null==s?0:s,pe:0,t0:c,lastT:c},target:n[v],step:o,parameters:i,stopOnComplete:a},f.animatingFields[v]=m):(m.state.x=y-g,m.state.v=null==s?m.state.v:s,m.state.t0=c,m.target=y,m.step=o,m.parameters=i)}}catch(e){l={error:e}}finally{try{p&&!p.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}},e.stop=function(t,n){var o,i;if(null==n)e.removeActive(t);else{var a=e.getActive(t);if(null===a)return;var s=Array.isArray(n)?n:Object.keys(n);try{for(var l=r(s),u=l.next();!u.done;u=l.next()){var c=u.value;delete a.animatingFields[c]}}catch(e){o={error:e}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}0===Object.keys(a.animatingFields).length&&e.active.delete(a)}},e.frame=function(t){var n,o,i,a,s,l;void 0===t&&(t=window.performance.now()/1e3);var u=0;try{for(var c=r(e.active),f=c.next();!f.done;f=c.next()){var d=f.value,h=d.object,p=Object.keys(d.animatingFields);try{for(var v=r(p),y=v.next();!y.done;y=v.next()){var g=y.value,m=d.animatingFields[g];m.state.x=m.target-h[g],m.step(t,m.state,m.parameters),h[g]=m.target-m.state.x,u++;var x=.5*m.state.v*m.state.v,_=m.state.pe+x;m.stopOnComplete&&_<1e-6&&(delete d.animatingFields[g],h[g]=m.target,e.fieldComplete(h,g))}}catch(e){i={error:e}}finally{try{y&&!y.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}0===Object.keys(d.animatingFields).length&&e.active.delete(d)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}try{for(var b=r(e.stepCallbacks),T=b.next();!T.done;T=b.next()){(0,T.value)(u)}}catch(e){s={error:e}}finally{try{T&&!T.done&&(l=b.return)&&l.call(b)}finally{if(s)throw s.error}}},e.activeAnimationCount=function(){return e.active.size},e.addAnimationCompleteCallback=function(t,n,r,o){void 0===o&&(o=!0),e.animationCompleteCallbacks.add({callback:r,object:t,field:n,once:o})},e.removeAnimationCompleteCallbacks=function(t,n,o){var i,a,s=0;try{for(var l=r(e.animationCompleteCallbacks),u=l.next();!u.done;u=l.next()){var c=u.value;c.callback===o&&c.field===n&&c.object===t&&(e.animationCompleteCallbacks.delete(c),s++)}}catch(e){i={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return s>0},e.addStepCompleteCallback=function(t){e.stepCallbacks.add(t)},e.removeStepCompleteCallback=function(t){return e.stepCallbacks.delete(t)},e.fieldComplete=function(t,n){var o,i;try{for(var a=r(this.animationCompleteCallbacks),s=a.next();!s.done;s=a.next()){var l=s.value;l.object===t&&l.field===n&&(l.once&&e.animationCompleteCallbacks.delete(l),l.callback(t))}}catch(e){o={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}},e.stringStep=function(e,t,n){var r=e-t.lastT;t.lastT=e;var o=n.tension,i=n.friction,a=r,s=t.v,l=t.x,u=4*o-i*i;if(0===u){var c=Math.sqrt(o),f=l,d=s+c*l,h=Math.exp(-c*a);t.x=(f+d*a)*h,t.v=(d-c*(f+d*a))*h}else if(u<=0){var p=Math.sqrt(-u),v=.5*(-i+p),y=.5*(-i-p),g=(f=l-(d=(y*l-s)/(y-v)),Math.exp(y*a)),m=Math.exp(v*a);t.x=f*g+d*m,t.v=f*y*g+d*v*m}else{var x=-i/2,_=Math.sqrt(.25*u),b=Math.atan(_/(s/l-x)),T=(f=l/Math.sin(b),h=Math.exp(x*a),Math.sin(_*a+b)),w=Math.cos(_*a+b);t.x=f*h*T,t.v=f*h*(x*T+_*w)}t.pe=.5*o*t.x*t.x},e.getActive=function(t){var n,o;try{for(var i=r(e.active),a=i.next();!a.done;a=i.next()){var s=a.value;if(t===s.object)return s}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return null},e.removeActive=function(t){var n,o;try{for(var i=r(e.active),a=i.next();!a.done;a=i.next()){var s=a.value;if(s.object===t)return void e.active.delete(s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},e.active=new Set,e.stepCallbacks=new Set,e.animationCompleteCallbacks=new Set,e}();t.Animator=o,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},e.lerp=function(e,t,n){return e*(1-n)+t*n},e.linstep=function(t,n,r){return e.clamp((r-t)/(n-t),0,1)},e.smoothstep=function(t,n,r){return(r=e.clamp((r-t)/(n-t),0,1))*r*(3-2*r)},e.log2=function(e){return Math.log(e)*Math.LOG2E},e.log10=function(e){return Math.log(e)*Math.LOG10E},e.sign=function(e){return(e>0)-(e<0)||+e},e}();t.Scalar=r,t.default=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=n(11),a=n(12),s=function(e){function t(t,n,r){void 0===t&&(t=10),void 0===n&&(n=10),void 0===r&&(r=[1,0,0,1]);var i=e.call(this)||this;return i.color=new Float32Array(4),i.blendFactor=1,i.attributeLayout=[{name:"position",type:o.AttributeType.VEC2}],i.render=!0,i.w=t,i.h=n,i.color.set(r),i}return r(t,e),t.prototype.allocateGPUResources=function(e){this.gpuVertexState=i.SharedResources.quad1x1VertexState,this.gpuProgram=i.SharedResources.getProgram(e,this.getVertexCode(),this.getFragmentCode(),this.attributeLayout)},t.prototype.releaseGPUResources=function(){this.gpuVertexState=null,this.gpuProgram=null},t.prototype.draw=function(e){e.uniform1f("blendFactor",this.blendFactor),e.uniform2f("size",this.computedWidth,this.computedHeight),e.uniformMatrix4fv("model",!1,this.worldTransformMat4),e.uniform4f("color",this.color[0],this.color[1],this.color[2],this.color[3]*this.opacity),e.draw(a.DrawMode.TRIANGLES,6,0)},t.prototype.getVertexCode=function(){return"\n            #version 100\n\n            attribute vec2 position;\n            uniform mat4 model;\n            uniform vec2 size;\n\n            varying vec2 vUv;\n\n            void main() {\n                vUv = position;\n                gl_Position = model * vec4(position * size, 0., 1.0);\n            }\n        "},t.prototype.getFragmentCode=function(){return"\n            #version 100\n\n            precision mediump float;\n            varying vec2 vUv;\n\n            uniform float blendFactor;\n            uniform vec4 color;\n            \n            void main() {\n                gl_FragColor = vec4(color.rgb, blendFactor) * color.a;\n            }\n        "},t}(n(0).Object2D);t.Rect=s,t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenSansRegular=n(51)},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(){function e(){}return e.getProgram=function(e,t,n,r){var o=t+""+n+""+r.map(function(e){return e.name+":"+e.type}).join(""),i=this.programs[o];return null==i&&(i=e.createProgram(t,n,r),this.programs[o]=i),i},e.deleteProgram=function(e,t,n){var r=e+""+t+""+n.map(function(e){return e.name+":"+e.type}).join(""),o=this.programs[r];return null!=o&&(o.delete(),delete this.programs[r],!0)},e.getTexture=function(e,t,n){var r=this.textures[t];return null==r&&(r=e.createTexture(n),this.textures[t]=r),r},e.deleteTexture=function(e){var t=this.textures[e];return null!=t&&(t.delete(),delete this.textures[e],!0)},e.getBuffer=function(e,t,n){var r=this.buffers[t];return null==r&&(r=e.createBuffer(n),this.buffers[t]=r),r},e.deleteBuffer=function(e){var t=this.buffers[e];return null!=t&&(t.delete(),delete this.buffers[e],!0)},e.initialize=function(e){this.quadIndexBuffer=e.createIndexBuffer({data:new Uint8Array([0,1,2,0,3,1])}),this.unitQuadVertexBuffer=e.createBuffer({data:new Float32Array([-1,-1,1,1,-1,1,1,-1])}),this.unitQuadVertexState=e.createVertexState({indexBuffer:this.quadIndexBuffer,attributeLayout:this.quadAttributeLayout,attributes:{position:{buffer:this.unitQuadVertexBuffer,offsetBytes:0,strideBytes:8}}}),this.quad1x1VertexBuffer=e.createBuffer({data:new Float32Array([0,0,1,1,0,1,1,0])}),this.quad1x1VertexState=e.createVertexState({indexBuffer:this.quadIndexBuffer,attributeLayout:this.quadAttributeLayout,attributes:{position:{buffer:this.quad1x1VertexBuffer,offsetBytes:0,strideBytes:8}}})},e.release=function(){var e,t,n,o,i,a;this.quadIndexBuffer.delete(),this.quadIndexBuffer=null,this.unitQuadVertexState.delete(),this.unitQuadVertexState=null,this.unitQuadVertexBuffer.delete(),this.unitQuadVertexBuffer=null,this.quad1x1VertexState.delete(),this.quad1x1VertexState=null,this.quad1x1VertexBuffer.delete(),this.quad1x1VertexBuffer=null;try{for(var s=r(Object.keys(this.programs)),l=s.next();!l.done;l=s.next()){var u=l.value;this.programs[u].delete()}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}this.programs={};try{for(var c=r(Object.keys(this.textures)),f=c.next();!f.done;f=c.next()){u=f.value;this.textures[u].delete()}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}this.textures={};try{for(var d=r(Object.keys(this.buffers)),h=d.next();!h.done;h=d.next()){u=h.value;this.buffers[u].delete()}}catch(e){i={error:e}}finally{try{h&&!h.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}this.buffers={}},e.quadAttributeLayout=[{name:"position",type:o.AttributeType.VEC2}],e.programs={},e.textures={},e.buffers={},e}();t.SharedResources=i,t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(4),i=n(20);!function(e){e[e.NONE=0]="NONE",e[e.PREMULTIPLIED_ALPHA=1]="PREMULTIPLIED_ALPHA"}(r=t.BlendMode||(t.BlendMode={})),function(e){e[e.POINTS=WebGLRenderingContext.POINTS]="POINTS",e[e.LINE_STRIP=WebGLRenderingContext.LINE_STRIP]="LINE_STRIP",e[e.LINE_LOOP=WebGLRenderingContext.LINE_LOOP]="LINE_LOOP",e[e.LINES=WebGLRenderingContext.LINES]="LINES",e[e.TRIANGLE_STRIP=WebGLRenderingContext.TRIANGLE_STRIP]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=WebGLRenderingContext.TRIANGLE_FAN]="TRIANGLE_FAN",e[e.TRIANGLES=WebGLRenderingContext.TRIANGLES]="TRIANGLES"}(t.DrawMode||(t.DrawMode={}));var a=function(){function e(e){this.MAX_SAFE_MASKS=254,this._masks=new Array,this._opaque=new Array,this._transparent=new Array,this.currentFramebuffer=-1,this.currentProgramId=-1,this.currentVertexStateId=-1,this.currentBlendMode=-1,this.currentStencilTestEnabled=-1,this.currentMaskTestValue=-1,this.currentVaoFallbackAttributeLayout=void 0,this.stateSOffset=24,this.stateSMask=4278190080,this.stateBOffset=4,this.stateBMask=16777200,this.stateMOffset=0,this.stateMMask=15,this.MAX_SHADERS=this.stateSMask>>>this.stateSOffset,this.MAX_BUFFERS=this.stateBMask>>>this.stateBOffset,this.MAX_BLEND_MODES=this.stateMMask>>>this.stateMOffset,this.device=e,this.deviceInternal=e,this.gl=this.deviceInternal.gl,this.extVao=this.deviceInternal.extVao,this.drawContext=s.create(e,this.deviceInternal.extInstanced)}return e.prototype.render=function(e){var t=this,n=this.gl,o=this.drawContext;e.root.applyTransformToSubNodes(!0);var a=0,s=this._opaque,l=0,u=this._transparent,c=0,f=this._masks;if(e.root.forEachSubNode(function(e){if(e instanceof i.Renderable&&!0===e.render){var n=e;if(null!=e.mask){for(var o=-1,d=0;d<c;d++)if(f[d]===e.mask){o=d;break}-1===o?(n._maskIndex=c,f[c++]=e.mask):n._maskIndex=o}else n._maskIndex=-1;if(n.gpuResourcesNeedAllocate){if(n.allocateGPUResources(t.device),null==n.gpuProgram)throw'Renderable field "gpuProgram" must be set before rendering (or set node\'s render field to false)';if(null==n.gpuVertexState)throw'Renderable field "gpuVertexState" must be set before rendering (or set node\'s render field to false)';n.gpuResourcesNeedAllocate=!1}var h=e.transparent;void 0===h&&(h=e.opacity<1);var p=e.blendMode;void 0===p&&(p=h?r.PREMULTIPLIED_ALPHA:r.NONE),n._renderStateKey=t.encodeRenderState(n.gpuProgram.id,n.gpuVertexState.id,p),h?u[l++]=e:s[a++]=e}}),a<s.length&&(s.length=a),l<u.length&&(u.length=l),c<f.length&&(f.length=c),s.sort(function(e,t){var n=e,r=t,o=n._renderStateKey-r._renderStateKey;return 0===o?n.renderOrderZ-r.renderOrderZ:o}),u.sort(function(e,t){var n=e,r=t,o=r.renderOrderZ-n.renderOrderZ;return 0===o?n._renderStateKey-r._renderStateKey:o}),this.resetGLStateAssumptions(),this.currentFramebuffer!==e.target&&(n.bindFramebuffer(n.FRAMEBUFFER,e.target),this.currentFramebuffer=e.target),null!=e.target)throw"Todo, custom framebuffers: use framebuffers size for viewport";n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),o.viewport.x=0,o.viewport.y=0,o.viewport.w=n.drawingBufferWidth,o.viewport.h=n.drawingBufferHeight;var d=0;if(null!=e.clearOptions.clearColor&&(d|=n.COLOR_BUFFER_BIT,n.clearColor(e.clearOptions.clearColor[0],e.clearOptions.clearColor[1],e.clearOptions.clearColor[2],e.clearOptions.clearColor[3])),null!=e.clearOptions.clearDepth&&(d|=n.DEPTH_BUFFER_BIT,n.clearDepth(e.clearOptions.clearDepth)),null!=e.clearOptions.clearStencil&&(d|=n.STENCIL_BUFFER_BIT,n.clearStencil(e.clearOptions.clearStencil)),n.clear(d),f.length>0){n.enable(n.STENCIL_TEST),this.currentStencilTestEnabled=1,n.colorMask(!1,!1,!1,!1),n.depthMask(!0),n.disable(n.BLEND),this.currentBlendMode=r.NONE,n.stencilFunc(n.ALWAYS,255,255),this.currentMaskTestValue=-1,n.stencilOp(n.KEEP,n.KEEP,n.REPLACE);for(var h=0;h<f.length;h++){var p=f[h],v=p;this.setProgram(v),this.setVertexState(v);var y=h+1;n.stencilMask(y),p.draw(this.drawContext)}null!=e.clearOptions.clearDepth&&(d|=n.DEPTH_BUFFER_BIT,n.clearDepth(e.clearOptions.clearDepth))}n.colorMask(!0,!0,!0,!0),n.depthMask(!0),n.stencilMask(0),0===f.length?(n.disable(n.STENCIL_TEST),this.currentStencilTestEnabled=0):n.stencilOp(n.KEEP,n.KEEP,n.KEEP),this.renderArray(s),n.depthMask(!1),this.renderArray(u)},e.prototype.renderArray=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(!(n.opacity<=0||!1===n.visible)){var r=n,o=this.decodeRenderStateBlendMode(r._renderStateKey);this.setProgram(r),this.setVertexState(r),this.setBlendMode(o),this.setMaskTest(-1!==r._maskIndex,(r._maskIndex+1)%256),n.draw(this.drawContext)}}},e.prototype.resetGLStateAssumptions=function(){this.currentFramebuffer=void 0,this.currentProgramId=-1,this.currentVertexStateId=-1,this.currentBlendMode=-1,this.currentStencilTestEnabled=-1,this.currentMaskTestValue=-1},e.prototype.setProgram=function(e){var t=this.gl,n=this.drawContext;e.gpuProgram.id!==this.currentProgramId&&(t.useProgram(e.gpuProgram.native),n.program=e.gpuProgram,this.currentProgramId=e.gpuProgram.id)},e.prototype.setVertexState=function(e){var t=this.gl,n=this.drawContext;if(e.gpuVertexState.id!==this.currentVertexStateId){if(null!==e.gpuVertexState.native)this.extVao.bindVertexArrayOES(e.gpuVertexState.native);else{if(void 0!==this.currentVaoFallbackAttributeLayout)for(var r=0,i=0;i<this.currentVaoFallbackAttributeLayout.length;i++){var a=this.currentVaoFallbackAttributeLayout[i].type,s=o.shaderTypeRows[a];if(1===s)t.disableVertexAttribArray(r);else for(var l=0;l<s;l++)t.disableVertexAttribArray(r+l);r+=s}this.deviceInternal.applyVertexStateDescriptor(e.gpuVertexState._vaoFallbackDescriptor),this.currentVaoFallbackAttributeLayout=e.gpuVertexState.attributeLayout}n.vertexState=e.gpuVertexState,this.currentVertexStateId=e.gpuVertexState.id}},e.prototype.setBlendMode=function(e){var t=this.gl;if(e!==this.currentBlendMode){if(0===e)t.disable(t.BLEND);else switch(this.currentBlendMode<=0&&t.enable(t.BLEND),e){case r.PREMULTIPLIED_ALPHA:t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA);break;default:throw'Blend mode "'+r[e]+'" not yet implemented'}this.currentBlendMode=e}},e.prototype.setMaskTest=function(e,t){var n=this.gl;e?(1!==this.currentStencilTestEnabled&&(n.enable(n.STENCIL_TEST),this.currentStencilTestEnabled=1),this.currentMaskTestValue!==t&&(n.stencilFunc(n.EQUAL,t,255),this.currentMaskTestValue=t)):0!==this.currentStencilTestEnabled&&(n.disable(n.STENCIL_TEST),this.currentStencilTestEnabled=0)},e.prototype.encodeRenderState=function(e,t,n){return e<<this.stateSOffset|t<<this.stateBOffset|n<<this.stateMOffset},e.prototype.decodeRenderState=function(e){return{programId:(e&this.stateSMask)>>>this.stateSOffset,vertexStateId:(e&this.stateBMask)>>>this.stateBOffset,blendMode:(e&this.stateMMask)>>>this.stateMOffset}},e.prototype.decodeRenderStateBlendMode=function(e){return(e&this.stateMMask)>>>this.stateMOffset},e}();t.Renderer=a;var s=function(){function e(e,t){this.device=e,this.extInstanced=t,this.viewport={x:0,y:0,w:0,h:0};var n=e.gl;this.gl=n}return e.prototype.uniform1f=function(e,t){var n=this.program.stateCache;n[e]!==t&&(this.gl.uniform1f(this.program.uniformLocation[e],t),n[e]=t)},e.prototype.uniform1fv=function(e,t){this.gl.uniform1fv(this.program.uniformLocation[e],t)},e.prototype.uniform1i=function(e,t){var n=this.program.stateCache;n[e]!==t&&(this.gl.uniform1i(this.program.uniformLocation[e],t),n[e]=t)},e.prototype.uniform1iv=function(e,t){this.gl.uniform1iv(this.program.uniformLocation[e],t)},e.prototype.uniform2f=function(e,t,n){var r=this.program.stateCache,o=r[e];void 0===o&&(o=r[e]=new Array(2)),o[0]===t&&o[1]===n||(this.gl.uniform2f(this.program.uniformLocation[e],t,n),o[0]=t,o[1]=n)},e.prototype.uniform2fv=function(e,t){this.gl.uniform2fv(this.program.uniformLocation[e],t)},e.prototype.uniform2i=function(e,t,n){var r=this.program.stateCache,o=r[e];void 0===o&&(o=r[e]=new Array(2)),o[0]===t&&o[1]===n||(this.gl.uniform2i(this.program.uniformLocation[e],t,n),o[0]=t,o[1]=n)},e.prototype.uniform2iv=function(e,t){this.gl.uniform2iv(this.program.uniformLocation[e],t)},e.prototype.uniform3f=function(e,t,n,r){var o=this.program.stateCache,i=o[e];void 0===i&&(i=o[e]=new Array(3)),i[0]===t&&i[1]===n&&i[2]===r||(this.gl.uniform3f(this.program.uniformLocation[e],t,n,r),i[0]=t,i[1]=n,i[2]=r)},e.prototype.uniform3fv=function(e,t){this.gl.uniform3fv(this.program.uniformLocation[e],t)},e.prototype.uniform3i=function(e,t,n,r){var o=this.program.stateCache,i=o[e];void 0===i&&(i=o[e]=new Array(3)),i[0]===t&&i[1]===n&&i[2]===r||(this.gl.uniform3i(this.program.uniformLocation[e],t,n,r),i[0]=t,i[1]=n,i[2]=r)},e.prototype.uniform3iv=function(e,t){this.gl.uniform3iv(this.program.uniformLocation[e],t)},e.prototype.uniform4f=function(e,t,n,r,o){var i=this.program.stateCache,a=i[e];void 0===a&&(a=i[e]=new Array(4)),a[0]===t&&a[1]===n&&a[2]===r&&a[3]===o||(this.gl.uniform4f(this.program.uniformLocation[e],t,n,r,o),a[0]=t,a[1]=n,a[2]=r,a[3]=o)},e.prototype.uniform4fv=function(e,t){this.gl.uniform4fv(this.program.uniformLocation[e],t)},e.prototype.uniform4i=function(e,t,n,r,o){var i=this.program.stateCache,a=i[e];void 0===a&&(a=i[e]=new Array(4)),a[0]===t&&a[1]===n&&a[2]===r&&a[3]===o||(this.gl.uniform4i(this.program.uniformLocation[e],t,n,r,o),a[0]=t,a[1]=n,a[2]=r,a[3]=o)},e.prototype.uniform4iv=function(e,t){this.gl.uniform4iv(this.program.uniformLocation[e],t)},e.prototype.uniformMatrix2fv=function(e,t,n){this.gl.uniformMatrix2fv(this.program.uniformLocation[e],t,n)},e.prototype.uniformMatrix3fv=function(e,t,n){this.gl.uniformMatrix3fv(this.program.uniformLocation[e],t,n)},e.prototype.uniformMatrix4fv=function(e,t,n){this.gl.uniformMatrix4fv(this.program.uniformLocation[e],t,n)},e.prototype.uniformTexture2D=function(e,t){var n=this.device,r=t;-1!==r.boundUnit?(this.uniform1i(e,r.boundUnit),n.markTextureUsage(t)):(n.bindTexture(t),this.uniform1i(e,r.boundUnit))},e.prototype.draw=function(e,t,n){var r=this.gl;null!=this.vertexState.indexType?r.drawElements(e,t,this.vertexState.indexType,n):r.drawArrays(e,n,t)},e.prototype.extDrawInstanced=function(e,t,n,r){null!=this.vertexState.indexType?this.extInstanced.drawElementsInstancedANGLE(e,t,this.vertexState.indexType,n,r):this.extInstanced.drawArraysInstancedANGLE(e,n,t,r)},e.create=function(t,n){return new e(t,n)},e}();t.DrawContext=s,t.default=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(47),a=n(4),s=n(12),l=n(0),u=n(11),c=function(e){function t(t,n,r,o){void 0===r&&(r=16),void 0===o&&(o=[0,0,0,1]);var i=e.call(this)||this;return i.color=new Float32Array(4),i.opacity=1,i.additiveBlendFactor=0,i._kerningEnabled=!0,i._ligaturesEnabled=!0,i._lineHeight=1,i.vertexCount=0,i.blendMode=s.BlendMode.PREMULTIPLIED_ALPHA,i.transparent=!0,i.gpuResourcesNeedAllocate=!1,i.render=!1,i._fontSizePx=r,i.fontPath=t,i.string=n,i.color.set(o),i}return r(t,e),Object.defineProperty(t.prototype,"string",{get:function(){return this._string},set:function(e){var t=this._string!==e;this._string=e,t&&this.updateGlyphLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontPath",{get:function(){return this._fontPath},set:function(e){var t=this._fontPath!==e;this._fontPath=e,t&&this.updateFontPath()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSizePx",{get:function(){return this._fontSizePx},set:function(e){var t=e!==this._fontSizePx;this._fontSizePx=e,t&&this.updateGlyphLayout()},enumerable:!0,configurable:!0}),t.prototype.allocateGPUResources=function(e){null==this.gpuProgram&&(this.gpuProgram=u.SharedResources.getProgram(e,"\n                #version 100\n\n                precision mediump float;\n\n                attribute vec2 position;\n                attribute vec3 uv;\n\n                uniform mat4 transform;\n                uniform float fieldRange;\n                uniform vec2 viewportSize;\n                uniform float glyphScale;\n\n                varying vec2 vUv;\n                varying float vFieldRangeDisplay_px;\n\n                void main() {\n                    vUv = uv.xy;\n\n                    // determine the field range in pixels when drawn to the framebuffer\n                    vec2 scale = abs(vec2(transform[0][0], transform[1][1])) * glyphScale;\n                    float atlasScale = uv.z;\n                    vFieldRangeDisplay_px = fieldRange * scale.y * (viewportSize.y * 0.5) / atlasScale;\n                    vFieldRangeDisplay_px = max(vFieldRangeDisplay_px, 1.0);\n\n                    // flip-y axis\n                    gl_Position = transform * vec4(vec2(position.x, -position.y) * glyphScale, 0.0, 1.0);\n                }\n                ","\n                #version 100\n\n                precision mediump float;\n\n                uniform vec4 color;\n                uniform float blendFactor;\n\n                uniform sampler2D glyphAtlas;\n                uniform mat4 transform;\n\n                varying vec2 vUv;\n                varying float vFieldRangeDisplay_px;\n\n                float median(float r, float g, float b) {\n                    return max(min(r, g), min(max(r, g), b));\n                }\n\n                void main() {\n                    vec3 sample = texture2D(glyphAtlas, vUv).rgb;\n\n                    float sigDist = median(sample.r, sample.g, sample.b);\n\n                    // spread field range over 1px for antialiasing\n                    sigDist = clamp((sigDist - 0.5) * vFieldRangeDisplay_px + 0.5, 0.0, 1.0);\n\n                    float alpha = sigDist;\n\n                    gl_FragColor = vec4(color.rgb, blendFactor) * color.a * alpha;\n                }\n                ",t.attributeLayout));var n=this._fontAsset.descriptor.metadata.postScriptName,r=this._fontAsset.images[0].length>1;this.glyphAtlas=u.SharedResources.getTexture(e,n,{format:a.TextureFormat.RGBA,generateMipmaps:!r,mipmapData:this._fontAsset.images[0],dataType:a.TextureDataType.UNSIGNED_BYTE,usageHint:a.TextureUsageHint.LONG_LIFE,samplingParameters:{magFilter:a.TextureMagFilter.LINEAR,minFilter:r?a.TextureMinFilter.LINEAR_MIPMAP_LINEAR:a.TextureMinFilter.LINEAR,wrapS:a.TextureWrapMode.CLAMP_TO_EDGE,wrapT:a.TextureWrapMode.CLAMP_TO_EDGE},pixelStorage:{flipY:!1,premultiplyAlpha:!1,colorSpaceConversion:a.ColorSpaceConversion.NONE}});var o=i.default.generateVertexData(this._glyphLayout);this.vertexCount=o.vertexCount,this.gpuVertexBuffer=e.createBuffer({data:o.vertexArray,usageHint:a.BufferUsageHint.STATIC}),this.gpuVertexState=e.createVertexState({attributeLayout:t.attributeLayout,attributes:{position:{buffer:this.gpuVertexBuffer,sourceColumns:o.vertexLayout.position.elements,offsetBytes:o.vertexLayout.position.offsetBytes,strideBytes:o.vertexLayout.position.strideBytes,normalize:!1},uv:{buffer:this.gpuVertexBuffer,sourceColumns:o.vertexLayout.uv.elements,offsetBytes:o.vertexLayout.uv.offsetBytes,strideBytes:o.vertexLayout.uv.strideBytes,normalize:!1}}})},t.prototype.releaseGPUResources=function(){null!=this.gpuVertexState&&(this.gpuVertexState.delete(),this.gpuVertexState=null),null!=this.gpuVertexBuffer&&(this.gpuVertexBuffer.delete(),this.gpuVertexBuffer=null),this.vertexCount=0},t.prototype.draw=function(e){e.uniform2f("viewportSize",e.viewport.w,e.viewport.h),e.uniform1f("fieldRange",this._fontAsset.descriptor.fieldRange_px),e.uniformTexture2D("glyphAtlas",this.glyphAtlas),e.uniform1f("glyphScale",this._glyphLayout.glyphScale),e.uniform4f("color",this.color[0],this.color[1],this.color[2],this.color[3]*this.opacity),e.uniform1f("blendFactor",1-this.additiveBlendFactor),e.uniformMatrix4fv("transform",!1,this.worldTransformMat4),e.draw(s.DrawMode.TRIANGLES,this.vertexCount,0)},t.prototype.updateFontPath=function(){var e=this;t.getFontAsset(this._fontPath,function(t){e._fontAsset=t,e.updateGlyphLayout()})},t.prototype.updateGlyphLayout=function(){var e=!1;if(null!=this._string&&null!=this._fontAsset){var t=this._fontAsset.descriptor,n=t.typoAscender-t.typoDescender,r=this._fontSizePx/n;null===this._glyphLayout||this._glyphLayout.glyphScale;this._glyphLayout=i.default.layout(this._string,this._fontAsset.descriptor,{glyphScale:r,lineHeight:this._lineHeight,ligaturesEnabled:this._ligaturesEnabled,kerningEnabled:this._kerningEnabled}),this.w=(this._glyphLayout.bounds.r-this._glyphLayout.bounds.l)*this._glyphLayout.glyphScale,this.h=(this._glyphLayout.bounds.b-this._glyphLayout.bounds.t)*this._glyphLayout.glyphScale,e=!0}else e=null!==this._glyphLayout,this._glyphLayout=null,this.w=0,this.h=0;e&&this.eventEmitter.emit("glyphLayoutChanged"),this.render=null!=this._glyphLayout,this.gpuResourcesNeedAllocate=e,this.gpuResourcesNeedAllocate&&this.releaseGPUResources()},t.getFontAsset=function(e,n,r){var a=t.fontCache[e];if(null==a){var s=t.fontMap[e];null==s&&(s=t.fontMap[e]=new Promise(function(n,r){var a,s=e.substr(0,e.lastIndexOf("/")),l="json"===e.substr(e.lastIndexOf(".")+1).toLowerCase(),u=new Array,c=!1;function f(){var r,i,s,l;try{for(var f=o(u),d=f.next();!d.done;d=f.next()){var h=d.value;try{for(var p=o(h),v=p.next();!v.done;v=p.next()){if(!v.value.complete)return}}catch(e){s={error:e}}finally{try{v&&!v.done&&(l=p.return)&&l.call(p)}finally{if(s)throw s.error}}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}if(null!=a&&!c){var y={descriptor:a,images:u};c=!0,t.fontCache[e]=y,n(y)}}!function(e){var t=new XMLHttpRequest;t.open("GET",e),t.responseType=l?"json":"arraybuffer",t.onerror=function(t){return r("Could not load font "+e)},t.onload=function(e){null!=(a=l?t.response:function(e){try{return i.default.parse(e)}catch(e){return r("Error parsing binary GPUText file: "+e),null}}(t.response))?(a.textures.length>1&&console.warn("Multiple-page glyph atlases are not yet supported"),function(e){for(var t=0;t<e.length;t++){var n=e[t];u[t]=new Array;for(var r=0;r<n.length;r++){var o=n[r],i=void 0;o instanceof HTMLImageElement?i=o:(i=new Image).src=s+"/"+o.localPath,i.onload=f,u[t][r]=i}}f()}(a.textures),f()):r("Failed to parse font")},t.send()}(e)})),s.catch(r).then(n)}else n(a)},t.fontMap={},t.fontCache={},t.attributeLayout=[{name:"position",type:a.AttributeType.VEC2},{name:"uv",type:a.AttributeType.VEC3}],t}(l.Object2D);t.Text=c,t.default=c},function(e,t,n){"use strict";e.exports=n(59)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.getTileStore=function(e,t,n){var r=this.tileStores[e]=this.tileStores[e]||{};return r[t]=r[t]||n(t)},e.clear=function(e){var t=this.tileStores[e];if(void 0!==t){for(var n in t){t[n].clear()}delete this.tileStores[e]}},e.clearAll=function(){for(var e in this.tileStores)this.clear(e)},e.tileStores={},e}();t.SharedTileStore=r,t.default=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=n(12),s=n(48),l=n(11),u=function(e){function t(t){var n=e.call(this,t,[{name:"position",type:i.AttributeType.VEC2}],[{name:"instancePosition",type:i.AttributeType.VEC3},{name:"instanceSize",type:i.AttributeType.VEC2},{name:"instanceColor",type:i.AttributeType.VEC4}],{instancePosition:function(e){return[e.xFractional,e.y,e.z]},instanceSize:function(e){return[e.wFractional,e.h]},instanceColor:function(e){return e.color}})||this;return n.minWidth=0,n.blendFactor=1,n.borderStrength=.3,n.transparent=!0,n}return r(t,e),t.prototype.draw=function(e){e.uniform1f("minWidth",this.minWidth),e.uniform1f("blendFactor",this.blendFactor),e.uniform1f("borderStrength",this.borderStrength),e.uniform2f("groupSize",this.computedWidth,this.computedHeight),e.uniform1f("groupOpacity",this.opacity),e.uniformMatrix4fv("groupModel",!1,this.worldTransformMat4),e.extDrawInstanced(a.DrawMode.TRIANGLES,6,0,this.instanceCount)},t.prototype.allocateGPUVertexState=function(e,t,n){return e.createVertexState({indexBuffer:l.default.quadIndexBuffer,attributeLayout:t,attributes:o({position:{buffer:l.default.quad1x1VertexBuffer,offsetBytes:0,strideBytes:8}},n)})},t.prototype.getVertexCode=function(){return"\n            #version 100\n\n            // for all instances\n            attribute vec2 position;\n            uniform float minWidth;\n            uniform mat4 groupModel;\n            uniform vec2 groupSize;\n\n            // per instance attributes\n            attribute vec3 instancePosition;\n            attribute vec2 instanceSize;\n            attribute vec4 instanceColor;\n\n            varying vec2 vUv;\n\n            varying vec2 size;\n            varying vec4 color;\n\n            void main() {\n                vUv = position;\n\n                // yz are absolute domPx units, x is in fractions of groupSize\n                vec3 pos = vec3(groupSize.x * instancePosition.x, instancePosition.yz);\n                size = vec2(groupSize.x * instanceSize.x, instanceSize.y);\n\n                // apply a minimum size\n                size.x = max(size.x, minWidth);\n\n                color = instanceColor;\n\n                gl_Position = groupModel * vec4(vec3(position * size, 0.0) + pos, 1.0);\n            }\n        "},t.prototype.getFragmentCode=function(){return"\n            #version 100\n\n            precision highp float;\n\n            uniform float blendFactor;\n            uniform float borderStrength;\n            uniform float groupOpacity;\n\n            varying vec2 size;\n            varying vec4 color;\n\n            varying vec2 vUv;\n\n            void main() {\n                vec2 domPx = vUv * size;\n\n                const vec2 borderWidthPx = vec2(1.);\n\n                vec2 inner = step(borderWidthPx, domPx) * step(domPx, size - borderWidthPx);\n                \n                float border = 1.0 - inner.x * inner.y;\n\n                vec4 c = color;\n\n                c.rgb += border * vec3(borderStrength);\n                c.a = mix(c.a, c.a + borderStrength, border);\n\n                gl_FragColor = vec4(c.rgb, blendFactor) * c.a * groupOpacity;\n            }\n        "},t}(s.default);t.default=u},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(14),s=function(e){function t(n,r,o){var i=e.call(this)||this;return i.render=!1,i.reactUid=t.uidCounter++,i._content=n,null!=r&&(i.w=r),null!=o&&(i.h=o),i}return r(t,e),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){this._content=e,this.eventEmitter.emit("setContent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"containerStyle",{get:function(){return this._containerStyle},set:function(e){this._containerStyle=e,this.eventEmitter.emit("setContent",this._content)},enumerable:!0,configurable:!0}),t.prototype.addSetContentListener=function(e){this.eventEmitter.addListener("setContent",e)},t.prototype.removeSetContentListener=function(e){this.eventEmitter.removeListener("setContent",e)},t.prototype.addWorldTransformUpdatedListener=function(e){this.eventEmitter.addListener("worldTransformUpdated",e)},t.prototype.removeWorldTransformUpdatedListener=function(e){this.eventEmitter.removeListener("worldTransformUpdated",e)},t.prototype.applyWorldTransform=function(t){e.prototype.applyWorldTransform.call(this,t),this.eventEmitter.emit("worldTransformUpdated",this.worldTransformMat4,this.computedWidth,this.computedHeight)},t.uidCounter=0,t}(i.default);t.ReactObject=s;var l=function(e){function t(t){var n=e.call(this,t)||this;n.updateTransformState=function(e,t,r){n.setState({worldTransform:e,computedWidth:t,computedHeight:r})},n.updateContentState=function(e){n.setState({content:e})};var r=t.reactObject;return n.state={content:t.reactObject.content,worldTransform:r.worldTransformMat4,computedWidth:r.computedWidth,computedHeight:r.computedHeight,style:t.reactObject.containerStyle},n}return r(t,e),t.prototype.componentDidMount=function(){this.props.reactObject.addWorldTransformUpdatedListener(this.updateTransformState),this.props.reactObject.addSetContentListener(this.updateContentState)},t.prototype.componentWillUnmount=function(){this.props.reactObject.removeWorldTransformUpdatedListener(this.updateTransformState),this.props.reactObject.removeSetContentListener(this.updateContentState)},t.prototype.render=function(){var e=this.props.scene,t=this.state.worldTransform,n=(t[12]-e.x)/e.sx,r=(t[13]-e.y)/e.sy,i=(t[14]-e.z)/e.sz,s=t[0]/e.sx,l=t[5]/e.sy,u=t[10]/e.sz;return a.createElement("div",{className:"react-object-container",style:o({},this.state.style,{position:"absolute",transform:"matrix3d(\n                    "+s+" , 0     , 0     , 0 ,\n                    0     , "+l+" , 0     , 0 ,\n                    0     , 0     , "+u+" , 0 ,\n                    "+n+"  , "+r+"  , "+i+"  , 1\n                )",width:this.state.computedWidth,height:this.state.computedHeight})},this.state.content)},t}(a.Component);t.ReactObjectContainer=l,t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_SPRING={tension:250,friction:2*Math.sqrt(250)}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){void 0===n&&(n=[0,0,0,1]);var r=e.call(this)||this;return r.text=t,r.color=new Float32Array(4),r.additiveBlendFactor=0,r.glyphLayoutChanged=function(){r.worldTransformNeedsUpdate=!0,r.text.removeEventListener("glyphLayoutChanged",r.glyphLayoutChanged)},r.color.set(n),r.transparent=!0,r.blendMode=t.blendMode,r}return r(t,e),Object.defineProperty(t.prototype,"_w",{get:function(){return this.text.w},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_h",{get:function(){return this.text.h},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"render",{get:function(){return this.text.render},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.onAdded=function(){0===this.text.w&&this.text.addEventListener("glyphLayoutChanged",this.glyphLayoutChanged)},t.prototype.allocateGPUResources=function(e){var t=this.text;t.gpuResourcesNeedAllocate&&(t.allocateGPUResources(e),t.gpuResourcesNeedAllocate=!1),this.gpuProgram=t.gpuProgram,this.gpuVertexState=t.gpuVertexState},t.prototype.releaseGPUResources=function(){},t.prototype.draw=function(e){this.text.worldTransformMat4=this.worldTransformMat4,this.text.color=this.color,this.text.additiveBlendFactor=this.additiveBlendFactor,this.text.draw(e)},t}(n(0).default);t.TextClone=o,t.default=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.call(this)||this;return t.render=!0,t.opacity=1,t.visible=!0,t.mask=null,t.gpuProgram=null,t.gpuVertexState=null,t.gpuResourcesNeedAllocate=!0,t._renderStateKey=0,t._maskIndex=-1,t}return r(t,e),t.prototype.allocateGPUResources=function(e){},t.prototype.releaseGPUResources=function(){},t.prototype.draw=function(e){},t}(n(53).default);t.Renderable=o,t.default=o},function(e,t,n){"use strict";(function(t){var r=n(1),o=n(82),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(42):void 0!==t&&(e=n(42)),e}(),transformRequest:[function(e,t){return o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],function(e){s.headers[e]={}}),r.forEach(["post","put","patch"],function(e){s.headers[e]=r.merge(i)}),e.exports=s}).call(this,n(83))},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(14),a=n(2),s=n(7),l=n(0),u=n(17),c=n(9),f=n(24),d=n(29),h=n(18),p=function(e){function t(){var t=e.call(this)||this;t.trackHeaderWidth=180,t.panelHeaderHeight=50,t.spacing={x:5,y:5},t.xAxisHeight=40,t.minPanelWidth=35,t.minTrackHeight=35,t.panels=new Set,t.tracks=new Array,t.panelEdges=new Array,t.rowOffsetY=0,t.deleteTrack=function(e){t.deleteRowObject(e.rowObject);var n=t.tracks.indexOf(e);-1!==n&&t.tracks.splice(n,1)},t.deleteRowObject=function(e){var n,r,i,a,s,l;t.grid.remove(e.header),t.grid.remove(e.closeButton),t.grid.remove(e.resizeHandle);try{for(var u=o(t.panels),c=u.next();!c.done;c=u.next()){var f=c.value;try{for(var d=o(e.trackViews),h=d.next();!h.done;h=d.next()){var p=h.value;f.removeTrackView(p)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}try{for(var v=o(e.trackViews),y=v.next();!y.done;y=v.next()){var g=y.value;g.releaseGPUResources(),e.removeTrackView(g)}}catch(e){s={error:e}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(s)throw s.error}}},t.deletePanel=function(e){var n,r,i,a;if(e.closing||(console.warn("cleanupPanel() called before closing the panel"),t.closePanel(e,!1)),t.panels.has(e)){t.panels.delete(e),s.default.stop(e),s.default.removeAnimationCompleteCallbacks(e,"layoutW",t.deletePanel),t.grid.remove(e);try{for(var l=o(e.trackViews),u=l.next();!u.done;u=l.next()){var c=u.value;c.releaseGPUResources(),e.remove(c);try{for(var f=o(t.tracks),d=f.next();!d.done;d=f.next()){d.value.rowObject.removeTrackView(c)}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}e.releaseGPUResources(),e.removeAllListeners(!0)}else console.error("Cleanup executed twice on a panel")},t.onAnimationStep=function(){var e,n,r=1;try{for(var i=o(t.panels),a=i.next();!a.done;a=i.next()){var s=a.value;r=Math.max(s.layoutParentX+s.layoutW,r)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}t.addPanelButton.layoutParentX=r},t.onResize=function(e){t.applyOverflowLimits(),t.layoutTrackRows(!1)},t._resizingPanels=new Set,t._resizingTracks=new Set,t.render=!1,t.layoutW=1,t.layoutH=1,t.grid=new c.default(0,0,[.9,.9,.9,1]),t.grid.render=!1,t.add(t.grid),t.initializeDragPanning(),t.initializeGridResizing(),t.addPanelButton=new u.default(i.createElement(x,{onClick:function(){t.addPanel({contig:"chr1",x0:0,x1:249e6},!0)}}),t.panelHeaderHeight,t.panelHeaderHeight),t.addPanelButton.x=.5*t.spacing.x,t.addPanelButton.containerStyle={zIndex:3},t.addPanelButton.layoutParentX=1,t.addPanelButton.layoutY=-1,t.addPanelButton.y=-t.xAxisHeight-.5*t.spacing.x,t.grid.add(t.addPanelButton);var n=new u.default(i.createElement("div",{style:{backgroundColor:"#fff",zIndex:2,width:"100%",height:"100%"}}),t.trackHeaderWidth+t.spacing.x,t.panelHeaderHeight+t.xAxisHeight-.5*t.spacing.y);t.add(n);var r=new u.default(i.createElement("div",{style:{backgroundColor:"#fff",zIndex:2,width:"100%",height:"100%"}}),t.panelHeaderHeight+1.5*t.spacing.x,t.panelHeaderHeight+t.xAxisHeight-.5*t.spacing.y);return r.layoutParentX=1,r.x=-t.panelHeaderHeight-1.5*t.spacing.x,t.add(r),t.layoutGridContainer(),window.addEventListener("resize",t.onResize),t}return r(t,e),t.prototype.addTrack=function(e,t,n){var r,i,a=this;void 0===t&&(t=50),void 0===n&&(n=!0);var s=new v(e,t,function(){a.layoutTrackRows(!0)}),l=new y(e.name,this.spacing,function(){return a.closeTrack(s)},function(e){return s.heightPx=e},function(){return s.heightPx});s.rowObject=l;try{for(var u=o(this.panels),c=u.next();!c.done;c=u.next()){var f=c.value,h=d.default(e);f.addTrackView(h),l.addTrackView(h)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return this.tracks.push(s),l.closeButton.layoutParentX=1,l.closeButton.x=-this.spacing.x,l.closeButton.w=50,l.header.x=-this.trackHeaderWidth+.5*this.spacing.x,l.header.w=this.trackHeaderWidth,l.resizeHandle.layoutW=1,l.resizeHandle.addInteractionListener("dragstart",function(e){e.isPrimary&&1===e.buttonState&&(e.preventDefault(),a.startResizingTrack(s))}),l.resizeHandle.addInteractionListener("dragend",function(e){e.isPrimary&&(e.preventDefault(),a.endResizingTrack(s))}),l.setResizable(!0),this.grid.add(l.header),this.grid.add(l.closeButton),this.grid.add(l.resizeHandle),this.layoutTrackRows(!1,l),l.h=0,this.layoutTrackRows(n),s},t.prototype.closeTrack=function(e,t,n){var r=this;if(void 0===t&&(t=!0),void 0===n&&(n=function(){}),-1!==this.tracks.indexOf(e)){var o=e,i=o.rowObject;o.closing||(o.closing=!0,i.setResizable(!1),this.endResizingTrack(e),e.heightPx=0,t?s.default.addAnimationCompleteCallback(i,"h",function(){r.deleteTrack(e),n()},!0):(s.default.stop(i),this.deleteTrack(e),n()),this.layoutTrackRows(t))}},t.prototype.addPanel=function(e,t){var n,r,i=this;void 0===t&&(t=!0);var s=this.panelEdges,l=Math.max(s.length-1,0);0===s.length&&s.push(0);var u=1+(0==l?1:1/l);s.push(u);var c=new f.default(function(e){return i.closePanel(e,!0)},this.spacing,this.panelHeaderHeight,this.xAxisHeight);c.setContig(e.contig),c.setRange(e.x0,e.x1),c.column=l,c.layoutH=1,this.grid.add(c),a.SiriusApi.getContigsSorted().then(function(e){return c.setAvailableContigs(e)});try{for(var h=o(this.tracks),p=h.next();!p.done;p=h.next()){var v=p.value,y=d.default(v.model);c.addTrackView(y),v.rowObject.addTrackView(y)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}this.panels.add(c),c.resizeHandle.addInteractionListener("dragstart",function(e){e.isPrimary&&1===e.buttonState&&(e.preventDefault(),i.startResizingPanel(c))}),c.resizeHandle.addInteractionListener("dragend",function(e){e.isPrimary&&(e.preventDefault(),i.endResizingPanel(c))}),c.addEventListener("axisPointerUpdate",function(e){var t,n;try{for(var r=o(i.panels),a=r.next();!a.done;a=r.next()){var s=a.value;s!==c&&s.setSecondaryAxisPointers(e)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}),this.layoutPanels(!1,c);for(var g=1/u,m=0;m<s.length;m++)s[m]*=g;this.layoutPanels(t)},t.prototype.closePanel=function(e,t,n){var r,i,a=this;if(void 0===t&&(t=!0),void 0===n&&(n=function(){}),!e.closing){var l=this.panelEdges;e.closing=!0,this.endResizingPanel(e),this.removeColumn(l,e.column);try{for(var u=o(this.panels),c=u.next();!c.done;c=u.next()){var f=c.value;f.column>e.column&&(f.column=f.column-1)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}this.layoutPanels(t),t?(s.default.addAnimationCompleteCallback(e,"layoutW",function(){a.deletePanel(e),n()},!0),s.default.springTo(e,{layoutW:0},h.DEFAULT_SPRING)):(s.default.stop(e),this.deletePanel(e),n()),l.length<2&&(l.length=0)}},t.prototype.getConfiguration=function(){var e,t,n,r,i=new Array;try{for(var a=o(this.panels),s=a.next();!s.done;s=a.next()){var l=s.value,u=this.panelEdges[l.column+1]-this.panelEdges[l.column];i.push({location:{contig:l.contig,x0:l.x0,x1:l.x1},width:u})}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}var c=new Array;try{for(var f=o(this.tracks),d=f.next();!d.done;d=f.next()){var h=d.value;c.push({model:h.model,heightPx:h.heightPx})}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}return{panels:i,tracks:c}},t.prototype.setConfiguration=function(e){var t,n,r,i,a,s,l=new Set(this.panels);try{for(var u=o(l),c=u.next();!c.done;c=u.next()){var f=c.value;this.closePanel(f,!1)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}var d=new Set(this.tracks);try{for(var h=o(d),p=h.next();!p.done;p=h.next()){var v=p.value;this.closeTrack(v,!1)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}for(var y=0;y<e.panels.length;y++){var g=e.panels[y];this.addPanel(g.location,!1)}var m=1,x=0;for(y=0;y<e.panels.length;y++){null!=(g=e.panels[y]).width?m-=g.width:x++}var _=m/x,b=0;for(y=0;y<e.panels.length;y++){g=e.panels[y];this.panelEdges[y]=b,null!=g.width?b+=g.width:b+=_}this.layoutPanels(!1);try{for(var T=o(e.tracks),w=T.next();!w.done;w=T.next()){v=w.value;this.addTrack(v.model,v.heightPx,!1)}}catch(e){a={error:e}}finally{try{w&&!w.done&&(s=T.return)&&s.call(T)}finally{if(a)throw a.error}}this.layoutTrackRows(!1)},t.prototype.getTracks=function(){return this.tracks.slice()},t.prototype.getPanels=function(){return new Set(this.panels)},t.prototype.layoutPanels=function(e,t){var n,r,i,a,l=0;try{for(var u=o(this.panels),c=u.next();!c.done;c=u.next()){(p=c.value).closing||l++}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}try{for(var f=o(this.panels),d=f.next();!d.done;d=f.next()){var p;if((p=d.value).closable=l>1,p.setResizable(p.column<this.panelEdges.length-2&&!p.closing),void 0===t||t===p){var v=this.panelEdges,y=v[p.column],g=p.closing?0:v[p.column+1]-v[p.column];e?s.default.springTo(p,{layoutParentX:y,layoutW:g},h.DEFAULT_SPRING):(s.default.stop(p,["layoutParentX","layoutW"]),p.layoutParentX=y,p.layoutW=g)}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}},t.prototype.layoutTrackRows=function(e,t){var n,r,i=0;try{for(var a=o(this.tracks),l=a.next();!l.done;l=a.next()){var u=l.value,c=u.heightPx,f=u.rowObject;void 0!==t&&t!==f||(e?s.default.springTo(f,{y:i,h:c},h.DEFAULT_SPRING):(s.default.stop(f,["y","h"]),f.y=i+this.rowOffsetY,f.h=c)),i+=u.heightPx}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}this.grid.h=i+.5*this.spacing.y+this.rowOffsetY},t.prototype.removeColumn=function(e,t){if(t>=e.length||t<0)return!1;for(var n=e[0],r=e[e.length-1],o=e[t],i=e[t+1]||r,a=o-n,s=r-i,l=s+a,u=(0==l?.5:a/l)*(i-o)+o,c=u-n,f=0==s?0:(r-u)/s,d=t+1;d<e.length;d++)e[d]=u+(e[d]-i)*f;var h=c/a;for(d=0;d<t;d++)e[d]=n+(e[d]-n)*h;return e.splice(t,1),!0},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),s.default.addStepCompleteCallback(this.onAnimationStep)},t.prototype.onRemoved=function(){e.prototype.onRemoved.call(this),s.default.removeStepCompleteCallback(this.onAnimationStep)},t.prototype.layoutGridContainer=function(){this.grid.x=this.trackHeaderWidth+.5*this.spacing.x,this.grid.w=-this.trackHeaderWidth-this.spacing.x-this.addPanelButton.w,this.grid.layoutW=1,this.grid.y=this.panelHeaderHeight+.5*this.spacing.y+this.xAxisHeight},t.prototype.applyOverflowLimits=function(){var e,t,n=this.getComputedHeight()-this.grid.y,r=0;try{for(var i=o(this.tracks),a=i.next();!a.done;a=i.next()){r+=a.value.heightPx}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}var s=-(r-n+this.spacing.y);this.rowOffsetY=Math.min(Math.max(this.rowOffsetY,s),0)},t.prototype.initializeDragPanning=function(){var e=this,t=void 0,n=void 0;this.addEventListener("dragstart",function(r){t=r.localY,n=e.rowOffsetY}),this.addEventListener("dragmove",function(r){if(!(e._resizingPanels.size>0||e._resizingTracks.size>0)){var o=r.localY-t;e.rowOffsetY=n+o,e.applyOverflowLimits(),e.layoutTrackRows(!1)}})},t.prototype.initializeGridResizing=function(){var e=this,t={},n=0;this.grid.addInteractionListener("dragstart",function(r){var i,a;e._resizingPanels.size+e._resizingTracks.size>0&&(r.preventDefault(),r.stopPropagation());try{for(var s=o(e._resizingPanels),l=s.next();!l.done;l=s.next()){var u=l.value,c=u.column+1;t[c]={i:c,p0:r.fractionX,e0:e.panelEdges[c],obj:u}}}catch(e){i={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}r.isPrimary&&1===r.buttonState&&(n=r.localY)}),this.grid.addInteractionListener("dragmove",function(r){var i,a,s,l,u=!1,c=e._resizingPanels.size+e._resizingTracks.size>0;for(var f in c&&(r.preventDefault(),r.stopPropagation()),t){var d=t[f],h=r.fractionX-d.p0,p=e.grid.getComputedWidth(),v=e.minPanelWidth/p,y=e.panelEdges[d.i-1]+v||0,g=e.panelEdges[d.i+1]-v||1;e.panelEdges[d.i]=Math.min(Math.max(d.e0+h,y),g);try{for(var m=o(e.panels),x=m.next();!x.done;x=m.next()){var _=x.value;_.column!==d.i&&_.column!==d.i-1||e.layoutPanels(!1,_)}}catch(e){i={error:e}}finally{try{x&&!x.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}u=!0}if(r.isPrimary)try{for(var b=o(e._resizingTracks),T=b.next();!T.done;T=b.next()){var w=T.value,E=r.localY-n;w.track.heightPx=Math.max(w.initialHeightPx+E,e.minTrackHeight),u=!0}}catch(e){s={error:e}}finally{try{T&&!T.done&&(l=b.return)&&l.call(b)}finally{if(s)throw s.error}}u&&e.layoutTrackRows(!1)}),this.grid.addInteractionListener("dragend",function(n){for(var r in t){var o=t[r];e._resizingPanels.has(o.obj)||delete t[r]}})},t.prototype.startResizingPanel=function(e){this._resizingPanels.add(e)},t.prototype.endResizingPanel=function(e){this._resizingPanels.delete(e)},t.prototype.startResizingTrack=function(e){this._resizingTracks.add({track:e,initialHeightPx:e.heightPx})},t.prototype.endResizingTrack=function(e){var t,n;try{for(var r=o(this._resizingTracks),i=r.next();!i.done;i=r.next()){var a=i.value;a.track===e&&this._resizingTracks.delete(a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}this.applyOverflowLimits(),this.layoutTrackRows(!1)},t}(l.default);t.default=p;var v=function(){function e(e,t,n){this.model=e,this._heightPx=t,this.onHeightChanged=n,this.closing=!1}return Object.defineProperty(e.prototype,"heightPx",{get:function(){return this._heightPx},set:function(e){this._heightPx=e,this.onHeightChanged()},enumerable:!0,configurable:!0}),e}();t.Track=v;var y=function(){function e(t,n,r,o,i){var a=this;this.spacing=n,this.onClose=r,this.setHeight=o,this.getHeight=i,this.trackViews=new Set,this._headerIsExpandedState=void 0,this.isExpanded=function(){return a.getHeight()>=e.expandedTrackHeight},this._title=t,this.header=new u.default,this.closeButton=new u.default,this.resizeHandle=new c.default(0,0,[1,0,0,1]),this.resizeHandle.h=this.spacing.y,this.resizeHandle.z=1,this.resizeHandle.render=!1,this.setResizable(!1),this.updateHeader()}return Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this.layoutY()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"h",{get:function(){return this._h},set:function(e){this._h=e,this.layoutY()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e,this.updateHeader()},enumerable:!0,configurable:!0}),e.prototype.setResizable=function(e){this.resizeHandle.cursorStyle=e?"row-resize":null,this.resizeHandle.color.set(e?[0,1,0,1]:[.3,.3,.3,1])},e.prototype.addTrackView=function(e){this.trackViews.add(e),this.layoutY()},e.prototype.removeTrackView=function(e){this.trackViews.delete(e)},e.prototype.layoutY=function(){var e,t,n=this.resizeHandle;n.layoutY=-.5,n.y=this.y+this.h,this.header.y=this.y+.5*this.spacing.y,this.header.h=this.h-this.spacing.y,this.closeButton.y=this.y+.5*this.spacing.y,this.closeButton.h=this.h-this.spacing.y;try{for(var r=o(this.trackViews),i=r.next();!i.done;i=r.next()){var a=i.value;a.y=this.y+.5*this.spacing.y,a.h=this.h-this.spacing.y}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this._headerIsExpandedState!==this.isExpanded()&&this.updateHeader()},e.prototype.updateHeader=function(){var t=this;this._headerIsExpandedState=this.isExpanded(),this.header.content=i.createElement(m,{title:this._title,isExpanded:this._headerIsExpandedState,setExpanded:function(n){t.setHeight(n?e.expandedTrackHeight:e.collapsedTrackHeight)}}),this.closeButton.content=i.createElement(g,{track:this,onClick:function(){t.onClose(t)}})},e.expandedTrackHeight=200,e.collapsedTrackHeight=50,e}();function g(e){return i.createElement("div",{style:{position:"relative",height:"100%",width:"100%",color:"#e8e8e8",overflow:"hidden",userSelect:"none",backgroundColor:"#171615",borderRadius:"0px 8px 8px 0px"}},i.createElement("div",{style:{position:"absolute",width:"100%",textAlign:"right",top:"50%",transform:"translate(0, -50%)"}},i.createElement("span",{onClick:function(){return e.onClick(e.track)}},"X")))}function m(e){var t=e.isExpanded?i.createElement("span",null,"-"):i.createElement("span",null,"+");return i.createElement("div",{style:{position:"relative",width:"100%",height:"100%",color:"#e8e8e8",backgroundColor:"#171615",borderRadius:"8px 0px 0px 8px",fontSize:"15px",overflow:"hidden",userSelect:"none"}},i.createElement("div",{style:{position:"absolute",width:"100%",textAlign:"center",top:"50%",transform:"translate(0, -50%)"}},i.createElement("div",{onClick:function(){e.setExpanded(!e.isExpanded)},style:{display:"flex",alignItems:"center",justifyContent:"flex-start"}},t,e.title)))}function x(e){return i.createElement("div",{style:{position:"relative",width:"100%",height:"100%",color:"#e8e8e8",backgroundColor:"#171615",borderRadius:"8px 0px 0px 8px"}},i.createElement("div",{style:{position:"absolute",width:"100%",textAlign:"right",top:"50%",transform:"translate(0, -50%)"}},i.createElement("span",{onClick:e.onClick},"+")))}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(9),a=n(13),s=n(8),l=n(6),u=function(e){function t(t,n,r,o,a,s,u){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r=16),void 0===a&&(a=0),void 0===s&&(s=1),void 0===u&&(u=0);var f=e.call(this)||this;return f.fontPath=o,f.offset=a,f.snap=s,f.startFrom=u,f.maxMajorTicks=1e4,f.minDisplay=-1/0,f.maxDisplay=1/0,f.x0=0,f.x1=1,f._maxTextLength=4,f.labelCache=new l.UsageCache,f.createLabel=function(e){var t=new c(f.fontPath,e,f.fontSizePx);return t.layoutParentY=1,t.z=.1,t.setMask(f.clippingMask),f.add(t),t},f.deleteLabel=function(e){e.releaseGPUResources(),f.remove(e)},f.render=!1,f.x0=t,f.x1=n,f._fontSizePx=r,f.labelsNeedUpdate=!0,f.clippingMask=new i.default(0,0,[.9,.9,.9,1]),f.clippingMask.layoutW=1,f.clippingMask.layoutH=1,f.clippingMask.opacity=0,f.add(f.clippingMask),f}return r(t,e),Object.defineProperty(t.prototype,"maxTextLength",{get:function(){return this._maxTextLength},set:function(e){var t=this._maxTextLength!==e;this._maxTextLength=e,t&&(this.labelsNeedUpdate=!0,this.labelCache.removeAll(this.deleteLabel))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSizePx",{get:function(){return this._fontSizePx},set:function(e){this._fontSizePx=e,this.labelCache.removeAll(this.deleteLabel),this.labelsNeedUpdate=!0},enumerable:!0,configurable:!0}),t.prototype.setRange=function(e,t){this.labelsNeedUpdate=this.labelsNeedUpdate||this.x0!==e||this.x1!==t,this.x0=e,this.x1=t},t.prototype.applyTransformToSubNodes=function(t){this.labelsNeedUpdate=this.labelsNeedUpdate||this.computedWidth!==this.lastComputedWidth,this.labelsNeedUpdate&&(this.updateLabels(),this.lastComputedWidth=this.computedWidth),e.prototype.applyTransformToSubNodes.call(this,t)},t.prototype.updateLabels=function(){var e=this;this.labelCache.markAllUnused();var n=this.x1-this.x0;if(0!==n){for(var r=160/this.computedWidth,o=this.snap,i=s.Scalar.log2(r*n/o),a=Math.ceil(i),l=Math.floor(i),u=i-l,c=Math.pow(1-u,5),f=o*Math.pow(2,a),d=o*Math.pow(2,l)*2,h=Math.floor(this.x0/f),p=Math.ceil(this.x1/f),v=this.maxMajorTicks,y=function(r){v--;var o=d*(r+.5),i=f*r;if(o>=g.minDisplay&&o<=g.maxDisplay&&isFinite(o)){var a=(o-g.x0+g.offset)/n,s=t.formatValue(o+g.startFrom,g._maxTextLength),l=g.labelCache.get(o+"_"+s,function(){return e.createLabel(s)});l.layoutParentX=a,l.setColor(0,0,0,c),l.opacity=c}if(i>=g.minDisplay&&i<=g.maxDisplay&&isFinite(i)){var u=(i-g.x0+g.offset)/n,h=t.formatValue(i+g.startFrom,g._maxTextLength),p=g.labelCache.get(i+"_"+h,function(){return e.createLabel(h)});p.layoutParentX=u,p.setColor(0,0,0,1)}},g=this,m=h;m<=p&&v>0;m++)y(m);this.labelCache.removeUnused(this.deleteLabel),this.labelsNeedUpdate=!1}else this.labelCache.removeUnused(this.deleteLabel)},t.toFixedTrunc=function(e,t){var n=e.toString(),r=/([\d+-]+)(\.(\d*))?(.*)/.exec(n);if(null==r)return n;for(var o=r[1],i=r[3],a=r[4],s=(i||"").substring(0,t),l=s.length;l<t;l++)s+="0";return o+(s.length>0?"."+s:"")+a},t.formatValue=function(e,n){var r=e.toString();if(r.length>n){var o=s.Scalar.log10(Math.abs(e)),i=s.Scalar.sign(o),a=Math.floor(Math.abs(o/3))*i,l=t.siPrefixes[a.toFixed(0)],u=Math.pow(1e3,a);if(void 0===l){var c=Math.floor(Math.abs(o))*i;l=c<=3?"":"e"+c.toFixed(0)}var f=e/u,d=n-Math.floor(f).toFixed(0).length-l.length-1;r=t.toFixedTrunc(f,Math.max(d,0))+l}return r},t.siPrefixes={8:"Y",7:"Z",6:"E",5:"P",4:"T",3:"G",2:"M",1:"k","-1":"m","-2":"","-3":"n","-4":"p","-5":"f","-6":"a","-7":"z","-8":"y"},t}(o.default);t.XAxis=u;var c=function(e){function t(t,n,r){var o=e.call(this)||this;return o.text=new a.default(t,n,r),o.text.layoutX=-.5,o.text.layoutY=-1,o.text.y=-8,o.add(o.text),o.tick=new i.default(1,5),o.tick.layoutX=-.5,o.tick.layoutY=-1,o.tick.transparent=!0,o.add(o.tick),o.render=!1,o.setColor(0,0,0,1),o}return r(t,e),t.prototype.setColor=function(e,t,n,r){this.text.color.set([e,t,n,r]),this.tick.color.set([e,t,n,.5*r])},t.prototype.setMask=function(e){this.text.mask=e,this.tick.mask=e},t.prototype.releaseGPUResources=function(){this.text.releaseGPUResources(),this.tick.releaseGPUResources()},t}(o.default);t.default=u},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(14),s=n(31),l=n(0),u=n(17),c=n(9),f=n(10),d=n(5),h=n(23),p=n(7);!function(e){e[e.Move=0]="Move",e[e.SelectRegion=1]="SelectRegion"}(i||(i={}));var v=function(e){function t(t,n,r,a){var l=e.call(this)||this;l.onClose=t,l.spacing=n,l.panelHeaderHeight=r,l.xAxisHeight=a,l.maxRange=1e10,l.minRange=10,l.trackViews=new Set,l._closable=!1,l._closing=!1,l.x0=0,l.x1=1,l.activeAxisPointers={},l.secondaryAxisPointers={},l.tileDragging=!1,l.tileHovering=!1,l.isEditing=!1,l._rangeAnimationObject={_setRangeInternal:function(e,t){l.setRangeImmediate(e,t)},_x0:l.x0,_x1:l.x1,set x0(e){this._x0=e,this._setRangeInternal(this._x0,this._x1)},set x1(e){this._x1=e,this._setRangeInternal(this._x0,this._x1)},get x0(){return this._x0},get x1(){return this._x1}},l.onTileLeave=function(e){l.tileHovering=!1,l.tileDragging||l.removeActiveAxisPointer(e)},l.onTilePointerMove=function(e){l.tileHovering=!0,l._dragMode=void 0,l.setActiveAxisPointer(e)},l.onTileWheel=function(e){e.preventDefault(),e.stopPropagation();var t=0,n=0;switch(e.wheelDeltaMode){default:case s.WheelDeltaMode.Pixel:t=e.wheelDeltaX,n=e.wheelDeltaY;break;case s.WheelDeltaMode.Line:t=12*e.wheelDeltaX,n=12*e.wheelDeltaY;break;case s.WheelDeltaMode.Page:t=1e3*e.wheelDeltaX,n=1e3*e.wheelDeltaY}var r=t*t+n*n;r<=0&&(r=1);var o=Math.sqrt(r),i=t/o,a=n/o,u=2*Math.acos(Math.abs(a))/Math.PI,c=2*Math.acos(Math.abs(i))/Math.PI;t*=Math.sin(Math.pow(Math.min(u/.75,1),3)*(Math.PI/2)),n*=Math.sin(Math.pow(Math.min(c/.75,1),3)*(Math.PI/2));var f=1;if(e.ctrlKey)f=1+.01*e.wheelDeltaY;else{f=1+.01*n*.3}var d=l.x0,h=l.x1,p=h-d,v=e.fractionX;p*f>l.maxRange&&(f=l.maxRange/p),p*f<l.minRange&&(f=l.minRange/p);var y=p*v,g=y+d,m=.5*((h=g+p*(1-v)*f)-(d=g-y*f)+p)/l.getComputedWidth()*t;d+=m,h+=m,l.setRange(d,h)},l.onTileDragStart=function(e){var t,n;if(l._dragMode=void 0,1===e.buttonState)switch(e.shiftKey?l._dragMode=i.SelectRegion:l._dragMode=i.Move,l._dragXF0=e.fractionX,l._dragX00=l.x0,l._lastDragLX=e.localX,l._dragDistLocal=0,l._dragMode){case i.SelectRegion:e.preventDefault();try{for(var r=o(l.trackViews),a=r.next();!a.done;a=r.next()){a.value.setFocusRegion(l._dragXF0,l._dragXF0)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}break;case i.Move:e.preventDefault(),l.tileDragging=!0}},l.onTileDragMove=function(e){var t,n;if(1===e.buttonState){switch(l._dragDistLocal+=Math.abs(e.localX-l._lastDragLX),l._lastDragLX=e.localX,l._dragMode){case i.SelectRegion:e.preventDefault();var r=l._dragXF0,a=e.fractionX;try{for(var s=o(l.trackViews),u=s.next();!u.done;u=s.next()){u.value.setFocusRegion(r,a)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}break;case i.Move:e.preventDefault(),l.tileDragging=!0;var c=l.x1-l.x0,f=e.fractionX-l._dragXF0,d=l._dragX00+c*-f,h=d+c;l.setRange(d,h)}l.setActiveAxisPointer(e)}},l.onTileDragEnd=function(e){var t,n;switch(e.stopPropagation(),l._dragMode){case i.SelectRegion:e.preventDefault();var r=l.x1-l.x0,a=l.x0+r*l._dragXF0,s=l.x0+r*e.fractionX,u=Math.min(a,s),c=Math.max(a,s);u=Math.max(u,l.x0),c=Math.min(c,l.x1),l.setRange(u,c,!0);break;case i.Move:l._dragDistLocal>4&&e.preventDefault()}try{for(var f=o(l.trackViews),d=f.next();!d.done;d=f.next()){d.value.disableFocusRegion()}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}l.tileDragging=!1,l.tileHovering||l.removeActiveAxisPointer(e),l._dragMode=void 0},l.availableContigAtOffset=function(e,t){if(null!=l.availableContigs){var n=l.availableContigs.indexOf(e);if(n<0)return l.availableContigs[0];var r=(n+t)%l.availableContigs.length;return r<0&&(r+=l.availableContigs.length),l.availableContigs[r]}return l.contig},l.render=!1,l.header=new u.default,l.fillX(l.header),l.header.h=l.panelHeaderHeight,l.header.containerStyle={zIndex:3,backgroundColor:"#fff"},l.header.layoutY=-1,l.header.y=-l.xAxisHeight-.5*l.spacing.y,l.add(l.header);return l.xAxis=new h.default(l.x0,l.x1,11,f.OpenSansRegular,.5,1,1),l.xAxis.minDisplay=0,l.xAxis.maxDisplay=1/0,l.xAxis.y=-l.spacing.y,l.xAxis.h=l.xAxisHeight,l.xAxis.layoutY=-1,l.fillX(l.xAxis),l.add(l.xAxis),l.resizeHandle=new c.default(0,0,[1,0,0,1]),l.resizeHandle.layoutX=-.5,l.resizeHandle.layoutX=-.5,l.resizeHandle.layoutParentX=1,l.resizeHandle.layoutParentX=1,l.resizeHandle.w=l.spacing.x,l.resizeHandle.layoutH=1,l.resizeHandle.z=1,l.resizeHandle.render=!1,l.setResizable(!1),l}return r(t,e),Object.defineProperty(t.prototype,"closable",{get:function(){return this._closable},set:function(e){this._closable=e,this.updatePanelHeader()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closing",{get:function(){return this._closing},set:function(e){this._closing=e,this.updatePanelHeader()},enumerable:!0,configurable:!0}),t.prototype.setResizable=function(e){this.remove(this.resizeHandle),e&&this.add(this.resizeHandle),this.resizeHandle.cursorStyle=e?"col-resize":null,this.resizeHandle.color.set(e?[0,1,0,1]:[.3,.3,.3,1])},t.prototype.addTrackView=function(e){e.addInteractionListener("dragstart",this.onTileDragStart),e.addInteractionListener("dragmove",this.onTileDragMove),e.addInteractionListener("dragend",this.onTileDragEnd),e.addInteractionListener("pointerup",this.onTileDragEnd),e.addInteractionListener("wheel",this.onTileWheel),e.addInteractionListener("pointermove",this.onTilePointerMove),e.addInteractionListener("pointerleave",this.onTileLeave),e.setContig(this.contig),e.setRange(this.x0,this.x1),this.fillX(e),this.add(e),this.trackViews.add(e)},t.prototype.removeTrackView=function(e){e.removeInteractionListener("dragstart",this.onTileDragStart),e.removeInteractionListener("dragmove",this.onTileDragMove),e.removeInteractionListener("dragend",this.onTileDragEnd),e.removeInteractionListener("pointerup",this.onTileDragEnd),e.removeInteractionListener("wheel",this.onTileWheel),e.removeInteractionListener("pointermove",this.onTilePointerMove),e.removeInteractionListener("pointerleave",this.onTileLeave),this.remove(e),this.trackViews.delete(e)},t.prototype.setContig=function(e){var t,n;this.contig=e;try{for(var r=o(this.trackViews),i=r.next();!i.done;i=r.next()){i.value.setContig(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}var a=/chr(.*)$/.exec(e);this.formattedContig=a?"Chromosome "+a[1]:"<Invalid contig> "+this.contig,this.updatePanelHeader()},t.prototype.setRange=function(e,t,n){void 0===n&&(n=!1),e=isFinite(e)?e:this.x0,t=isFinite(t)?t:this.x1,e=Math.min(e,t);var r=(t=Math.max(e,t))-e;if(r<this.minRange){var o=.5*(e+t);e=o-.5*this.minRange,t=o+.5*this.minRange,r=this.minRange}if(n){var i=3*(2*Math.sqrt(1e4));p.default.springTo(this._rangeAnimationObject,{x0:e,x1:t},{tension:1e4,friction:i})}else p.default.stop(this._rangeAnimationObject),this._rangeAnimationObject.x0=e,this._rangeAnimationObject.x1=t},t.prototype.setAvailableContigs=function(e){this.availableContigs=e,this.updatePanelHeader()},t.prototype.setSecondaryAxisPointers=function(e){var t,n,r,i;for(var a in this.secondaryAxisPointers)if(void 0===e[a]&&void 0===this.activeAxisPointers[a])try{for(var s=o(this.trackViews),l=s.next();!l.done;l=s.next()){l.value.removeAxisPointer(a)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}for(var a in e)if(void 0===this.activeAxisPointers[a]){var u=e[a],c=this.x1-this.x0,f=(u-this.x0)/c;this.secondaryAxisPointers[a]=u;try{for(var h=o(this.trackViews),p=h.next();!p.done;p=h.next()){p.value.setAxisPointer(a,f,d.AxisPointerStyle.Secondary)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}},t.prototype.setRangeImmediate=function(e,t){var n,r;this.x0=e,this.x1=t;var i=t-e;this.xAxis.maxTextLength=i<150?1/0:i<1e5?6:4,this.xAxis.setRange(e,t);try{for(var a=o(this.trackViews),s=a.next();!s.done;s=a.next()){s.value.setRange(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}this.updatePanelHeader()},t.prototype.setActiveAxisPointer=function(e){var t,n,r=e.fractionX,i=(this.x1-this.x0)*r+this.x0;this.activeAxisPointers[e.pointerId]=i;try{for(var a=o(this.trackViews),s=a.next();!s.done;s=a.next()){s.value.setAxisPointer(e.pointerId.toString(),r,d.AxisPointerStyle.Active)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}this.eventEmitter.emit("axisPointerUpdate",this.activeAxisPointers)},t.prototype.removeActiveAxisPointer=function(e){var t,n;if(void 0!==this.activeAxisPointers[e.pointerId]){delete this.activeAxisPointers[e.pointerId];try{for(var r=o(this.trackViews),i=r.next();!i.done;i=r.next()){i.value.removeAxisPointer(e.pointerId.toString())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}this.eventEmitter.emit("axisPointerUpdate",this.activeAxisPointers)}},t.prototype.fillX=function(e){e.x=.5*this.spacing.x,e.layoutX=0,e.layoutParentX=0,e.layoutW=1,e.w=-this.spacing.x},t.prototype.updatePanelHeader=function(){var e=this,t=h.default.formatValue(this.x0,8)+"bp to "+h.default.formatValue(this.x1,8)+"bp",n=Math.floor(this.x0).toFixed(0),r=Math.ceil(this.x1).toFixed(0),o=this.contig+":"+n+"-"+r;this.header.content=a.createElement(y,{panel:this,contig:this.formattedContig,rangeString:t,rangeSpecifier:o,enableClose:this._closable&&!this.closing,enableContigNavigation:null!=this.availableContigs,onClose:this.onClose,isEditing:this.isEditing,onEditCancel:function(){return e.finishEditing()},onEditSave:function(t){return e.finishEditing(t)},onEditStart:function(){return e.startEditing()},onNextContig:function(){return e.setContig(e.availableContigAtOffset(e.contig,1))},onPreviousContig:function(){return e.setContig(e.availableContigAtOffset(e.contig,-1))}})},t.prototype.finishEditing=function(e){this.isEditing=!1,e&&this.setRangeUsingRangeSpecifier(e),this.updatePanelHeader()},t.prototype.startEditing=function(){this.isEditing=!0,this.updatePanelHeader()},t.prototype.setRangeUsingRangeSpecifier=function(e){var t=e.split(":"),n=t[0],r=/chr(.*)$/.exec(n);r&&(n="chr"+r[1].toUpperCase());var o=t[1].split("-");this.setContig(n),this.setRange(parseFloat(o[0]),parseFloat(o[1]))},t}(l.default);t.Panel=v;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=this,t=null,n={display:"flex",alignItems:"center",justifyContent:"center"},r={marginTop:8,marginLeft:8},o=this.props.enableClose?a.createElement("div",{style:{position:"absolute",right:0}},a.createElement("div",{onClick:function(){return e.props.onClose(e.props.panel)}},"X")):null,i=a.createElement("div",{style:{position:"absolute",left:0}},a.createElement("div",{onClick:function(){return e.props.onPreviousContig(e.props.panel)}},"<")),s=a.createElement("div",{style:{position:"absolute",right:0}},a.createElement("div",{onClick:function(){return e.props.onNextContig(e.props.panel)}},">"));return t=this.props.isEditing?a.createElement("div",{style:n},a.createElement("span",null,a.createElement("input",{onChange:function(t){return e.rangeSpecifier=t.target.value},onKeyDown:function(t){"Enter"===t.key&&e.props.onEditSave(e.rangeSpecifier)},type:"text",defaultValue:this.props.rangeSpecifier})),a.createElement("span",{style:r}),a.createElement("span",{style:r}),o):a.createElement("div",{style:n},this.props.enableContigNavigation?i:null,a.createElement("span",{onClick:function(){return e.props.onEditStart()}},a.createElement("b",null,this.props.contig)," ",this.props.rangeString),a.createElement("span",{style:r,onClick:function(){return e.props.onEditStart()}}),this.props.enableContigNavigation?s:null),a.createElement("div",{style:{position:"relative",width:"100%",height:"100%",color:"#e8e8e8",backgroundColor:"#171615",borderRadius:"8px",fontSize:"12px",fontWeight:200,overflow:"hidden",userSelect:"none"}},a.createElement("div",{style:{position:"absolute",width:"100%",textAlign:"center",top:"50%",transform:"translate(0, -50%)",whiteSpace:"nowrap",cursor:"pointer"}},t))},t}(a.Component);t.default=v},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),i=n(8),a=n(35),s=n(15),l=n(3),u=n(5),c=n(16),f=function(e){function t(t){var n=e.call(this,t)||this;return n.blendEnabled=!0,n._pendingTiles=new o.default,n._intervalTileCache=new o.default,n._onStage=new o.default,n.removeTile=function(e){n.remove(e)},n.setBlendMode(t.blendEnabled),n}return r(t,e),t.prototype.setContig=function(t){var n=this,r=this.model.tileStoreType+":"+JSON.stringify(this.model.query);this.tileStore=s.default.getTileStore(r,t,function(e){return new a.default(e,n.model.query)}),e.prototype.setContig.call(this,t)},t.prototype.setBlendMode=function(e){this.blendEnabled=e},t.prototype.updateDisplay=function(){var e=this;this._pendingTiles.markAllUnused(),this._onStage.markAllUnused();var t=this.x0,n=this.x1,r=n-t,o=this.getComputedWidth();if(o>0){var a=r/o,s=i.Scalar.log2(Math.max(a,1));this.tileStore.getTiles(t,n,a,!0,function(n){if(n.state===l.TileState.Complete)e.displayTileNode(n,.9,t,r,s);else{e._pendingTiles.get(e.contig+":"+n.key,function(){return e.createTileLoadingDependency(n)});var o=n.x+.5*n.span,i=e.tileStore.getTile(o,1<<e.tileStore.macroLodLevel,!1);i.state===l.TileState.Complete&&e.displayTileNode(i,.3,t,r,s)}})}this.displayNeedUpdate=!1,this._pendingTiles.removeUnused(this.removeTileLoadingDependency),this._onStage.removeUnused(this.removeTile),this.toggleLoadingIndicator(this._pendingTiles.count>0,!0)},t.prototype.displayTileNode=function(e,t,n,r,o){var a=this,s=this.contig+":"+t+":"+e.key,l=this._intervalTileCache.get(s,function(){return a.createTileNode(e)});l.layoutParentX=(e.x-n)/r,l.layoutW=e.span/r,l.z=t;var u=Math.pow(Math.max(o-2,0)/15,2);l.opacity=this.blendEnabled?i.Scalar.lerp(1,.1,i.Scalar.clamp(u,0,1)):1,this._onStage.get(s,function(){return a.add(l),l})},t.prototype.createTileNode=function(e){for(var t=.5*e.payload.length,n=new Array(t),r=0;r<t;r++){var o=e.payload[2*r+0],i=e.payload[2*r+1],a=(o-e.x)/e.span,s=i/e.span;n[r]={xFractional:a,wFractional:s,y:0,z:0,h:35,color:[74/255,52/255,226/255,.66]}}var l=new c.default(n);return l.minWidth=.5,l.blendFactor=.2,l.y=5,l.mask=this,l},t}(u.default);t.default=f},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=n(6),s=n(8),l=n(15),u=n(3),c=n(33),f=n(0),d=n(9),h=n(13),p=n(10),v=n(5),y=n(16),g=n(19),m=n(2),x=function(e){function t(n){var r=e.call(this,n)||this;return r.macroLodBlendRange=1,r.macroLodThresholdLow=8,r.macroLodThresholdHigh=r.macroLodThresholdLow+r.macroLodBlendRange,r.pointerOverTrack=!1,r._microTileCache=new a.default,r._onStageAnnotations=new a.default,r._sequenceLabelCache=new a.default,r.createBaseLabel=function(e,n,o){var a=new d.Rect(0,0,n);a.blendFactor=0,a.mask=r,a.opacity=0,a.z=.5;a.addInteractionListener("pointermove",function(e){r.pointerOverTrack?(a.cursorStyle="pointer",i.Animator.springTo(a,{opacity:.6},250)):(a.cursorStyle=null,i.Animator.springTo(a,{opacity:0},250))}),a.addInteractionListener("pointerleave",function(){a.cursorStyle=null,i.Animator.springTo(a,{opacity:0},250)}),a.addInteractionListener("pointerup",function(e){r.pointerOverTrack&&e.isPrimary&&(e.preventDefault(),e.stopPropagation(),o())});var s=new f.default;s.z=0,s.layoutParentX=.5,s.layoutParentY=.5;if(null!==e){var l=t.baseTextInstances[e];void 0===l&&(l=t.baseTextInstances["?"]);var u=new g.default(l,[1,1,1,1]);u.additiveBlendFactor=1,u.layoutX=-.5,u.layoutY=-.5,u.mask=r,s.add(u),a.add(s)}return r.add(a),{root:a,textParent:s,text:null}},r.deleteBaseLabel=function(e){null!=e.text&&(e.textParent.remove(e.text),e.text.releaseGPUResources()),r.remove(e.root)},r.addInteractionListener("pointerenter",function(e){r.pointerOverTrack=!0}),r.addInteractionListener("pointerleave",function(e){r.pointerOverTrack=!1}),r}return r(t,e),t.prototype.setContig=function(t){var n=this,r=this.model.type+":"+JSON.stringify(this.model.query);this.tileStore=l.SharedTileStore.getTileStore(r,t,function(e){return new c.VariantTileStore(n.model,t)}),e.prototype.setContig.call(this,t)},t.prototype.updateDisplay=function(){var e=this;this._pendingTiles.markAllUnused(),this._onStageAnnotations.markAllUnused(),this._sequenceLabelCache.markAllUnused();var t=this.x0,n=this.x1,r=n-t,i=this.getComputedWidth();if(i>0){var a=r/i,l=s.default.log2(Math.max(a,1)),c=s.default.linstep(this.macroLodThresholdLow,this.macroLodThresholdHigh,l),f=1-c;this.model.query&&(f=1,c=0),f>0&&this.tileStore.getTiles(t,n,a,!0,function(n){var a,s,l,c;if(n.state===u.TileState.Complete){var d=1/r,h=i*d,p=Math.min(h-1,16),v=1*Math.min(Math.max((p-1)/15,0),1);if((v*=v)>0&&p>0)try{for(var g=o(n.payload),m=g.next();!m.done;m=g.next()){var x=m.value,_=x.baseIndex,b=0,T=x.refSequence.length,w=[1,0,0,1];try{for(var E=o(x.alts),S=E.next();!S.done;S=E.next()){var P=S.value,A=P.length,C=A-T;w=0===C?[1,1,1,1]:C<0?[1,.3,.5,1]:[.3,1,.5,1];for(var L=0;L<A;L++){var R=P[L];(N=(_+L-t)/r)+d<0||N>1||e.displayLabel(x.id,R,w,_,b,L,N,d,25,p,v,15)}b++}}catch(e){l={error:e}}finally{try{S&&!S.done&&(c=E.return)&&c.call(E)}finally{if(l)throw l.error}}if(0===b){var N;if((N=(_+0-t)/r)+d<0||N>1)continue;e.displayLabel(x.id,null,w,_,b,0,N,d,25,p,v,15)}}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=g.return)&&s.call(g)}finally{if(a)throw a.error}}var I=e._microTileCache.get(e.contig+":"+n.key,function(){var t,r,i,a,s=new Array;try{for(var l=o(n.payload),u=l.next();!u.done;u=l.next()){var c=u.value,f=(c.baseIndex-n.x)/n.span,d=c.refSequence.length,h=[1,0,0,1],p=0;try{for(var v=o(c.alts),g=v.next();!g.done;g=v.next()){var m=g.value.length,x=m-d;h=0===x?[.8,.8,.8,.7]:x<0?[1,0,0,.7]:[0,1,0,.7],s.push({xFractional:f,y:25*p,z:0,wFractional:m/n.span,h:25,color:h}),p++}}catch(e){i={error:e}}finally{try{g&&!g.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}0===p&&s.push({xFractional:f,y:0,z:0,wFractional:d/n.span,h:25,color:[1,0,0,.5]}),s.push({xFractional:f,y:-5,z:0,wFractional:d/n.span,h:2,color:h.slice(0,3).concat([1])})}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}var _=new y.default(s);return _.minWidth=1,_.blendFactor=0,_.y=15,_.z=.75,_.mask=e,_});I.layoutParentX=(n.x-t)/r,I.layoutW=n.span/r,I.opacity=f,e._onStageAnnotations.get("micro-tile:"+e.contig+":"+n.key,function(){return e.add(I),I})}else e._pendingTiles.get(n.key,function(){return e.createTileLoadingDependency(n)})})}this._pendingTiles.removeUnused(this.removeTileLoadingDependency),this._onStageAnnotations.removeUnused(function(t){return e.remove(t)}),this._sequenceLabelCache.removeUnused(this.deleteBaseLabel),this.toggleLoadingIndicator(this._pendingTiles.count>0,!0),this.displayNeedUpdate=!1},t.prototype.displayLabel=function(e,t,n,r,o,i,a,s,l,u,c,f){var d=this,h=this.contig+":"+r+","+o+","+i,p=this._sequenceLabelCache.get(h,function(){return d.createBaseLabel(t,n,function(){var t={id:e,type:m.EntityType.SNP};console.log("@! todo: variant label clicked",t)})});p.root.layoutParentX=a,p.root.layoutW=s,p.root.y=o*l+f,p.root.h=l,p.textParent.sx=p.textParent.sy=u,null!=p.text&&(p.text.color[3]=c)},t.baseTextInstances={A:new h.Text(p.OpenSansRegular,"A",1,[1,1,1,1]),C:new h.Text(p.OpenSansRegular,"C",1,[1,1,1,1]),G:new h.Text(p.OpenSansRegular,"G",1,[1,1,1,1]),T:new h.Text(p.OpenSansRegular,"T",1,[1,1,1,1]),"?":new h.Text(p.OpenSansRegular,"?",1,[1,1,1,1])},t}(v.default);t.default=x},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),i=n(6),a=n(8),s=n(18),l=n(0),u=n(3),c=n(5),f=n(15),d=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.tileStoreType=n,o.tileStoreConstructor=r,o.densityMultiplier=1,o._pixelRatio=window.devicePixelRatio||1,o._tileNodeCache=new i.default,o.createTileNode=function(){var e=o.constructTileNode();return e.mask=o,o.add(e),e},o.deleteTileNode=function(e){e.setTile(null),e.releaseGPUResources(),o.remove(e)},o}return r(t,e),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(e){this._pixelRatio=e,this.displayNeedUpdate=!0},enumerable:!0,configurable:!0}),t.prototype.setContig=function(t){this.tileStore=f.default.getTileStore(this.tileStoreType,t,this.tileStoreConstructor),e.prototype.setContig.call(this,t)},t.prototype.constructTileNode=function(){return new h},t.prototype.updateDisplay=function(){var e=this,t=this.x0,n=this.x1,r=n-t,o=this.getComputedWidth();if(this._tileNodeCache.markAllUnused(),o>0){var i=r/o,s=this.densityMultiplier*i/this.pixelRatio,l=a.default.log2(Math.max(s,1));Math.floor(l);this.tileStore.getTiles(t,n,s,!0,function(n){var o=e._tileNodeCache.get(e.contig+":"+n.key,e.createTileNode);if(e.updateTileNode(o,n,t,r,l),o.z=1,!e.tileNodeIsOpaque(o))for(var i=n.x+.5*n.span,a=1,c=1,f=1;f<30;f++){var d=s*(1<<f);if(!e.tileStore.isWithinInitializedLodRange(d))break;var h=e.tileStore.getTile(i,d,!1);if(h.lodLevel!==n.lodLevel&&(a>0&&h.state===u.TileState.Loading||h.state===u.TileState.Complete)){h.state===u.TileState.Loading&&a--;var p=e._tileNodeCache.get(e.contig+":"+h.key,e.createTileNode);if(e.updateTileNode(p,h,t,r,l),p.z=1-h.lodLevel/50-.1,h.state===u.TileState.Complete&&p.opacity<1){if(c<=0){e._tileNodeCache.markUnused(e.contig+":"+h.key);continue}c--}if(e.tileNodeIsOpaque(p))break}}})}this._tileNodeCache.removeUnused(this.deleteTileNode),this.displayNeedUpdate=!1},t.prototype.updateTileNode=function(e,t,n,r,o){e.layoutParentX=(t.x-n)/r,e.layoutW=t.span/r,e.layoutH=1,e.displayLodLevel=o,e.setTile(t)},t.prototype.tileNodeIsOpaque=function(e){return!0===e.render&&e.opacity>=1&&e.getTile().state===u.TileState.Complete},t}(c.TrackObject);t.ShaderTrack=d;var h=function(e){function t(){var t=e.call(this)||this;return t.tileCompleteListener=function(){t.tile.removeEventListener("complete",t.tileCompleteListener),t.onTileComplete()},t.opacity=1,t.render=!1,t}return r(t,e),Object.defineProperty(t.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity=e,this.transparent=e<1},enumerable:!0,configurable:!0}),t.prototype.setTile=function(e){e!==this.tile&&(null!=this.tile&&this.tile.removeEventListener("complete",this.tileCompleteListener),this.tile=e,null!=e?e.state===u.TileState.Complete?(this.opacity=1,this.onTileComplete()):(e.addEventListener("complete",this.tileCompleteListener),this.opacity=0,this.render=!1):this.render=!1)},t.prototype.getTile=function(){return this.tile},t.prototype.onTileComplete=function(){o.default.springTo(this,{opacity:1},s.DEFAULT_SPRING),this.render=!0,this.gpuResourcesNeedAllocate=!0},t}(l.default);t.TileNode=h,t.default=d},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),i=n(8),a=n(34),s=n(3),l=n(4),u=n(12),c=n(0),f=n(11),d=n(13),h=n(10),p=n(27),v=n(19),y=function(e){function t(t){var n=e.call(this,t,"sequence",function(e){return new a.SequenceTileStore(e)})||this;return n.densityMultiplier=2,n.color.set([0,0,0,1]),n}return r(t,e),t.prototype.constructTileNode=function(){return new b},t}(p.ShaderTrack);t.SequenceTrack=y;var g=new Float32Array([.216,.063,.318,1]),m=new Float32Array([.2,.2,.404,1]),x=new Float32Array([.043,.561,.608,1]),_=new Float32Array([.071,.725,.541,1]),b=function(e){function t(){var n=e.call(this)||this;return n._labelCache=new o.UsageCache,n.createLabel=function(e){var r=new v.TextClone(t.baseTextInstances[e],[1,1,1,1]);r.additiveBlendFactor=1,r.layoutX=-.5,r.layoutY=-.5;var o=new c.default;return o.add(r),n.add(o),{container:o,text:r}},n.deleteLabel=function(e){e.container.remove(e.text),e.text.releaseGPUResources(),n.remove(e.container)},n}return r(t,e),t.prototype.setTile=function(t){e.prototype.setTile.call(this,t),null!=this.tile&&(this.memoryBlockY=(t.blockRowIndex+.5)/t.block.rows.length)},t.prototype.applyTransformToSubNodes=function(t){this.computedWidth===this._lastComputedWidth&&this._lastComputedX===this.computedX||(this._lastComputedWidth=this.computedWidth,this._lastComputedX=this.computedX,this.updateLabels()),e.prototype.applyTransformToSubNodes.call(this,t)},t.prototype.allocateGPUResources=function(e){this.gpuVertexState=f.default.quad1x1VertexState,this.gpuProgram=f.default.getProgram(e,t.vertexShader,t.fragmentShader,t.attributeLayout),this.gpuTexture=this.tile.payload.getTexture(e)},t.prototype.releaseGPUResources=function(){this.gpuVertexState=null,this.gpuProgram=null,this.gpuTexture=null},t.prototype.draw=function(e){var t=this.tile.payload;e.uniform2f("size",this.computedWidth,this.computedHeight),e.uniformMatrix4fv("model",!1,this.worldTransformMat4),e.uniform1f("opacity",this.opacity),e.uniform1f("memoryBlockY",this.memoryBlockY),e.uniform3f("offsetScaleLod",t.sequenceMinMax.min,t.sequenceMinMax.max-t.sequenceMinMax.min,this.displayLodLevel),e.uniformTexture2D("memoryBlock",this.gpuTexture),e.draw(u.DrawMode.TRIANGLES,6,0),this.tile.markLastUsed()},t.prototype.updateLabels=function(){var e=this,t=this.tile;if(this._labelCache.markAllUnused(),null!=t&&0===t.lodLevel&&t.state===s.TileState.Complete){var n=t.payload.array,r=1/t.lodSpan,o=this.computedWidth*r,a=Math.min(o-3,16),l=.7*Math.min(Math.max((a-5)/11,0),1);if((l*=l)>0&&a>0)for(var u=t.payload.array.length/4,c=-this.layoutParentX/this.layoutW,f=(1-this.layoutParentX)/this.layoutW,d=i.Scalar.clamp(Math.floor(c/r),0,u-1),h=i.Scalar.clamp(Math.floor(f/r),0,u-1),p=function(t){var o,i=n[4*t+0]/255,s=n[4*t+1]/255,u=n[4*t+2]/255,c=n[4*t+3]/255;o=i>.5?"A":s>.5?"C":c>.5?"T":u>.5?"G":"N";var f=v._labelCache.get(t+"",function(){return e.createLabel(o)});f.container.layoutParentX=(t+.5)*r,f.container.layoutParentY=.5,f.container.sx=f.container.sy=a,f.text.mask=v.mask,f.text.color[3]=l},v=this,y=d;y<=h;y++)p(y)}this._labelCache.removeUnused(this.deleteLabel)},t.prototype.onTileComplete=function(){e.prototype.onTileComplete.call(this),this.updateLabels()},t.attributeLayout=[{name:"position",type:l.AttributeType.VEC2}],t.vertexShader="\n        #version 100\n\n        attribute vec2 position;\n        uniform mat4 model;\n        uniform vec2 size;\n        uniform float memoryBlockY;\n\n        varying vec2 texCoord;\n        varying vec2 vUv;\n\n        void main() {\n            texCoord = vec2(position.x, memoryBlockY);\n            vUv = position;\n            gl_Position = model * vec4(position * size, 0., 1.0);\n        }\n    ",t.fragmentShader="\n        #version 100\n\n        precision mediump float;\n        uniform float opacity;\n        uniform sampler2D memoryBlock;\n        uniform vec3 offsetScaleLod;\n\n        varying vec2 texCoord;\n        varying vec2 vUv;\n\n        float contrastCurve(float x, float s) {\n            float s2 = pow(2.0, s);\n            float px = pow(4.0, -s * x);\n            return ((s2 + 1.)/(s2*px + 1.0) - 1.) / (s2 - 1.0);\n        }\n\n        vec3 viridis( float x ) {\n            x = clamp(x, 0., 1.0);\n            vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3\n            vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7\n            return vec3(\n                dot( x1, vec4( +0.280268003, -0.143510503, +2.225793877, -14.81508888 ) ) + dot( x2.xy, vec2( +25.212752309, -11.77258958 ) ),\n                dot( x1, vec4( -0.002117546, +1.617109353, -1.909305070, +2.701152864 ) ) + dot( x2.xy, vec2(  -1.685288385, +0.178738871 ) ),\n                dot( x1, vec4( +0.300805501, +2.614650302, -12.01913909, +28.93355911 ) ) + dot( x2.xy, vec2( -33.491294770, +13.76205384 ) )\n            );\n        }\n        \n        void main() {\n            vec4 texRaw = texture2D(memoryBlock, texCoord);\n            // unpack data\n            vec4 acgt = texRaw * offsetScaleLod.y + offsetScaleLod.x;\n\n            // micro-scale color\n            const vec3 aRgb = vec4("+g.join(", ")+").rgb;\n            const vec3 tRgb = vec4("+m.join(", ")+").rgb;\n            const vec3 cRgb = vec4("+x.join(", ")+").rgb;\n            const vec3 gRgb = vec4("+_.join(", ")+").rgb;\n\n            vec3 colMicro = (\n                    acgt[0] * aRgb +\n                    acgt[1] * cRgb +\n                    acgt[2] * gRgb +\n                    acgt[3] * tRgb\n            );\n\n            // blend into to macro-scale color\n            // macro-scale simulates g-banding with a non-linear response\n            float tileLodLevel = offsetScaleLod.z;\n            float q = tileLodLevel - 5.0;\n            float expectedSpan = min(pow(0.9, q), 1.0);\n            float expectedAvg = min(pow(0.8, q) * 0.25 + 0.25, 0.5);\n            vec4 acgtScaled = (acgt - expectedAvg) / expectedSpan + 0.5;\n\n            float gc = (acgtScaled[1] + acgtScaled[2]) * 0.5;\n\n            float gcCurved = (contrastCurve(gc, 4.) + 0.3 * gc * gc);\n            vec3 colMacro = (\n                viridis(gcCurved) +\n                vec3(30.) * pow(gc, 12.0) // tend to white at highest-density\n            );\n\n            const float microScaleEndLod = 6.0;\n            float displayLodLevel = offsetScaleLod.z;\n            float microMacroMix = clamp((displayLodLevel - microScaleEndLod) / microScaleEndLod, 0., 1.0);\n\n            gl_FragColor = vec4(mix(colMicro, colMacro, microMacroMix), 1.0) * opacity;\n\n            /**\n            // for debug: makes tiling visible\n            float debugMask = step(0.45, vUv.y) * step(vUv.y, 0.55);\n            vec4 debugColor = vec4(vUv.xxx, 1.0);\n            gl_FragColor = mix(gl_FragColor, debugColor, debugMask);\n            /**/\n        }\n    ",t.baseTextInstances={A:new d.Text(h.OpenSansRegular,"A",1,[1,1,1,1]),C:new d.Text(h.OpenSansRegular,"C",1,[1,1,1,1]),G:new d.Text(h.OpenSansRegular,"G",1,[1,1,1,1]),T:new d.Text(h.OpenSansRegular,"T",1,[1,1,1,1]),N:new d.Text(h.OpenSansRegular,"N",1,[1,1,1,1])},t}(p.TileNode);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(30),o=n(28),i=n(5),a=n(26),s=n(25);function l(e){switch(e.type){case"empty":return new i.default(e);case"sequence":return new o.default(e);case"annotation":return new r.default(e);case"variant":return new a.default(e);case"interval":return new s.default(e);default:return console.error('Not able to construct a "'+e.type+'" track'),null}}t.ConstructTrack=l,t.default=l},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n(2),s=n(2),l=n(7),u=n(6),c=n(8),f=n(45),d=n(15),h=n(3),p=n(12),v=n(0),y=n(9),g=n(13),m=n(10),x=n(5),_=n(16),b=n(2),T=function(e){function t(t){var n=e.call(this,t)||this;return n.macroLodBlendRange=2,n.macroLodThresholdLow=10,n.macroLodThresholdHigh=n.macroLodThresholdLow+n.macroLodBlendRange,n.namesLodBlendRange=2,n.namesLodThresholdLow=9,n.namesLodThresholdHigh=n.namesLodThresholdLow+n.namesLodBlendRange,n.pointerState={pointerOver:!1},n._macroTileCache=new u.default,n._annotationCache=new u.default,n._onStageAnnotations=new u.default,n.addAnnotation=function(e){n.add(e)},n.removeAnnotation=function(e){n.remove(e)},n.deleteAnnotation=function(e){e.releaseGPUResources(),e.forEachSubNode(function(e){e.releaseGPUResources()})},n.annotationKey=function(e){return e.soClass+""+e.name+""+e.startIndex+""+e.length},n.color.set([.1,.1,.1,1]),n.addInteractionListener("pointerenter",function(e){n.pointerState.pointerOver=!0}),n.addInteractionListener("pointerleave",function(e){n.pointerState.pointerOver=!1}),n}return r(t,e),t.prototype.setContig=function(t){this.annotationStore=d.default.getTileStore("annotation",t,function(e){return new f.AnnotationTileStore(e)}),this.macroAnnotationStore=d.default.getTileStore("macroAnnotation",t,function(e){return new f.MacroAnnotationTileStore(e)}),e.prototype.setContig.call(this,t)},t.prototype.updateDisplay=function(){this._pendingTiles.markAllUnused(),this._onStageAnnotations.markAllUnused();var e=this.x0,t=this.x1,n=t-e,r=this.getComputedWidth();if(r>0){var o=n/r,i=c.Scalar.log2(Math.max(o,1)),a=c.Scalar.linstep(this.macroLodThresholdLow,this.macroLodThresholdHigh,i),s=1-a;s>0&&this.updateMicroAnnotations(e,t,n,o,i,s),a>0&&this.updateMacroAnnotations(e,t,n,o,a)}this._pendingTiles.removeUnused(this.removeTileLoadingDependency),this._onStageAnnotations.removeUnused(this.removeAnnotation),this.toggleLoadingIndicator(this._pendingTiles.count>0,!0),this.displayNeedUpdate=!1},t.prototype.updateMacroAnnotations=function(e,t,n,r,i){var s=this;this.macroAnnotationStore.getTiles(e,t,r,!0,function(t){if(t.state===h.TileState.Complete){var r=s._macroTileCache.get(s.contig+":"+t.key,function(){var e,n,r=new Array,i=[82/255,75/255,165/255,.4],l=[26/255,174/255,222/255,.4];try{for(var u=o(t.payload),c=u.next();!c.done;c=u.next()){var f=c.value;if(f.strand===s.model.strand){var d=f.class===a.AnnotationTileset.GeneClass.NonProteinCoding?i:l,h=20*f.transcriptCount+10*(f.transcriptCount-1)+60;r.push({xFractional:(f.startIndex-t.x)/t.span,y:0,z:0,wFractional:f.length/t.span,h:h,color:d})}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}var p=new _.default(r);return p.y=0,p.z=.75,p.mask=s,p});r.layoutParentX=(t.x-e)/n,r.layoutW=t.span/n,r.opacity=i,s._onStageAnnotations.get("macro-gene-tile:"+s.contig+":"+t.key,function(){return s.addAnnotation(r),r})}else s._pendingTiles.get(s.contig+":"+t.key,function(){return s.createTileLoadingDependency(t)})})},t.prototype.updateMicroAnnotations=function(e,t,n,r,i,a){var s=this,l=1-c.Scalar.linstep(this.namesLodThresholdLow,this.namesLodThresholdHigh,i);this.annotationStore.getTiles(e,t,r,!0,function(r){var i,u;if(r.state===h.TileState.Complete){var c=function(r){if(!(r.startIndex<=t&&r.startIndex+r.length>=e))return"continue";if(r.strand!==s.model.strand)return"continue";var o=s.contig+":"+s.annotationKey(r),i=s._annotationCache.get(o,function(){var e=new w(r,s.pointerState);return e.y=40,e.layoutH=0,e.z=.25,e.mask=s,e.forEachSubNode(function(e){return e.mask=s}),e});i.nameOpacity=l,s._onStageAnnotations.get(o,function(){return s.addAnnotation(i),i}),i.layoutParentX=(r.startIndex-e)/n,i.layoutW=r.length/n,i.opacity=a};try{for(var f=o(r.payload),d=f.next();!d.done;d=f.next()){c(d.value)}}catch(e){i={error:e}}finally{try{d&&!d.done&&(u=f.return)&&u.call(f)}finally{if(i)throw i.error}}}else s._pendingTiles.get(s.contig+":"+r.key,function(){return s.createTileLoadingDependency(r)})})},t}(x.default);t.AnnotationTrack=T;var w=function(e){function t(t,n){var r=e.call(this)||this;r.gene=t,r._opacity=1,r.onTranscriptClick=function(e){if(null!=r.gene.name){var t=new s.QueryBuilder;t.newGenomeQuery(),t.filterName(r.gene.name.toUpperCase()),t.setLimit(1);var n=t.build();b.SiriusApi.getQueryResults(n,!1).then(function(e){if(e.data.length>0){var t=e.data[0];console.log("@! todo: transcript clicked",t)}else alert("Data not found")})}else console.warn("Cannot search for a gene with no name",r.gene)},r.name=new g.default(m.OpenSansRegular,t.name,16,[1,1,1,1]),r.name.layoutY=-1,r.name.y=-5,r.add(r.name);for(var o=0;o<t.transcripts.length;o++){var i=t.transcripts[o],a=new E(i,t.strand,r.onTranscriptClick,n);a.h=20,a.y=30*o+5,a.layoutParentX=(i.startIndex-t.startIndex)/t.length,a.layoutW=i.length/t.length,r.add(a)}return r}return r(t,e),Object.defineProperty(t.prototype,"opacity",{get:function(){return this._opacity},set:function(e){var t,n;this._opacity=e;try{for(var r=o(this.children),i=r.next();!i.done;i=r.next()){i.value.opacity=e}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nameOpacity",{get:function(){return this.name.color[3]},set:function(e){this.name.color[3]=e,this.name.visible=e>=0},enumerable:!0,configurable:!0}),t}(v.default),E=function(e){function t(t,n,r,s){var u,c,f,d,h,p=e.call(this)||this;p.transcript=t,p._opacity=1;(u={})[a.AnnotationTileset.TranscriptClass.Unspecified]=[.5,.5,.5,.25],u[a.AnnotationTileset.TranscriptClass.ProteinCoding]=[1,0,1,.25],u[a.AnnotationTileset.TranscriptClass.NonProteinCoding]=[0,1,1,.25];var v=[107/255,109/255,136/255,.17],g=v[3],m=3*g,x=new y.Rect(0,0,v);x.cursorStyle="pointer",x.z=0,x.transparent=!0,x.layoutW=1,x.layoutH=1,p.add(x);x.addInteractionListener("pointermove",function(e){s.pointerOver?(x.cursorStyle="pointer",l.default.springTo(x.color,{3:m},300)):(x.cursorStyle=null,l.default.springTo(x.color,{3:g},300))}),x.addInteractionListener("pointerleave",function(){x.cursorStyle=null,l.default.springTo(x.color,{3:g},300)}),x.addInteractionListener("pointerup",function(e){s.pointerOver&&e.isPrimary&&(e.preventDefault(),e.stopPropagation(),r(t))});var _=new C(n);_.color.set([138/255,136/255,191/255,.38]),_.h=10,_.layoutW=1,_.layoutY=-.5,_.layoutParentY=.5,_.z=.1,_.transparent=!0,p.add(_);try{for(var b=o(t.exon),T=b.next();!T.done;T=b.next()){var w=T.value,E=new S;E.z=.25,E.layoutH=1,E.layoutParentX=(w.startIndex-t.startIndex)/t.length,E.layoutW=w.length/t.length,p.add(E)}}catch(e){c={error:e}}finally{try{T&&!T.done&&(f=b.return)&&f.call(b)}finally{if(c)throw c.error}}try{for(var L=o(t.utr),R=L.next();!R.done;R=L.next()){var N=R.value,I=new P;I.z=.5,I.layoutH=1,I.layoutParentX=(N.startIndex-t.startIndex)/t.length,I.layoutW=N.length/t.length,p.add(I)}}catch(e){d={error:e}}finally{try{R&&!R.done&&(h=L.return)&&h.call(L)}finally{if(d)throw d.error}}for(var O=n===i.Strand.Negative,M=0,k=0;k<t.cds.length;k++){var U=O?t.cds.length-1-k:k,D=t.cds[U],F=new A(D.length,D.phase,n,M);F.z=.75,F.layoutH=1,F.layoutParentX=(D.startIndex-t.startIndex)/t.length,F.layoutW=D.length/t.length,p.add(F),M+=D.length}return p}return r(t,e),Object.defineProperty(t.prototype,"opacity",{get:function(){return this._opacity},set:function(e){var t,n;this._opacity=e;try{for(var r=o(this.children),i=r.next();!i.done;i=r.next()){i.value.opacity=e}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},enumerable:!0,configurable:!0}),t}(v.default),S=function(e){function t(){var t=e.call(this,0,0)||this;return t.color.set([82/255,75/255,165/255,.3]),t.transparent=!0,t}return r(t,e),t.prototype.draw=function(t){e.prototype.draw.call(this,t)},t.prototype.getFragmentCode=function(){return"\n            #version 100\n\n            precision highp float;\n\n            uniform vec2 size;\n\n            uniform vec4 color;\n\n            varying vec2 vUv;\n\n            void main() {\n                vec2 domPx = vUv * size;\n\n                const vec2 borderWidthPx = vec2(1.);\n                const float borderStrength = 0.3;\n\n                vec2 inner = step(borderWidthPx, domPx) * step(domPx, size - borderWidthPx);\n                float border = inner.x * inner.y;\n\n                vec4 c = color;\n                c.rgb += (1.0 - border) * vec3(borderStrength);\n\n                gl_FragColor = vec4(c.rgb, 1.0) * c.a;\n            }\n        "},t}(y.Rect),P=function(e){function t(){var t=e.call(this,0,0)||this;return t.color.set([138/255,136/255,191/255,.38]),t.transparent=!0,t}return r(t,e),t.prototype.draw=function(t){t.uniform1f("pixelRatio",this.worldTransformMat4[0]*t.viewport.w*.5),e.prototype.draw.call(this,t)},t.prototype.getFragmentCode=function(){return"\n            #version 100\n\n            precision highp float;\n\n            uniform vec2 size;\n            uniform vec4 color;\n            uniform float pixelRatio;\n\n            varying vec2 vUv;\n\n            void main() {\n                vec2 domPx = vUv * size;\n\n                const vec2 borderWidthPx = vec2(1.);\n\n                vec2 inner = step(borderWidthPx, domPx) * step(domPx, size - borderWidthPx);\n                float border = inner.x * inner.y;\n\n                // crosshatch\n                const float angle = -0.520;\n                const float widthPx = 2.;\n                const float wavelengthPx = 7.584;\n                const float lineStrength = 0.25;\n\n                vec2 centerPx = domPx - size * 0.5;\n\n                float lPx = centerPx.x * cos(angle) - centerPx.y * sin(angle);\n                // not antialiased but looks good enough with current color scheme\n                float lines = step(widthPx, mod(lPx, wavelengthPx)) * lineStrength + (1. - lineStrength);\n\n                vec4 c = color;\n                c.rgb += (1.0 - border * lines) * vec3(0.3);\n\n                gl_FragColor = vec4(c.rgb, 1.0) * c.a;\n            }\n        "},t}(y.Rect),A=function(e){function t(t,n,r,o){var a=e.call(this,0,0)||this;return a.length_bases=t,a.phase=n,(n>0?1:0)!==Math.floor(o/3)%2&&(a.phase+=3),a.reverse=r===i.Strand.Negative?1:0,a.color.set([26/255,174/255,222/255,.58]),a.transparent=!0,a.blendMode=p.BlendMode.PREMULTIPLIED_ALPHA,a}return r(t,e),t.prototype.draw=function(t){t.uniform1f("baseWidthPx",this.computedWidth/this.length_bases),t.uniform1f("phase",this.phase||0),t.uniform1f("reverse",this.reverse),t.uniform1f("pixelRatio",this.worldTransformMat4[0]*t.viewport.w*.5),e.prototype.draw.call(this,t)},t.prototype.getFragmentCode=function(){return"\n            #version 100\n\n            precision highp float;\n\n            uniform vec2 size;\n\n            uniform float pixelRatio;\n            uniform float baseWidthPx;\n            uniform float phase;\n            uniform float reverse;\n\n            uniform vec4 color;\n\n            varying vec2 vUv;\n\n            float squareWaveIntegral(in float x, in float wavelength) {\n                float k = x / wavelength;\n                float u = fract(k);\n                float wave = step(0.5, u) * 2.0 - 1.0;\n                return (fract(k * wave) - 1.) * wavelength;\n            }\n\n            float squareWaveAntialiased(in float xPixels, in float wavelengthPixels) {\n                // antialiasing: we find the average over the pixel by sampling signal integral either side and dividing by sampling interval (1 in this case)\n                float waveAvg = squareWaveIntegral(xPixels + 0.5, wavelengthPixels) - squareWaveIntegral(xPixels - 0.5, wavelengthPixels);\n\n                // lerp to midpoint (0) for small wavelengths (~ 1 pixel) to avoid moire patterns\n                waveAvg = mix(waveAvg, 0., clamp(2. - wavelengthPixels, 0., 1.0));\n                return waveAvg;\n            }\n\n            void main() {\n                vec2 domPx = vUv * size;\n\n                const vec2 borderWidthPx = vec2(1.);\n                vec2 inner = step(borderWidthPx, domPx) * step(domPx, size - borderWidthPx);\n                float border = inner.x * inner.y;\n\n                // two-tones for codons\n                vec4 codonAColor = color;\n                vec4 codonBColor = color + vec4(0.05);\n                // a codon is 3 bases wide\n                float codonWidthPx = baseWidthPx * 3.0;\n\n                // use square wave to create codon tones\n                // we use true pixel coordinates to make antialiasing easier\n                float xPixels = (mix(domPx.x, size.x - domPx.x, reverse) - baseWidthPx * phase) * pixelRatio;\n                float wavelengthPixels = codonWidthPx * pixelRatio * 2.0;\n\n                float codon = squareWaveAntialiased(xPixels, wavelengthPixels) * 0.5 + 0.5; // scale wave to 0 - 1\n\n                vec4 c =\n                    mix(codonAColor, codonBColor, codon); // switch between codon colors\n\n                c.rgb += (1.0 - border) * vec3(0.3); // additive blend border\n\n                gl_FragColor = vec4(c.rgb, 1.0) * c.a;\n            }\n        "},t}(y.Rect),C=function(e){function t(t){var n=e.call(this,0,0)||this;return n.direction=t,n.color.set([0,1,0,1]),n}return r(t,e),t.prototype.draw=function(t){t.uniform2f("pixelSize",1/t.viewport.w,1/t.viewport.h),t.uniform1f("reverse",this.direction===i.Strand.Negative?1:0),e.prototype.draw.call(this,t)},t.prototype.getFragmentCode=function(){return"\n            #version 100\n\n            precision highp float;\n\n            uniform vec2 pixelSize;\n            uniform vec2 size;\n            uniform float reverse;\n\n            uniform vec4 color;\n\n            varying vec2 vUv;\n\n            float distanceToSegment(vec2 a, vec2 b, vec2 p) {\n                p -= a; b -= a;                        // go to A referential\n                float q = dot(p, b) / dot(b, b) ;      // projection of P on line AB: normalized ordinate\n                b *= clamp(q, 0., 1.);                 // point on segment AB closest to P\n                return length( p - b);                 // distance to P\n            }\n\n            float lineSegment(vec2 x, vec2 a, vec2 b, float r, vec2 pixelSize) {\n                float f = distanceToSegment(a, b, x);\n                float e = pixelSize.x * 0.5;\n                return smoothstep(r - e, r + e, f);\n            }\n\n            void main() {\n                vec2 x = vec2(vUv.x, vUv.y - 0.5);\n\n                x.x = mix(x.x, 1.0 - x.x, reverse);\n\n                float n = 2.0;\n                x *= n; x.x = fract(x.x);\n\n                vec2 p = x * size;\n\n                float m = 1.0 - (\n                    // arrow\n                    lineSegment(\n                        p + vec2(-size.x * 0.5, 0.0),\n                        vec2(-10.0, -10.0) * 0.75,\n                        vec2(  0.0,   0.0),\n                        1.0,\n                        pixelSize\n                    ) *\n                    lineSegment(\n                        p + vec2(-size.x * 0.5, 0.0),\n                        vec2(-10.0, 10.0) * 0.75,\n                        vec2(  0.0,  0.0),\n                        1.0,\n                        pixelSize\n                    ) *\n\n                    // middle line\n                    lineSegment(x, vec2(0), vec2(1.0, 0.), 0.1, pixelSize)\n                );\n\n                vec3 rgb = color.rgb * m;\n                float a = m * color.a;\n\n                gl_FragColor = vec4(rgb, 1.0) * a; return;\n\n\n                /*\n\n                float h = 0.1;\n                float l = lineSegment(\n                    uv,\n                    vec2(0.5 - w * 0.5,  0.5),\n                    vec2(0.5 + w * 0.5,  0.5),\n                    h,\n                    pixelSize\n                );\n\n                gl_FragColor = vec4(0., 0., l, 1.); return;\n\n                float r = size.x / size.y;\n\n                vec2 x = vec2(vUv.x, vUv.y - 0.5);\n                x.x *= r;\n                x *= 1.0; x.x = fract(x.x);\n\n                vec2 lx = vec2(x.x - 0.5, x.y);\n                float lines = 1.0 - (\n                    lineSegment(lx, vec2(-0.25,  0.25), vec2(0), 0.05, pixelSize) *\n                    lineSegment(lx, vec2(-0.25, -0.25), vec2(0), 0.05, pixelSize)\n                );\n\n                // gl_FragColor = vec4(lx, 0., 1.); return;\n\n                gl_FragColor = vec4(vec3(lines), 1.);\n                */\n            }\n        "},t}(y.Rect);t.default=T},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.sourceEvent=t,this.defaultPrevented=!1,this.propagationStopped=!1,this.target=e.target,this.worldX=e.worldX,this.worldY=e.worldY,this.canvasX=e.canvasX,this.canvasY=e.canvasY,this.localX=e.localX,this.localY=e.localY,this.fractionX=e.fractionX,this.fractionY=e.fractionY,this.buttonChange=e.buttonChange,this.buttonState=e.buttonState,this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId,this.isPrimary=e.isPrimary,this.pointerType=e.pointerType,this.pressure=e.pressure,this.width=e.width,this.height=e.height,this.tiltX=e.tiltX,this.tiltY=e.tiltY}return e.prototype.preventDefault=function(){this.defaultPrevented=!0,this.sourceEvent.preventDefault()},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e}();t.InteractionEvent=o,function(e){e[e.Pixel=1]="Pixel",e[e.Line=2]="Line",e[e.Page=3]="Page"}(t.WheelDeltaMode||(t.WheelDeltaMode={}));var i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.wheelDeltaMode=t.wheelDeltaMode,r.wheelDeltaX=t.wheelDeltaX,r.wheelDeltaY=t.wheelDeltaY,r.wheelDeltaZ=t.wheelDeltaZ,r}return r(t,e),t}(o);t.WheelInteractionEvent=i,t.default=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(14),s=n(4),l=n(54),u=n(12),c=n(20),f=n(11),d=n(0),h=n(17),p=n(31),v=function(e){function t(t){var n=e.call(this,t)||this;return n._reactObjects=new Array,n.pointerEventSupport="PointerEvent"in window,n.dragData={},n.cursorTarget=window.document.documentElement,n.activePointers={},n._cursorStyle="",n.onPointerEnter=function(e){var t=n.interactionDataFromEvent(e);n.activePointers[t.pointerId]={interactionData:t,sourceEvent:e,lastHitNodes:new Set},n.handlePointerChanges()},n.onPointerLeave=function(e){var t=n.interactionDataFromEvent(e);delete n.activePointers[t.pointerId],n.handlePointerChanges()},n.onPointerMove=function(e){n.resetCursor();var t=n.interactionDataFromEvent(e);t.buttonChange=-1,e.target===n.canvas?void 0===n.activePointers[t.pointerId]?n.activePointers[t.pointerId]={interactionData:t,sourceEvent:e,lastHitNodes:new Set}:n.activePointers[t.pointerId].interactionData=t:delete n.activePointers[t.pointerId];var r=n.dragData[t.pointerId],o=!1;if(void 0!==r&&(o=o||n.executePointerInteraction(r.inactiveNodes,"dragstart",t,function(t){return r.activeNodes.push(t.target),new p.default(t,e)}),r.inactiveNodes=[],o=o||n.executePointerInteraction(r.activeNodes,"dragmove",t,function(t){return new p.default(t,e)})),e.target===n.canvas&&!o){var i=n.hitTestNodesForInteraction(["pointermove"],t.worldX,t.worldY);n.executePointerInteraction(i,"pointermove",t,function(t){return new p.default(t,e)})}n.applyCursor(),n.handlePointerChanges()},n.onPointerDown=function(e){if(n.resetCursor(),e.target===n.canvas){var t=n.interactionDataFromEvent(e),r=n.dragData[t.pointerId]={activeNodes:new Array,inactiveNodes:new Array,button:e.button},o=n.hitTestNodesForInteraction(["pointerdown","dragstart","dragmove","dragend"],t.worldX,t.worldY).slice();n.executePointerInteraction(o,"pointerdown",t,function(t){return-1===r.inactiveNodes.indexOf(t.target)&&r.inactiveNodes.push(t.target),new p.default(t,e)})}n.applyCursor()},n.onPointerUp=function(e){n.resetCursor();var t=n.interactionDataFromEvent(e),r=n.dragData[t.pointerId],o=!1;if(void 0!==r&&r.button===e.button&&(delete n.dragData[t.pointerId],o=n.executePointerInteraction(r.activeNodes,"dragend",t,function(t){return new p.default(t,e)},!1)),e.target===n.canvas&&!o){var i=n.hitTestNodesForInteraction(["pointerup"],t.worldX,t.worldY);n.executePointerInteraction(i,"pointerup",t,function(t){return new p.default(t,e)})}n.applyCursor()},n.onClick=function(e){if(e.target===n.canvas){var t=n.interactionDataFromEvent(e),r=n.hitTestNodesForInteraction(["click"],t.worldX,t.worldY);n.executePointerInteraction(r,"click",t,function(t){return new p.default(t,e)})}},n.onDoubleClick=function(e){if(e.target===n.canvas){var t=n.interactionDataFromEvent(e),r=n.hitTestNodesForInteraction(["dblclick"],t.worldX,t.worldY);n.executePointerInteraction(r,"dblclick",t,function(t){return new p.default(t,e)})}},n.onWheel=function(e){if(e.target===n.canvas){var t=n.interactionDataFromEvent(e),r=n.hitTestNodesForInteraction(["wheel"],t.worldX,t.worldY);n.executePointerInteraction(r,"wheel",t,function(t){return new p.WheelInteractionEvent(o({},t,{wheelDeltaMode:e.deltaMode,wheelDeltaX:e.deltaX,wheelDeltaY:e.deltaY,wheelDeltaZ:e.deltaZ}),e)})}},n._hitNodes=new Array,n.state={reactObjects:[]},n.updateSceneContent(),n}return r(t,e),t.prototype.componentDidMount=function(){null!=this.device&&console.error("Component mounted twice");var e=this.canvas.getContext("webgl",{antialias:!0,stencil:!0,alpha:!1});if(null==e)throw"WebGL not supported";e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.disable(e.CULL_FACE),this.device=new s.default(e),this.renderer=new u.default(this.device),f.default.initialize(this.device),this.addInputListeners(),console.log('AppCanvas created with device %c"'+this.device.name+'"',"font-weight: bold");var t=this.device.capabilities.vertexArrayObjects,n=this.device.capabilities.instancing;if(console.log("\tVertex Array Objects: %c"+(t?"enabled":"disabled"),"font-weight: bold; color: "+(t?"green":"red")),console.log("\tInstancing: %c"+(n?"enabled":"disabled"),"font-weight: bold; color: "+(n?"green":"red")),!this.device.capabilities.instancing)throw"WebGL extension ANGLE_instanced_arrays is required but not available on this device"},t.prototype.componentWillUnmount=function(){this.scene.forEachSubNode(function(e){e instanceof c.default&&e.releaseGPUResources()}),f.default.release(),this.device=null,this.renderer=null,this.removeInputListeners(),this.props.onWillUnmount&&this.props.onWillUnmount()},t.prototype.componentDidUpdate=function(e,t,n){e.content!=this.props.content&&this.updateSceneContent(),this.props.width===e.width&&this.props.height===e.height||(this.updateSceneTransform(),this.scene.applyTransformToSubNodes(),this.renderer.render(this.mainRenderPass))},t.prototype.render=function(){var e=this,t=this.props.pixelRatio||window.devicePixelRatio||1,n=this.props.width*t+"px",r=this.props.height*t+"px",i=o({position:"relative",overflow:"hidden",width:n,height:r},this.props.style||{});return a.createElement("div",{className:"app-canvas",style:i},a.createElement("canvas",{ref:function(t){return e.canvas=t},width:n,height:r,style:o({display:"block",position:"absolute",top:0,left:0,width:this.props.width+"px",height:this.props.height+"px",zIndex:0},this.props.canvasStyle||{})}),this.state.reactObjects.map(function(t){return a.createElement(h.ReactObjectContainer,{key:t.reactUid,reactObject:t,scene:e.scene})}))},t.prototype.renderCanvas=function(){this.renderer.render(this.mainRenderPass),this.updateReactObjects()},t.prototype.handleUserInteraction=function(){this.handlePointerChanges()},t.prototype.updateSceneContent=function(){this.scene=new d.Object2D,null!=this.props.content&&this.scene.add(this.props.content),this.mainRenderPass=new l.default(null,this.scene,{clearColor:[1,1,1,1],clearDepth:1,clearStencil:0}),this.updateSceneTransform(),this.scene.applyTransformToSubNodes()},t.prototype.updateSceneTransform=function(){var e=this.props.width,t=this.props.height;this.scene.x=-1,this.scene.y=1,this.scene.z=0,this.scene.sx=2/e,this.scene.sy=-2/t,this.scene.sz=-2e-4,this.scene.w=e,this.scene.h=t},t.prototype.worldToCanvasSpaceBounds=function(e){return{l:(e.l-this.scene.x)/this.scene.sx,r:(e.r-this.scene.x)/this.scene.sx,t:(e.t-this.scene.y)/this.scene.sy,b:(e.b-this.scene.y)/this.scene.sy}},t.prototype.canvasToWorldSpacePosition=function(e){return{x:e.x/this.props.width*2-1,y:-(e.y/this.props.height*2-1)}},t.prototype.updateReactObjects=function(){var e=this,t=0,n=!1;this.scene.forEachSubNode(function(r){if(r instanceof h.ReactObject){var o=e._reactObjects[t];n||(n=o!==r),e._reactObjects[t]=r,t++}}),n=n||t!==this._reactObjects.length,t<this._reactObjects.length&&(this._reactObjects.length=t),n&&this.setState({reactObjects:this._reactObjects})},t.prototype.mouseEventToCanvasSpacePosition=function(e){var t=this.canvas.getBoundingClientRect(),n=window.scrollX+this.canvas.clientLeft,r=window.scrollY+t.top;return{x:e.pageX-n,y:e.pageY-r}},t.prototype.addInputListeners=function(){this.pointerEventSupport?(this.canvas.addEventListener("pointerdown",this.onPointerDown),window.addEventListener("pointerup",this.onPointerUp),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerenter",this.onPointerEnter),window.addEventListener("pointerleave",this.onPointerLeave)):(this.canvas.addEventListener("mousedown",this.onPointerDown),window.addEventListener("mouseup",this.onPointerUp),window.addEventListener("mousemove",this.onPointerMove),window.addEventListener("mouseenter",this.onPointerEnter),window.addEventListener("mouseleave",this.onPointerLeave)),this.canvas.addEventListener("click",this.onClick),this.canvas.addEventListener("dblclick",this.onDoubleClick),this.canvas.addEventListener("wheel",this.onWheel,{passive:!1})},t.prototype.removeInputListeners=function(){this.pointerEventSupport?(this.canvas.removeEventListener("pointerdown",this.onPointerDown),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave)):(this.canvas.removeEventListener("mousedown",this.onPointerDown),window.removeEventListener("mouseup",this.onPointerUp),window.removeEventListener("mousemove",this.onPointerMove),window.removeEventListener("mouseenter",this.onPointerEnter),window.removeEventListener("mouseleave",this.onPointerLeave)),this.canvas.removeEventListener("click",this.onClick),this.canvas.removeEventListener("dblclick",this.onDoubleClick),this.canvas.removeEventListener("wheel",this.onWheel,{passive:!1})},t.prototype.resetCursor=function(){this._cursorStyle=null},t.prototype.applyCursor=function(){var e=null===this._cursorStyle?"":this._cursorStyle;this.cursorTarget.style.cursor!==e&&this.cursorTarget.style.setProperty("cursor",e,"important")},t.prototype.handlePointerChanges=function(){var e=function(e){var n=t._lastActivePointers[e];void 0===t.activePointers[e]&&t.executePointerInteraction(n.lastHitNodes,"pointerleave",n.interactionData,function(e){return new p.default(e,n.sourceEvent)})},t=this;for(var n in this._lastActivePointers)e(n);this._lastActivePointers={};var r=function(e){var t,n,r,a,s=o.activePointers[e],l=s.interactionData,u=s.lastHitNodes,c=s.sourceEvent,f=o.hitTestNodesForInteraction(["pointerenter","pointerleave"],l.worldX,l.worldY);if(o._lastActivePointers[e]=s,0===f.length&&0===u.size)return"continue";var d=new Set,h=new Set;try{for(var v=i(f),y=v.next();!y.done;y=v.next()){var g=y.value;u.has(g)||(d.add(g),u.add(g))}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=v.return)&&n.call(v)}finally{if(t)throw t.error}}try{for(var m=i(u),x=m.next();!x.done;x=m.next()){g=x.value;-1===f.indexOf(g)&&(h.add(g),u.delete(g))}}catch(e){r={error:e}}finally{try{x&&!x.done&&(a=m.return)&&a.call(m)}finally{if(r)throw r.error}}if(0===d.size+h.size)return"continue";o.executePointerInteraction(d,"pointerenter",l,function(e){return new p.default(e,c)}),o.executePointerInteraction(h,"pointerleave",l,function(e){return new p.default(e,c)})},o=this;for(var n in this.activePointers)r(n)},t.prototype.hitTestNodesForInteraction=function(e,t,n){var r=0,o=this._hitNodes;return this.scene.forEachSubNode(function(a){var s,l;if(a instanceof d.Object2D){var u=a,c=0;try{for(var f=i(e),h=f.next();!h.done;h=f.next()){var p=h.value;c+=u.interactionEventListenerCount[p]}}catch(e){s={error:e}}finally{try{h&&!h.done&&(l=f.return)&&l.call(f)}finally{if(s)throw s.error}}if(null==a.cursorStyle&&c<=0)return;var v=a.getWorldBounds();t>=v.l&&t<=v.r&&n>=v.b&&n<=v.t&&(o[r++]=a)}}),r<o.length&&(o.length=r),o.sort(this.compareZ),o},t.prototype.executePointerInteraction=function(e,t,n,r,o){var a,s;void 0===o&&(o=!0);var l=!1;try{for(var u=i(e),c=u.next();!c.done;c=u.next()){var f=c.value,d=f,h=f.getWorldBounds(),p=(n.worldX-h.l)/(h.r-h.l),v=(n.worldY-h.t)/(h.b-h.t);n.target=f,n.localX=p*d.computedWidth,n.localY=v*d.computedHeight,n.fractionX=p,n.fractionY=v;var y=r(n),g=y;if(d.eventEmitter.emit(t,y),o&&null==this._cursorStyle&&null!=f.cursorStyle&&(this._cursorStyle=f.cursorStyle),l=g.defaultPrevented||l,g.propagationStopped)break}}catch(e){a={error:e}}finally{try{c&&!c.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}return l},t.prototype.interactionDataFromEvent=function(e){var t=this.mouseEventToCanvasSpacePosition(e),n=this.canvasToWorldSpacePosition(t),r={buttonChange:e.button,buttonState:e.buttons,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,canvasX:t.x,canvasY:t.y,worldX:n.x,worldY:n.y,pointerId:-1,pointerType:"mouse",isPrimary:!0,width:1,height:1,pressure:0,tiltX:0,tiltY:0,target:null,localX:0,localY:0,fractionX:0,fractionY:0};return this.pointerEventSupport&&e instanceof PointerEvent&&(r.pointerId=e.pointerId,r.pointerType=e.pointerType,r.isPrimary=e.isPrimary,r.width=e.width,r.height=e.height,r.pressure=e.pressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY),r},t.prototype.compareZ=function(e,t){return e.getWorldZ()-t.getWorldZ()},t}(a.Component);t.AppCanvas=v,t.default=v},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=function(e){function t(t,n){var r=e.call(this,32768,1)||this;return r.model=t,r.contig=n,o.SiriusApi.getContigInfo(n).then(function(e){r.maximumX=e.length-1}),r}return r(t,e),t.prototype.mapLodLevel=function(e){return null==this.model.query?0:10*Math.floor(e/10)},t.prototype.getTilePayload=function(e){var t=e.x+1,n=t+e.span,r=this.model.query;return(r?o.SiriusApi.getVariantTrackData(this.contig,t,n,r):o.SiriusApi.getAllVariantTrackData(this.contig,t,n)).then(function(e){return e.data.map(function(e){return{id:e.id,baseIndex:e.start-1,refSequence:e.info.variant_ref?e.info.variant_ref:"",alts:e.info.variant_alt?e.info.variant_alt.split(","):[]}})})},t}(n(3).TileStore);t.VariantTileStore=i,t.default=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n(4),s=function(e){function t(t){var n=e.call(this,1024,8)||this;return n.sourceId=t,i.SiriusApi.getContigInfo(t).then(function(e){n.maximumX=e.length-1;n.getTiles(0,n.maximumX,e.length/512,!0,function(){})}).catch(function(){console.warn("Could not determine sequence length")}),n}return r(t,e),t.prototype.mapLodLevel=function(e){return 2*Math.floor(e/2)},t.prototype.getTilePayload=function(e){var t=this;return i.SiriusApi.loadACGTSubSequence(this.sourceId,e.lodLevel,e.lodX,e.lodSpan).then(function(n){return o({},n,{dataUploaded:!1,getTexture:function(n){var r=t.getBlockPayload(e).getTexture(n);if(!this.dataUploaded){var o=this.array.length/4;r.updateTextureData(0,a.TextureFormat.RGBA,this.array,0,e.blockRowIndex,Math.min(r.w,o),1),this.dataUploaded=!0}return r}})})},t.prototype.createBlockPayload=function(e,t,n,r){return{_gpuTexture:null,getTexture:function(t){return null===this._gpuTexture&&(this._gpuTexture=t.createTexture({format:a.TextureFormat.RGBA,generateMipmaps:!1,mipmapData:null,width:n,height:r,dataType:a.TextureDataType.UNSIGNED_BYTE,samplingParameters:{magFilter:e>0?a.TextureMagFilter.LINEAR:a.TextureMagFilter.NEAREST,minFilter:a.TextureMinFilter.LINEAR,wrapS:a.TextureWrapMode.CLAMP_TO_EDGE,wrapT:a.TextureWrapMode.CLAMP_TO_EDGE},pixelStorage:{packAlignment:1,unpackAlignment:1,flipY:!1,premultiplyAlpha:!1,colorSpaceConversion:a.ColorSpaceConversion.NONE}})),this._gpuTexture}}},t.prototype.releaseBlockPayload=function(e){null!=e._gpuTexture&&(e._gpuTexture.delete(),e._gpuTexture=null)},t}(n(3).default);t.SequenceTileStore=s,t.default=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(2),a=function(e){function t(t,n,r){void 0===r&&(r=32768);var o=e.call(this,r,1)||this;return o.contig=t,o.query=n,o.tileSize=r,o.microLodThreshold=3,o.macroLodLevel=10,i.SiriusApi.getContigInfo(t).then(function(e){o.maximumX=e.length-1}),o}return r(t,e),t.prototype.mapLodLevel=function(e){return e<=this.microLodThreshold?0:this.macroLodLevel},t.prototype.getTilePayload=function(e){var t=e.x+1,n=t+e.span;return i.SiriusApi.getIntervalTrackData(this.contig,t,n,this.query).then(function(e){for(var t=new Float32Array(2*e.data.length),n=0;n<e.data.length;n++){var r=e.data[n];t[2*n+0]=r.start-1,t[2*n+1]=r.length}return t})},t}(o.TileStore);t.default=a},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,a,s,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(i(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),a=(u=n.slice()).length,l=0;l<a;l++)u[l].apply(this,s);return!0},n.prototype.addListener=function(e,t){var a;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(a=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(e,o),n||(n=!0,t.apply(this,arguments))}return o.listener=t,this.on(e,o),this},n.prototype.removeListener=function(e,t){var n,i,a,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(n=this._events[e]).length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Unknown=1]="Unknown",e[e.Positive=2]="Positive",e[e.Negative=3]="Negative"}(r=t.Strand||(t.Strand={})),t.default=r},function(e,t,n){"use strict";var r,o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.GENOME="GenomeNode",e.INFO="InfoNode",e.EDGE="EdgeNode"}(r||(r={})),t.QueryType=r;var i=function(){function e(e){void 0===e&&(e={}),this.query=JSON.parse(JSON.stringify(e))}return e.prototype.newGenomeQuery=function(){this.query={type:r.GENOME,filters:{},toEdges:[],arithmetics:[]}},e.prototype.newInfoQuery=function(){this.query={type:r.INFO,filters:{},toEdges:[]}},e.prototype.newEdgeQuery=function(){this.query={type:r.EDGE,filters:{},toNode:{}}},e.prototype.filterID=function(e){this.query.filters._id=e},e.prototype.filterType=function(e){this.query.filters.type=e},e.prototype.filterSource=function(e){this.query.filters.source=e},e.prototype.filterContig=function(e){if(this.query.type!==r.GENOME)throw new Error("filter contig only available for GenomeNodes");this.query.filters.contig=e},e.prototype.filterLength=function(e){if(this.query.type!==r.GENOME)throw new Error("Length only available for GenomeNodes");this.query.filters.length=e},e.prototype.filterName=function(e){this.query.filters.name=e},e.prototype.filterMaxPValue=function(e){this.query.filters["info.p-value"]={"<":e}},e.prototype.filterBiosample=function(e){this.query.filters["info.biosample"]=e},e.prototype.filterTargets=function(e){e.length>0&&(this.query.filters["info.targets"]={$all:e})},e.prototype.filterInfotypes=function(e){this.query.filters["info.types"]=e},e.prototype.filterAssay=function(e){this.query.filters["info.assay"]=e},e.prototype.filterOutType=function(e){this.query.filters["info.outtype"]=e},e.prototype.filterStartBp=function(e){if(this.query.type!==r.GENOME)throw new Error("filterStartBp is only available for an Genome Query.");this.query.filters.start=e},e.prototype.filterEndBp=function(e){if(this.query.type!==r.GENOME)throw new Error("filterEndBp is only available for an Genome Query.");this.query.filters.end=e},e.prototype.filterAffectedGene=function(e){this.query.filters.variant_affected_genes;this.query.filters["info.variant_affected_genes"]=e},e.prototype.filterVariantTag=function(e){this.query.filters.variant_tags;this.query.filters["info.variant_tags"]=e},e.prototype.searchText=function(e){this.query.filters.$text=e},e.prototype.setLimit=function(e){this.query.limit=e},e.prototype.addToEdge=function(e){if(this.query.type===r.EDGE)throw new Error("Edge can not be connect to another edge.");this.query.toEdges.push(e)},e.prototype.setToNode=function(e,t){if(void 0===t&&(t=!1),this.query.type!==r.EDGE)throw new Error("toNode is only available for an Edge Query.");this.query.toNode=e,this.query.reverse=t},e.prototype.addArithmeticIntersect=function(e){if(this.query.type!==r.GENOME)throw new Error("Arithmetic is only available for an Genome Query.");var t={operator:"intersect",target_queries:[e]};this.query.arithmetics.push(t)},e.prototype.addArithmeticWindow=function(e,t){if(void 0===t&&(t=1e3),this.query.type!==r.GENOME)throw new Error("Arithmetic is only available for an Genome Query.");var n={operator:"window",target_queries:[e],windowSize:t};this.query.arithmetics.push(n)},e.prototype.addArithmeticUnion=function(e){if(this.query.type!==r.GENOME)throw new Error("Arithmetic is only available for an Genome Query.");var t={operator:"union",target_queries:[e]};this.query.arithmetics.push(t)},e.prototype.setSpecialGWASQuery=function(){var e,t;if(this.query.type!==r.GENOME)throw new Error("setSpecialGWASQuery should be applied to a Genome Query.");if(!this.query.toEdges||this.query.toEdges<1)throw new Error("GWAS query should have at least 1 edge.");try{for(var n=o(this.query.toEdges),i=n.next();!i.done;i=n.next()){var a=i.value;if(!a.toNode||a.toNode.type!==r.INFO)throw new Error("The edge of GWAS query should connect to InfoNode.")}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.query.specialGWASQuery=!0},e.prototype.setUserFileID=function(e){this.query.userFileID=e},e.prototype.build=function(){return JSON.parse(JSON.stringify(this.query))},e}();t.QueryBuilder=i},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var r=n(80);e.exports=function(e,t,n,o,i){var a=new Error(e);return r(a,t,n,o,i)}},function(e,t,n){"use strict";var r=n(1),o=n(81),i=n(79),a=n(78),s=n(77),l=n(41),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(76);e.exports=function(e){return new Promise(function(t,c){var f=e.data,d=e.headers;r.isFormData(f)&&delete d["Content-Type"];var h=new XMLHttpRequest,p="onreadystatechange",v=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in h||s(e.url)||(h=new window.XDomainRequest,p="onload",v=!0,h.onprogress=function(){},h.ontimeout=function(){}),e.auth){var y=e.auth.username||"",g=e.auth.password||"";d.Authorization="Basic "+u(y+":"+g)}if(h.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h[p]=function(){if(h&&(4===h.readyState||v)&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in h?a(h.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:1223===h.status?204:h.status,statusText:1223===h.status?"No Content":h.statusText,headers:n,config:e,request:h};o(t,c,r),h=null}},h.onerror=function(){c(l("Network Error",e,null,h)),h=null},h.ontimeout=function(){c(l("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var m=n(75),x=(e.withCredentials||s(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;x&&(d[e.xsrfHeaderName]=x)}if("setRequestHeader"in h&&r.forEach(d,function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete d[t]:h.setRequestHeader(t,e)}),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){h&&(h.abort(),c(e),h=null)}),void 0===f&&(f=null),h.send(f)})}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){e.exports=n(86)},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n(3),s=n(2),l=s.AnnotationTileset.TranscriptComponentClass,u=s.AnnotationTileset.GenomeFeatureType,c=function(e){function t(t,n,r){void 0===n&&(n=1<<20),void 0===r&&(r=!1);var o=e.call(this,n,1)||this;return o.contig=t,o.macro=r,i.SiriusApi.getContigInfo(t).then(function(e){o.maximumX=e.length-1}),o}return r(t,e),t.prototype.mapLodLevel=function(e){return 0},t.prototype.getTilePayload=function(e){return i.SiriusApi.loadAnnotations(this.contig,this.macro,e.x,e.span).then(function(e){for(var t,n,r=new Array,i=-1,a=0;a<e.length;a++){var s=e[a];if(s.type-i>1&&console.warn("Invalid gene feature nesting: "+u[i]+" -> "+u[s.type]),i=s.type,s.type===u.Gene)t=o({},s,{transcripts:[]}),r.push(t);if(s.type===u.Transcript){var c=s;if(null==t){console.warn("Out of order Transcript  no parent gene found");continue}n=o({},c,{exon:[],cds:[],utr:[],other:[]}),t.transcripts.push(n)}if(s.type===u.TranscriptComponent){var f=s;if(null==n){console.warn("Out of order TranscriptComponent  no parent transcript found");continue}switch(f.class){case l.Exon:n.exon.push(f);break;case l.ProteinCodingSequence:var d=n.cds[n.cds.length-1];null!=d&&d.startIndex>=f.startIndex&&console.warn("Out of order CDS  Protein coding components must be sorted by startIndex"),n.cds.push(f);break;case l.Untranslated:n.utr.push(f);break;default:n.other.push(f)}}}return r})},t}(a.TileStore);t.AnnotationTileStore=c;var f=function(e){function t(t){return e.call(this,t,1<<25,!0)||this}return r(t,e),t}(c);t.MacroAnnotationTileStore=f,t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),o=n(7),i=n(32),a=n(22),s=function(){function e(e){var t=this;this._frameLoopHandle=0,this.frameLoop=function(){t._frameLoopHandle=window.requestAnimationFrame(t.frameLoop),t.appCanvasRef.handleUserInteraction(),o.default.frame(),t.appCanvasRef.renderCanvas()},this.trackViewer=new a.default,null!=e&&this.setConfiguration(e)}return e.prototype.setConfiguration=function(e){this.trackViewer.setConfiguration(e)},e.prototype.getConfiguration=function(){return this.trackViewer.getConfiguration()},e.prototype.addTrack=function(e,t,n){return void 0===t&&(t=50),void 0===n&&(n=!0),this.trackViewer.addTrack(e,t,n)},e.prototype.closeTrack=function(e,t,n){return void 0===t&&(t=!0),this.trackViewer.closeTrack(e,t,n)},e.prototype.getTracks=function(){return this.trackViewer.getTracks()},e.prototype.getPanels=function(){return this.trackViewer.getPanels()},e.prototype.render=function(e){var t=this;return r.createElement(i.default,{ref:function(e){t.appCanvasRef=e,t.startFrameLoop()},width:e.width,height:e.height,content:this.trackViewer,pixelRatio:e.pixelRatio||window.devicePixelRatio||1,style:e.style,onWillUnmount:function(){t.stopFrameLoop()}})},e.prototype.startFrameLoop=function(){0===this._frameLoopHandle&&this.frameLoop()},e.prototype.stopFrameLoop=function(){0!==this._frameLoopHandle&&(window.cancelAnimationFrame(this._frameLoopHandle),this._frameLoopHandle=0)},e}();t.default=s},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.layout=function(e,t,n){for(var o=r({glyphScale:1,kerningEnabled:!0,ligaturesEnabled:!0,lineHeight:1},n),i=new Array(e.length),a=0,s={l:0,r:0,t:0,b:0},l=0,u=0,c=0;c<e.length;c++){var f=e[c],d=e.charCodeAt(c);switch(d){case 160:case"\n".charCodeAt(0):u+=o.lineHeight,l=0;continue}if(o.ligaturesEnabled,o.kerningEnabled&&c>0){var h=e[c-1]+f;l+=t.kerning[h]||0}var p=t.characters[f];null!=p?(null!=p.glyph&&(i[a++]={char:f,x:l,y:u},s.r=Math.max(s.r,l+p.advance),s.b=Math.max(s.b,u+o.lineHeight)),l+=p.advance):console.warn('Font does not contain character for "'+f+'" ('+d+")")}return i.length>a&&(i.length=a),{font:t,sequence:i,bounds:s,glyphScale:o.glyphScale}},e.generateVertexData=function(e){for(var t=new Float32Array(6*e.sequence.length*5),n=0,r=0;r<e.sequence.length;r++){var o=e.sequence[r],i=e.font,a=i.characters[o.char];if(null!=a&&null!=a.glyph){var s=a.glyph,l=o.x-s.offset.x,u=-(o.y+i.ascender+s.offset.y),c=s.atlasRect.w/s.atlasScale,f=s.atlasRect.h/s.atlasScale,d=(s.atlasRect.x+.5)/i.textureSize.w,h=(s.atlasRect.y+.5)/i.textureSize.h,p=(s.atlasRect.w-1)/i.textureSize.w,v=(s.atlasRect.h-1)/i.textureSize.h;h+=v,v=-v,t.set([l,u,d,h,s.atlasScale,l+c,u+f,d+p,h+v,s.atlasScale,l,u+f,d,h+v,s.atlasScale,l,u,d,h,s.atlasScale,l+c,u,d+p,h,s.atlasScale,l+c,u+f,d+p,h+v,s.atlasScale],5*n),n+=6}}return{vertexArray:t,elementsPerVertex:5,vertexCount:n,vertexLayout:{position:{elements:2,elementSizeBytes:4,strideBytes:20,offsetBytes:0},uv:{elements:3,elementSizeBytes:4,strideBytes:20,offsetBytes:8}}}},e.parse=function(e){for(var t=new DataView(e),n="",r=0;r<e.byteLength;r++){var o=t.getInt8(r);if(0===o)break;n+=String.fromCharCode(o)}for(var i=r+1,a=JSON.parse(n),s={format:a.format,version:a.version,technique:a.technique,ascender:a.ascender,descender:a.descender,typoAscender:a.typoAscender,typoDescender:a.typoDescender,lowercaseHeight:a.lowercaseHeight,metadata:a.metadata,fieldRange_px:a.fieldRange_px,characters:{},kerning:{},glyphBounds:void 0,textures:[],textureSize:a.textureSize},l=new DataView(e,i+a.characters.start,a.characters.length),u=0;u<a.charList.length;u++){var c=a.charList[u],f=24*u,d={atlasRect:{x:l.getUint16(f+4,!0),y:l.getUint16(f+6,!0),w:l.getUint16(f+8,!0),h:l.getUint16(f+10,!0)},atlasScale:l.getFloat32(f+12,!0),offset:{x:l.getFloat32(f+16,!0),y:l.getFloat32(f+20,!0)}},h=0===d.atlasRect.w||0===d.atlasRect.h,p={advance:l.getFloat32(f+0,!0),glyph:h?void 0:d};s.characters[c]=p}var v=new DataView(e,i+a.kerning.start,a.kerning.length);for(u=0;u<a.kerningPairs.length;u++){var y=a.kerningPairs[u],g=v.getFloat32(4*u,!0);s.kerning[y]=g}if(null!=a.glyphBounds){s.glyphBounds={};var m=new DataView(e,i+a.glyphBounds.start,a.glyphBounds.length);for(u=0;u<a.charList.length;u++){c=a.charList[u],f=16*u;var x={t:m.getFloat32(f+0,!0),r:m.getFloat32(f+4,!0),b:m.getFloat32(f+8,!0),l:m.getFloat32(f+12,!0)};s.glyphBounds[c]=x}}for(var _=0;_<a.textures.length;_++){var b=a.textures[_];s.textures[_]=[];for(var T=0;T<b.length;T++){var w=b[T];if(null!=w.payloadBytes){var E=new Uint8Array(e,i+w.payloadBytes.start,w.payloadBytes.length),S=new Blob([E],{type:"image/png"}),P=new Image;P.src=URL.createObjectURL(S),s.textures[_][T]=P}else null!=w.localPath&&(s.textures[_][T]={localPath:w.localPath})}}return s},e}();t.default=o,"undefined"!=typeof window&&(window.GPUText=o)},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=n(0),s=n(11),l=function(e){function t(t,n,r,a){var s,l,u=e.call(this)||this;u.vertexAttributeLayout=n,u.instanceAttributeLayout=r,u.instanceFieldExtractors=a,u.render=!0,u.attributeLayout=u.vertexAttributeLayout.concat(u.instanceAttributeLayout),u.instanceCount=t.length,u.instancePacking={};var c=0;try{for(var f=o(u.instanceAttributeLayout),d=f.next();!d.done;d=f.next()){var h=d.value,p=i.shaderTypeLength[h.type];u.instancePacking[h.name]={length:p,offset:c},c+=p}}catch(e){s={error:e}}finally{try{d&&!d.done&&(l=f.return)&&l.call(f)}finally{if(s)throw s.error}}u.instancePackLength=c,u.instanceDataArray=new Float32Array(u.instancePackLength*t.length);for(var v=0;v<t.length;v++)u.writeInstanceAttributes(u.instanceDataArray,t[v],v);return u}return r(t,e),t.prototype.updateInstance=function(e,t){if(this.writeInstanceAttributes(this.instanceDataArray,t,e),null!=this.gpuInstanceBuffer){var n=e*this.instancePackLength,r=4*n;this.gpuInstanceBuffer.updateBufferData(this.instanceDataArray.subarray(n,n+this.instancePackLength),r)}},t.prototype.allocateGPUResources=function(e){var t,n;this.gpuInstanceBuffer=e.createBuffer({data:this.instanceDataArray});var r={};try{for(var i=o(this.instanceAttributeLayout),a=i.next();!a.done;a=i.next()){var l=a.value;r[l.name]={buffer:this.gpuInstanceBuffer,offsetBytes:4*this.instancePacking[l.name].offset,strideBytes:4*this.instancePackLength,instanceDivisor:1}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}this.gpuVertexState=this.allocateGPUVertexState(e,this.attributeLayout,r),this.gpuProgram=s.default.getProgram(e,this.getVertexCode(),this.getFragmentCode(),this.attributeLayout)},t.prototype.releaseGPUResources=function(){null!=this.gpuVertexState&&(this.gpuVertexState.delete(),this.gpuVertexState=null),null!=this.gpuInstanceBuffer&&(this.gpuInstanceBuffer.delete(),this.gpuInstanceBuffer=null),this.gpuProgram=null},t.prototype.writeInstanceAttributes=function(e,t,n){var r,i,a=this.instancePackLength*n;try{for(var s=o(this.instanceAttributeLayout),l=s.next();!l.done;l=s.next()){var u=l.value.name,c=this.instancePacking[u],f=a+c.offset,d=this.instanceFieldExtractors[u](t);d.length!==c.length&&console.warn("Instance attribute data length was "+d.length+", but expected length "+c.length),e.set(d,f)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},t.prototype.allocateGPUVertexState=function(e,t,n){return null},t.prototype.getVertexCode=function(){return null},t.prototype.getFragmentCode=function(){return null},t}(a.default);t.Object2DInstances=l,t.default=l},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(16)),r(n(19))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(49)),r(n(30)),r(n(5)),r(n(29)),r(n(25)),r(n(28)),r(n(27)),r(n(26))},function(e,t,n){e.exports=n.p+"assets/OpenSans-Regular.msdf.bin"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(10))},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.children=new Set}return e.prototype.add=function(e){this.children.add(e)},e.prototype.has=function(e){return this.children.has(e)},e.prototype.remove=function(e){return this.children.delete(e)},e.prototype.applyTransformToSubNodes=function(e){var t,n;void 0===e&&(e=!0);try{for(var o=r(this.children),i=o.next();!i.done;i=o.next()){i.value.applyTransformToSubNodes(!0)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.forEachSubNode=function(e){var t,n;try{for(var o=r(this.children),i=o.next();!i.done;i=o.next()){var a=i.value;e(a),a.forEachSubNode(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e}();t.Node=o,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t,n){if(this.target=e,this.root=t,this.clearOptions=n,null!=e)throw"Framebuffer target not yet supported"}}();t.RenderPass=r,t.default=r},function(e,t,n){"use strict";function r(e){return function(){return e}}var o=function(){};o.thatReturns=r,o.thatReturnsFalse=r(!1),o.thatReturnsTrue=r(!0),o.thatReturnsNull=r(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var r=function(e){};e.exports=function(e,t,n,o,i,a,s,l){if(r(t),!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,o,i,a,s,l],f=0;(u=new Error(t.replace(/%s/g,function(){return c[f++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,a,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var u in n=Object(arguments[l]))o.call(n,u)&&(s[u]=n[u]);if(r){a=r(n);for(var c=0;c<a.length;c++)i.call(n,a[c])&&(s[a[c]]=n[a[c]])}}return s}},function(e,t,n){"use strict";
/** @license React v16.3.2
 * react.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(58),o=n(57),i=n(56),a=n(55),s="function"==typeof Symbol&&Symbol.for,l=s?Symbol.for("react.element"):60103,u=s?Symbol.for("react.portal"):60106,c=s?Symbol.for("react.fragment"):60107,f=s?Symbol.for("react.strict_mode"):60108,d=s?Symbol.for("react.provider"):60109,h=s?Symbol.for("react.context"):60110,p=s?Symbol.for("react.async_mode"):60111,v=s?Symbol.for("react.forward_ref"):60112,y="function"==typeof Symbol&&Symbol.iterator;function g(e){for(var t=arguments.length-1,n="http://reactjs.org/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);o(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function x(e,t,n){this.props=e,this.context=t,this.refs=i,this.updater=n||m}function _(){}function b(e,t,n){this.props=e,this.context=t,this.refs=i,this.updater=n||m}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&g("85"),this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=x.prototype;var T=b.prototype=new _;T.constructor=b,r(T,x.prototype),T.isPureReactComponent=!0;var w={current:null},E=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,n){var r=void 0,o={},i=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(i=""+t.key),t)E.call(t,r)&&!S.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(1===s)o.children=n;else if(1<s){for(var u=Array(s),c=0;c<s;c++)u[c]=arguments[c+2];o.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===o[r]&&(o[r]=s[r]);return{$$typeof:l,type:e,key:i,ref:a,props:o,_owner:w.current}}function A(e){return"object"==typeof e&&null!==e&&e.$$typeof===l}var C=/\/+/g,L=[];function R(e,t,n,r){if(L.length){var o=L.pop();return o.result=e,o.keyPrefix=t,o.func=n,o.context=r,o.count=0,o}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function N(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>L.length&&L.push(e)}function I(e,t,n,r){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var i=!1;if(null===e)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case l:case u:i=!0}}if(i)return n(r,e,""===t?"."+O(e,0):t),1;if(i=0,t=""===t?".":t+":",Array.isArray(e))for(var a=0;a<e.length;a++){var s=t+O(o=e[a],a);i+=I(o,s,n,r)}else if(null===e||void 0===e?s=null:s="function"==typeof(s=y&&e[y]||e["@@iterator"])?s:null,"function"==typeof s)for(e=s.call(e),a=0;!(o=e.next()).done;)i+=I(o=o.value,s=t+O(o,a++),n,r);else"object"===o&&g("31","[object Object]"===(n=""+e)?"object with keys {"+Object.keys(e).join(", ")+"}":n,"");return i}function O(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}(e.key):t.toString(36)}function M(e,t){e.func.call(e.context,t,e.count++)}function k(e,t,n){var r=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?U(e,r,n,a.thatReturnsArgument):null!=e&&(A(e)&&(t=o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(C,"$&/")+"/")+n,e={$$typeof:l,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}),r.push(e))}function U(e,t,n,r,o){var i="";null!=n&&(i=(""+n).replace(C,"$&/")+"/"),t=R(t,i,r,o),null==e||I(e,"",k,t),N(t)}var D={Children:{map:function(e,t,n){if(null==e)return e;var r=[];return U(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;t=R(null,null,t,n),null==e||I(e,"",M,t),N(t)},count:function(e){return null==e?0:I(e,"",a.thatReturnsNull,null)},toArray:function(e){var t=[];return U(e,t,null,a.thatReturnsArgument),t},only:function(e){return A(e)||g("143"),e}},createRef:function(){return{current:null}},Component:x,PureComponent:b,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:h,_calculateChangedBits:t,_defaultValue:e,_currentValue:e,_changedBits:0,Provider:null,Consumer:null}).Provider={$$typeof:d,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:v,render:e}},Fragment:c,StrictMode:f,unstable_AsyncMode:p,createElement:P,cloneElement:function(e,t,n){(null===e||void 0===e)&&g("267",e);var o=void 0,i=r({},e.props),a=e.key,s=e.ref,u=e._owner;if(null!=t){void 0!==t.ref&&(s=t.ref,u=w.current),void 0!==t.key&&(a=""+t.key);var c=void 0;for(o in e.type&&e.type.defaultProps&&(c=e.type.defaultProps),t)E.call(t,o)&&!S.hasOwnProperty(o)&&(i[o]=void 0===t[o]&&void 0!==c?c[o]:t[o])}if(1===(o=arguments.length-2))i.children=n;else if(1<o){c=Array(o);for(var f=0;f<o;f++)c[f]=arguments[f+2];i.children=c}return{$$typeof:l,type:e.type,key:a,ref:s,props:i,_owner:u}},createFactory:function(e){var t=P.bind(null,e);return t.type=e,t},isValidElement:A,version:"16.3.2",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:w,assign:r}},F=Object.freeze({default:D}),G=F&&D||F;e.exports=G.default?G.default:G},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(32)),r(n(17))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(60)),r(n(52)),r(n(50)),r(n(24)),r(n(22)),r(n(18)),r(n(23))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),a=function(){function e(e){var t=this;this.callbacks={onVersion:function(e){},onSequenceRegion:function(e,t,n){},onFeatureOntology:function(e){},onAttributeOntology:function(e){},onSourceOntology:function(e){},onSpecies:function(e){},onGenomeBuild:function(e,t){},onFeatureGroupTermination:function(){},onFastaStart:function(){},onComment:function(e){},onFeature:function(e,t,n,r,o,i,a,s,l){},onUnknownDirective:function(e,t){},onInvalidDirective:function(e,t){},onInvalidFeature:function(e,t){},onInvalidAttribute:function(e,t){},onFastaChunk:function(e){},onComplete:function(){}},this.lineNumber=0,this.parseChunk=function(e){if(t.fastaMode)t.callbacks.onFastaChunk(e);else{for(var n=0,r=0;r<e.length;r++){"\n"===e.charAt(r)&&(t.parseLine(t.incompleteLineBuffer+e.substring(n,r),t.lineNumber++),n=r+1,t.incompleteLineBuffer="")}t.incompleteLineBuffer=e.substring(n)}},this.end=function(){t.parseLine(t.incompleteLineBuffer,t.lineNumber++),t.callbacks.onComplete()},this.reset=function(){t.lineNumber=0,t.incompleteLineBuffer="",t.fastaMode=!1},this.callbacks=r({},this.callbacks,e),this.reset()}return e.prototype.parseLine=function(e,t){if(""!==e)if("#"===e[0])this.parseMeta(e);else{var n=e.split("\t");9!==n.length?this.callbacks.onInvalidFeature(e,"Expected 9 tab-separated columns, got "+n.length):this.callbacks.onFeature(decodeURIComponent(n[0]),null===this.parseOptional(n[1])?null:decodeURIComponent(n[1]),decodeURIComponent(n[2]),null===this.parseOptional(n[3])?null:parseInt(n[3]),null===this.parseOptional(n[4])?null:parseInt(n[4]),null===this.parseOptional(n[5])?null:parseFloat(n[5]),this.parseStrand(this.parseOptional(n[6])),null===this.parseOptional(n[7])?null:parseInt(n[7]),this.parseAttributes(this.parseOptional(n[8])))}},e.prototype.parseOptional=function(e){return"."===e?null:e},e.prototype.parseStrand=function(e){switch(e){case"+":return i.Strand.Positive;case"-":return i.Strand.Negative;case"?":return i.Strand.Unknown;default:return i.Strand.None}},e.prototype.parseAttributes=function(e){var t,n,r={isCircular:!1,custom:{}};if(null==e)return r;var i=e.split(";");try{for(var a=o(i),s=a.next();!s.done;s=a.next()){var l=s.value;try{var u=l.indexOf("=");if(-1===u)throw"Assignment must contain a '=' character";var c=decodeURIComponent(l.substring(0,u)).trim(),f=l.substring(u+1).split(",").map(decodeURIComponent);switch(c){case"ID":r.id=f[0];break;case"Name":r.name=f[0];break;case"Alias":r.aliases=f;break;case"Parent":r.parentIds=f;break;case"Target":var d=f[0].match(/([^\s]+)\s+(\d+)\s+(\d+)(\s+([+-]))?/);if(null===d)throw"Could not parse target format";r.target={id:d[1],start:parseInt(d[2]),end:parseInt(d[3]),strand:this.parseStrand(d[5])};break;case"Gap":r.gap=f[0];break;case"Derives_from":r.derivesFromId=f[0];break;case"Note":r.notes=f;break;case"Dbxref":r.dbxrefs=f;break;case"Ontology_term":r.ontologyTerms=f;break;case"Is_circular":r.isCircular="true"===f[0].toLowerCase().trim();break;default:r.custom[c]=f}}catch(u){this.callbacks.onInvalidAttribute(l,u)}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r},e.prototype.parseMeta=function(e){"#"===e[1]?this.parseDirective(e):this.callbacks.onComment(e.substr(1))},e.prototype.parseDirective=function(e){var t=e.substring(2),n=/^([^\s]+)(\s+(.*))?/.exec(t);if(null!==n){var r=n[1].toLowerCase(),o=n[3];try{switch(r){case"#":if(null!=o)throw"Feature termination directive must not have any parameter";this.callbacks.onFeatureGroupTermination();break;case"gff-version":if(null==o)throw"Missing version string";this.callbacks.onVersion(o.trim());break;case"sequence-region":var i=null,a=null,s=null,l=(o||"").match(/^([^\s]+)(\s+(\d+))?(\s+(\d+))?/);null!==l&&(i=decodeURIComponent(l[1]),a=void 0===l[3]?null:parseInt(l[3]),s=void 0===l[5]?null:parseInt(l[5])),this.callbacks.onSequenceRegion(i,a,s);break;case"feature-ontology":if(null==o)throw"Missing URI";this.callbacks.onFeatureOntology(o);break;case"attribute-ontology":if(null==o)throw"Missing URI";this.callbacks.onAttributeOntology(o);break;case"source-ontology":if(null==o)throw"Missing URI";this.callbacks.onSourceOntology(o);break;case"species":if(null==o)throw"Missing species";this.callbacks.onSpecies(decodeURIComponent(o));break;case"genome-build":if(null==o)throw"Missing source and build name";var u=(o||"").split(/\s+/);this.callbacks.onGenomeBuild(decodeURIComponent(u[0]),decodeURIComponent(u[1]));break;case"#":this.callbacks.onFeatureGroupTermination();break;case"fasta":this.fastaMode=!0,this.callbacks.onFastaStart();break;default:this.callbacks.onUnknownDirective(r,o)}}catch(e){this.callbacks.onInvalidDirective(t,e)}}else this.callbacks.onInvalidDirective(t,"Invalid directive name")},e}();t.Gff3LineParser=a,t.default=a},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(62),a=function(){function e(e,t){var n=this;this.storeFeatures=t,this.callbacks={onFeatureComplete:function(){},onComplete:function(){},onError:function(){},onComment:function(){}},this.parseChunk=function(e){n.lineParser.parseChunk(e)},this.end=function(){n.lineParser.end(),n.reset()},this.defineFeature=function(e,t,r,i,a,s,l,u,c){var f,d;if(null!=i&&null!=a){var h={sequenceId:e,id:c.id,name:c.name,type:r,start:i,end:a,strand:l,children:new Array,phase:u,attributes:c};if(null!=c.id&&(n.currentScope[c.id]=h),null==c.parentIds)n.storeFeatures&&n.getSequence(e).features.add(h),n.currentScopeTopLevel.add(h);else try{for(var p=o(c.parentIds),v=p.next();!v.done;v=p.next()){var y=v.value,g=n.currentScope[y];null!=g?g.children.push(h):n.callbacks.onError('Feature "'+e+'" referenced parent "'+y+'" before definition')}}catch(e){f={error:e}}finally{try{v&&!v.done&&(d=p.return)&&d.call(p)}finally{if(f)throw f.error}}}else n.callbacks.onError("Invalid range for "+r+" - "+c.id+"/"+c.name+"; start or end is null ("+i+" - "+a+")")},this.closeCurrentScope=function(){var e,t;try{for(var r=o(n.currentScopeTopLevel),i=r.next();!i.done;i=r.next()){var a=i.value;n.callbacks.onFeatureComplete(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}n.currentScope={},n.currentScopeTopLevel=new Set},this.onLineParserComplete=function(){n.callbacks.onComplete(n.gff3)},this.setSequenceRange=function(e,t,r){var o=n.getSequence(e);null!==t&&(o.start=t),null!==r&&(o.end=r)},this.callbacks=r({},this.callbacks,e),this.reset()}return e.prototype.reset=function(){var e=this;this.gff3={version:"3",sequences:{}},this.currentScope={},this.currentScopeTopLevel=new Set,this.lineParser=new i.default({onSequenceRegion:this.setSequenceRange,onVersion:function(t){return e.gff3.version=t},onFeatureOntology:function(t){(e.gff3.featureOntologyUri||[]).push(t)},onAttributeOntology:function(t){(e.gff3.attributeOntologyUri||[]).push(t)},onSourceOntology:function(t){(e.gff3.sourceOntologyUri||[]).push(t)},onSpecies:function(t){return e.gff3.speciesUri=t},onGenomeBuild:function(t,n){e.gff3.genomeBuild={source:t,buildName:n}},onComment:this.callbacks.onComment,onFeature:this.defineFeature,onFeatureGroupTermination:this.closeCurrentScope,onFastaStart:function(){return e.gff3.fasta=""},onFastaChunk:function(t){return e.gff3.fasta+=t},onComplete:this.onLineParserComplete,onUnknownDirective:function(t,n){return e.callbacks.onError('Unknown directive "'+t+" "+n+'"')},onInvalidAttribute:function(t,n){return e.callbacks.onError('Invalid attribute: "'+t+'", '+n)},onInvalidDirective:function(t,n){return e.callbacks.onError('Invalid directive: "'+t+'", '+n)},onInvalidFeature:function(t,n){return e.callbacks.onError("Invalid feature: "+n)}})},e.prototype.getSequence=function(e){var t=this.gff3.sequences[e];return void 0===t&&(t=this.gff3.sequences[e]={features:new Set}),t},e}();t.Gff3Parser=a,t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=function(){return function(e,t){this.rule=e,this.value=t}}(),i=function(){return function(e,t,n,r){this.rule=e,this.value=t,this.path=n,this.isTerminal=r}}(),a="EOF",s="ANY",l="ALL",u=function(e){return e.slice(1,e.length-1)},c=function(e){return e.replace(/(^[ '\^\$\*#&]+)|([ '\^\$\*#&]+$)/g,"")},f=function(e){var t=e.toString();return t.slice(1,t.length-2)};function d(e){return Promise.all(e).then(function(e){var t=[];return e.forEach(function(e){t=t.concat(e)}),t})}var h=new r.QueryBuilder;function p(e){var t=e[0];return"VARIANTS"===t.rule?function(e){var t=e[0];if("INFLUENCING"===t.rule){var n=u(e[1].value);h.newInfoQuery(),h.filterType("trait"),h.searchText(n);var r=h.build();h.newEdgeQuery(),h.setToNode(r);var o=h.build();return h.newGenomeQuery(),h.addToEdge(o),h.setSpecialGWASQuery(),h.build()}if("NAMED"===t.rule){var i=c(e[1].value.toLowerCase());return h.newGenomeQuery(),h.filterID("Gsnp_"+i),h.build()}}(e.slice(1)):"GENE_T"===t.rule?function(e){var t=e[0];if("NAMED"===t.rule){var n=u(e[1].value);return h.newGenomeQuery(),h.filterName(n.toUpperCase()),h.build()}if("INFLUENCING"===t.rule){var r=u(e[1].value);h.newInfoQuery(),h.filterType("trait"),h.searchText(r);var o=h.build();h.newEdgeQuery(),h.setToNode(o),h.filterMaxPValue(.05);var i=h.build();h.newGenomeQuery(),h.addToEdge(i),h.setLimit(1e6);var a=h.build();return h.newGenomeQuery(),h.filterType("gene"),h.addArithmeticIntersect(a),h.build()}}(e.slice(1)):"TRAIT_T"===t.rule?function(e){var t=u(e[0].value);return h.newInfoQuery(),h.filterType("trait"),h.searchText(t),h.build()}(e.slice(1)):"PROMOTER"===t.rule||"ENHANCER"===t.rule?function(e){var t="PROMOTER"==e[0].rule?"Promoter-like":"Enhancer-like",n=[u(e[2].value)],r=u(e[4].value);return h.newGenomeQuery(),h.filterType(t),h.filterTargets(n),h.filterBiosample(r),h.setLimit(2e6),h.build()}(e):"EQTL"===t.rule?function(e){var t=e[0];if("INFLUENCING"===t.rule){var n=u(e[1].value);h.newGenomeQuery(),h.filterName(n.toUpperCase());var r=h.build();h.newEdgeQuery(),h.setToNode(r);var o=h.build();return h.newGenomeQuery(),h.addToEdge(o),h.setLimit(1e6),h.build()}if("NAMED"===t.rule){var i=c(e[1].value.toLowerCase());h.newGenomeQuery(),h.filterID("Gsnp_"+i);var a=h.build();return h.newEdgeQuery(),h.setToNode(a,!0),o=h.build()}}(e.slice(1)):"PATIENT_T"===t.rule?function(e){if("WITH_TUMOR"===e[0].rule){var t=u(e[1].value);return h.newInfoQuery(),h.filterType("patient"),h.filterBiosample(t),h.setLimit(1e6),h.build()}}(e.slice(1)):"RS_T"===t.rule?function(e){return h.newGenomeQuery(),h.filterID("Gsnp_"+c(e[0].value.toLowerCase())),h.build()}(e):void 0}var v=function(){function e(e,t,n){this.grammar=e,this.terminals=t,this.suggestions=n}return e.prototype.eat=function(e,t){var n=(e=c(e)).toLowerCase(),r=this.terminals.get(t);r.lastIndex=0;var o=r.exec(n);if(null!==o){var i=o.index+o[0].length;return{parsed:e.slice(0,i),rest:e.slice(i)}}return{parsed:null,rest:e}},e.prototype.parse=function(e,t,n){var r=this;if(void 0===n&&(n=[]),t===a&&0===e.length)return(h=n.slice(0)).push(new o(a,"")),[new i(t,e,h,!0)];if(void 0!==this.terminals.get(t)){if(null!==(v=this.eat(e,t).parsed)){var u=n.slice(0);return u.push(new o(t,v)),[new i(t,v,u,!0)]}return[new i(t,e,n.slice(0),!1)]}if(this.grammar.get(t)){var f=this.grammar.get(t);return this.parse(e,f,n.slice(0))}if(t[0]===s){var d=[];return t.slice(1).forEach(function(t){d=d.concat(r.parse(e,t,n.slice(0)))}),d}if(t[0]===l){if(this.terminals.get(t[1])){var h,p=this.eat(e,t[1]),v=p.parsed,y=p.rest;if((h=n.slice(0)).push(new o(t[1],v)),y===e||null===v)return this.parse(e,t[1],n.slice(0));var g=t.slice(2);return 0===g.length?[]:1===g.length?this.parse(y,t[2],h):this.parse(y,[l].concat(g),h)}if(this.grammar.get(t[1])){f=this.grammar.get(t[1]);for(var m=this.parse(e,f,n.slice(0)),x=m.reduce(function(e,t){return e.path.length>t.path.length?e:t}),_=x.path?x.path.length:0,b=[],T=m.filter(function(e){return e.path.length===_}),w=0;w<T.length;w++){var E=T[w];if(E.isTerminal){var S=E.path.slice(n.length).map(function(e){return e.value}).join(" "),P=c(e),A=P.indexOf(S);y=P.slice(A+S.length);if(0!==t.slice(2).length)return 1===t.slice(2).length?this.parse(y,t[2],E.path.slice(0)):this.parse(y,[l].concat(t.slice(2)),E.path.slice(0));b.push(new i(E.rule,E.value,E.path,E.isTerminal))}else b.push(new i(E.rule,E.value,E.path.slice(0),E.isTerminal))}return b}}return[]},e.prototype.buildSuggestionsFromParse=function(e,t,n){var r=this;void 0===n&&(n=15);var o=t.reduce(function(e,t){return e.path.length>t.path.length?e:t}),i=o.path.length,s=[],l=!1;t.filter(function(e){return e.path.length===i}).forEach(function(e){var t=e.rule,o=e.value;if(e.rule===a){t=e.path[e.path.length-2].rule;var i=e.path[e.path.length-2].value;o=i.slice(1,i.length-1)}r.terminals.has(t)&&function(e){var t=f(e);return'"'===t[0]&&'"'===t[t.length-1]}(r.terminals.get(t))&&(l=!0),r.suggestions.get(t)?(o=c(o).toLowerCase(),s.push(r.suggestions.get(t)(o,n/2))):s.push(new Promise(function(e,n){e([{rule:t,value:f(r.terminals.get(t))}])}))});var u=null,v=null;if(o.rule===a)u=p(o.path);else if(0===o.path.length){u=function(e){if(!e)return null;var t=e===e.toUpperCase(),n=!isNaN(+e[e.length-1]);return e.length>5&&!t&&!n?(h.newInfoQuery(),h.filterType("trait"),h.searchText(e)):(h.newGenomeQuery(),h.filterType("gene"),h.filterName(e.toUpperCase())),h.build()}(e),v=d([this.suggestions.get("GENE")(e,n/4),this.suggestions.get("TRAIT")(e,n/4)])}return{tokens:o.path,suggestions:d(s),additionalSuggestions:v,query:u,isQuoted:l}},e.prototype.getSuggestions=function(e,t){void 0===t&&(t=15);var n=this.parse(e,this.grammar.get("ROOT"));return 0===n.length?null:this.buildSuggestionsFromParse(e,n,t)},e}();t.QueryParser=v,t.buildQueryParser=function(e){var t=new Map;t.set("TRAIT",/"(.+?)"/g),t.set("GENE",/"(.+?)"/g),t.set("INFLUENCING",/influencing/g),t.set("OF",/of/g),t.set("VARIANTS",/variants/g),t.set("GENE_T",/gene/g),t.set("TRAIT_T",/trait/g),t.set("NEAR",/near/g),t.set("IN",/in/g),t.set("PROMOTER",/promoters/g),t.set("ENHANCER",/enhancers/g),t.set("TARGET",/"(.+?)"/g),t.set("CELL_TYPE",/"(.+?)"/g),t.set("EQTL",/eqtl/g),t.set("NAMED",/named/g),t.set("TUMOR_SITE",/"(.+?)"/g),t.set("PATIENT_T",/patient/g),t.set("WITH_TUMOR",/with tumor/g),t.set("RS_T",/rs\d+$/g),t.set("NUMBER",/^\d+$/g);var n=new Map;return n.set("NAMED_GENE_OR_INFLUENCEING_TRAIT",[s,"INFLUENCING_TRAIT","NAMED_GENE"]),n.set("INFLUENCING_GENE_OR_NAMED_RS",[s,"INFLUENCING_GENE","NAMED_SNP_RS"]),n.set("INFLUENCING_TRAIT_OR_NAMED_RS",[s,"INFLUENCING_TRAIT","NAMED_SNP_RS"]),n.set("INFLUENCING_TRAIT",[l,"INFLUENCING","TRAIT"]),n.set("INFLUENCING_GENE",[l,"INFLUENCING","GENE"]),n.set("NAMED_GENE",[l,"NAMED","GENE"]),n.set("NAMED_SNP_RS",[l,"NAMED","RS_T"]),n.set("ANNOTATION_TYPE",[s,"PROMOTER","ENHANCER"]),n.set("CELL_ANNOTATION",[l,"ANNOTATION_TYPE","OF","TARGET","IN","CELL_TYPE"]),n.set("VARIANT_QUERY",[l,"VARIANTS","INFLUENCING_TRAIT_OR_NAMED_RS",a]),n.set("GENE_QUERY",[l,"GENE_T","NAMED_GENE_OR_INFLUENCEING_TRAIT",a]),n.set("TRAIT_QUERY",[l,"TRAIT_T","TRAIT",a]),n.set("EQTL_QUERY",[l,"EQTL","INFLUENCING_GENE_OR_NAMED_RS",a]),n.set("ANNOTATION_QUERY",[l,"CELL_ANNOTATION",a]),n.set("ROOT",[s,"VARIANT_QUERY","GENE_QUERY","TRAIT_QUERY","EQTL_QUERY","ANNOTATION_QUERY"]),e.set("RS_T",function(e,t){return new Promise(function(e,t){return e([])})}),new v(n,t,e)},t.buildVariantQueryParser=function(e){var t=new Map;t.set("TRAIT",/"(.+?)"/g),t.set("GENE",/"(.+?)"/g),t.set("INFLUENCING",/influencing/g),t.set("OF",/of/g),t.set("VARIANTS",/variants/g),t.set("GENE_T",/gene/g),t.set("TRAIT_T",/trait/g),t.set("NEAR",/near/g),t.set("IN",/in/g),t.set("PROMOTER",/promoters/g),t.set("ENHANCER",/enhancers/g),t.set("TARGET",/"(.+?)"/g),t.set("CELL_TYPE",/"(.+?)"/g),t.set("EQTL",/eqtl/g),t.set("NAMED",/named/g),t.set("TUMOR_SITE",/"(.+?)"/g),t.set("PATIENT_T",/patient/g),t.set("WITH_TUMOR",/with tumor/g),t.set("RS_T",/rs\d+$/g),t.set("NUMBER",/^\d+$/g);var n=new Map;return n.set("REGION_QUERY",[s,"GENE_QUERY","EQTL_QUERY","ANNOTATION_QUERY"]),n.set("NAMED_GENE_OR_INFLUENCEING_TRAIT",[s,"INFLUENCING_TRAIT","NAMED_GENE"]),n.set("VARIANT_OF_QUERY",[l,"OF","REGION_QUERY"]),n.set("INFLUENCING_GENE_OR_NAMED_RS",[s,"INFLUENCING_GENE","NAMED_SNP_RS"]),n.set("INFLUENCING_TRAIT_OR_NAMED_RS",[s,"INFLUENCING_TRAIT","NAMED_SNP_RS","VARIANT_OF_QUERY"]),n.set("INFLUENCING_TRAIT",[l,"INFLUENCING","TRAIT"]),n.set("INFLUENCING_GENE",[l,"INFLUENCING","GENE"]),n.set("NAMED_GENE",[l,"NAMED","GENE"]),n.set("NAMED_SNP_RS",[l,"NAMED","RS_T"]),n.set("ANNOTATION_TYPE",[s,"PROMOTER","ENHANCER"]),n.set("CELL_ANNOTATION",[l,"ANNOTATION_TYPE","OF","TARGET","IN","CELL_TYPE"]),n.set("GENE_QUERY",[l,"GENE_T","NAMED_GENE_OR_INFLUENCEING_TRAIT",a]),n.set("TRAIT_QUERY",[l,"TRAIT_T","TRAIT",a]),n.set("EQTL_QUERY",[l,"EQTL","INFLUENCING_GENE_OR_NAMED_RS",a]),n.set("ANNOTATION_QUERY",[l,"CELL_ANNOTATION",a]),n.set("ROOT",[s,"INFLUENCING_TRAIT_OR_NAMED_RS"]),e.set("RS_T",function(e,t){return new Promise(function(e,t){return e([])})}),new v(n,t,e)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SNP="SNP",e.VARIANT="variant",e.GENE="gene",e.PSUDOGENE="psudogene",e.NCRNAGENE="ncRNA_gene",e.TRAIT="trait",e.GWAS="association:SNP:trait",e.EQTL="association:SNP:gene"}(r||(r={})),t.EntityType=r},function(e,t,n){"use strict";var r,o,i,a,s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},l=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Gene=0]="Gene",e[e.Transcript=1]="Transcript",e[e.TranscriptComponent=2]="TranscriptComponent"}(r=t.GenomeFeatureType||(t.GenomeFeatureType={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.ProteinCoding=1]="ProteinCoding",e[e.NonProteinCoding=2]="NonProteinCoding",e[e.Pseudo=3]="Pseudo"}(o=t.GeneClass||(t.GeneClass={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.ProteinCoding=1]="ProteinCoding",e[e.NonProteinCoding=2]="NonProteinCoding"}(i=t.TranscriptClass||(t.TranscriptClass={})),function(e){e[e.Exon=0]="Exon",e[e.Untranslated=1]="Untranslated",e[e.ProteinCodingSequence=2]="ProteinCodingSequence"}(a=t.TranscriptComponentClass||(t.TranscriptComponentClass={}));var u=function(){function e(){this.gene=o.Unspecified,this.ncRNA_gene=o.NonProteinCoding,this.pseudogene=o.Pseudo}return e.instance=new e,e}();t.SoGeneClass=u;var c=function(){function e(){this.lnc_RNA=i.NonProteinCoding,this.mRNA=i.ProteinCoding,this.pseudogenic_transcript=i.Unspecified,this.transcript=i.Unspecified,this.miRNA=i.NonProteinCoding,this.ncRNA=i.NonProteinCoding,this.rRNA=i.NonProteinCoding,this.scRNA=i.NonProteinCoding,this.snoRNA=i.NonProteinCoding,this.snRNA=i.NonProteinCoding}return e.instance=new e,e}();t.SoTranscriptClass=c;var f=function(){function e(){this.CDS=a.ProteinCodingSequence,this.exon=a.Exon,this.five_prime_UTR=a.Untranslated,this.three_prime_UTR=a.Untranslated}return e.instance=new e,e}();t.SoTranscriptComponentClass=f;var d=function(){function e(e,t,n,r){var o=this;this.tileSize=e,this.topLevelOnly=t,this.onUnknownFeature=n,this.onError=r,this.sequences={},this.addTopLevelFeature=function(e){for(var t=Math.floor(e.start/o.tileSize),n=Math.floor(e.end/o.tileSize),r=t;r<=n;r++){var i=o.getTile(e.sequenceId,r);o.addFeature(i,e)}}}return e.prototype.addFeature=function(e,t){var n,o,i={name:t.name,startIndex:t.start-1,length:t.end-t.start+1,soClass:t.type};if(void 0!==u.instance[t.type]){var a=t.children.reduce(function(e,t){return void 0!==c.instance[t.type]?e+1:e},0),d=s({},i,{type:r.Gene,class:u.instance[t.type],strand:t.strand,transcriptCount:a});e.content.push(d)}else if(void 0!==c.instance[t.type]){var h=s({},i,{type:r.Transcript,class:c.instance[t.type]});e.content.push(h)}else{if(void 0===f.instance[t.type])return void this.onUnknownFeature(t);var p=s({},i,{type:r.TranscriptComponent,class:f.instance[t.type]});null!=t.phase&&(p.phase=t.phase),e.content.push(p)}if(!this.topLevelOnly)try{for(var v=l(t.children),y=v.next();!y.done;y=v.next()){var g=y.value;this.addFeature(e,g)}}catch(e){n={error:e}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(n)throw n.error}}},e.prototype.getTile=function(e,t){var n=this.sequences[e];if(void 0===n&&(n=this.sequences[e]=[]),void 0===n[t])for(var r=0;r<=t;r++)void 0===n[r]&&(n[r]={startIndex:r*this.tileSize,span:this.tileSize,content:[]});return n[t]},e}();t.Tileset=d},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(44),a=function(){function e(){}return e.loadAnnotations=function(e,t,n,r){var o="https://valis-tmp-data.firebaseapp.com/data/annotation/"+e+(t?"-macro":"")+"/"+n+","+r+".json";return i.default.get(o).then(function(e){return e.data})},e.loadACGTSubSequence=function(e,t,n,r){var o=this,a=1<<t,s=a*n+1,l=s+r*a-1,u=this.apiUrl+"/datatracks/sequence/"+e+"/"+s+"/"+l+"?sampling_rate="+a;return i.default({method:"get",url:u,responseType:"arraybuffer",headers:{}}).then(function(e){var t=new Float32Array(o.parseSiriusBinaryResponse(e.data)),n=t.length/4;n>r&&console.warn("Payload too large, expected "+r+" units but received "+n+" units");for(var i=new Uint8Array(t.length),a=1/0,s=-1/0,l=0;l<n;l++){var u=t[4*l+0],c=t[4*l+1],f=t[4*l+2],d=t[4*l+3];a=Math.min(a,u),a=Math.min(a,c),a=Math.min(a,f),a=Math.min(a,d),s=Math.max(s,u),s=Math.max(s,c),s=Math.max(s,f),s=Math.max(s,d)}var h=s-a,p=0===h?0:1/h;for(l=0;l<n;l++)i[4*l+0]=Math.round(255*Math.min((t[4*l+0]-a)*p,1)),i[4*l+1]=Math.round(255*Math.min((t[4*l+3]-a)*p,1)),i[4*l+2]=Math.round(255*Math.min((t[4*l+2]-a)*p,1)),i[4*l+3]=Math.round(255*Math.min((t[4*l+1]-a)*p,1));return{array:i,sequenceMinMax:{min:a,max:s},indicesPerBase:4}})},e.loadSignal=function(e,t,n,r){var o=this,a=1<<t,s=a*n+1,l=s+r*a-1,u=this.apiUrl+"/datatracks/ENCFF918ESR/chr1/"+s+"/"+l+"?sampling_rate="+a;return i.default({method:"get",url:u,responseType:"arraybuffer",headers:{}}).then(function(e){var t=o.parseSiriusBinaryResponse(e.data),n=new Float32Array(t);return console.log(t,n),n})},e.getContigInfoPromise=function(){return null==this._contigInfoPromise&&(this._contigInfoPromise=i.default.get(e.apiUrl+"/contig_info").then(function(e){var t,n,o=e.data,i={};try{for(var a=r(o),s=a.next();!s.done;s=a.next()){var l=s.value;i[l.name]={start:l.start,length:l.length}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i})),this._contigInfoPromise},e.getContigInfo=function(e){return this.getContigInfoPromise().then(function(t){var n=t[e];if(null==n)throw'No contig info available for "'+e+'"';return n})},e.getContigs=function(){return this.getContigInfoPromise().then(function(e){return Object.keys(e)})},e.getContigsSorted=function(){return null==this._sortedContigsPromise&&(this._sortedContigsPromise=this.getContigs().then(function(e){return e.sort(function(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})})})),this._sortedContigsPromise},e.getGraphs=function(){return i.default.get(this.apiUrl+"/graphs").then(function(e){return e.data})},e.getGraphData=function(e,t,n,r,o,a){void 0===a&&(a=1);var s="?sampling_rate="+a,l=this.apiUrl+"/graphs/"+e+"/"+t+"/"+n+"/"+r+"/"+o+s;return i.default.get(l)},e.getTracks=function(){return i.default.get(this.apiUrl+"/tracks").then(function(e){return e.data})},e.getTrackInfo=function(){return i.default.get(this.apiUrl+"/track_info").then(function(e){return e.data})},e.getDistinctValues=function(e,t){var n=this.apiUrl+"/distinct_values/"+e;return i.default.post(n,t).then(function(e){return e.data})},e.getDetails=function(e){return i.default.get(this.apiUrl+"/details/"+e).then(function(e){return e.data})},e.getQueryResults=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=null);var o=this.apiUrl+"/query/basic";t&&(o=this.apiUrl+"/query/full"),e.specialGWASQuery&&(o=this.apiUrl+"/query/gwas");var a=[];return null!==n&&a.push("result_start="+n),null!==r&&a.push("result_end="+r),a.length>0&&(o=o+"?"+a.join("&")),i.default.post(o,e).then(function(e){return e.data})},e.getAllVariantTrackData=function(e,t,n){return i.default.get(this.apiUrl+"/all_variant_track_data/"+e+"/"+t+"/"+n).then(function(e){return e.data})},e.getVariantTrackData=function(e,t,n,r){return i.default.post(this.apiUrl+"/variant_track_data/"+e+"/"+t+"/"+n,r).then(function(e){return e.data})},e.getIntervalTrackData=function(e,t,n,r){return i.default.post(this.apiUrl+"/interval_track_data/"+e+"/"+t+"/"+n,r).then(function(e){return e.data})},e.getSuggestions=function(e,t,n){var r=this;void 0===n&&(n=100);var o=e+"|"+t+"|"+(n=Math.round(n));return this.suggestionsCache[o]?new Promise(function(e,t){e(r.suggestionsCache[o])}):i.default.post(this.apiUrl+"/suggestions",{term_type:e,search_text:t,max_results:n}).then(function(e){return r.suggestionsCache[o]=e.data.results.slice(0),e.data.results})},e.getUserProfile=function(){return i.default.get(this.apiUrl+"/user_profile").then(function(e){return e.data})},e.parseSiriusBinaryResponse=function(e){for(var t=new Uint8Array(e),n=0,r=0;r<e.byteLength;r++){if(0===t[r]){n=r;break}}return e.slice(n+1)},e.uploadFile=function(e,t,n){void 0===n&&(n=null);var r=new FormData;r.append("file",t),r.append("fileType",e);var o={onUploadProgress:n};return i.default.post(this.apiUrl+"/user_files",r,o)},e.getUserFiles=function(){return i.default.get(this.apiUrl+"/user_files").then(function(e){return e.data})},e.deleteUserFile=function(e){var t={params:{fileID:e}};return i.default.delete(this.apiUrl+"/user_files",t)},e.apiUrl="",e.minMaxCache={},e.suggestionsCache={},e}();t.SiriusApi=a,function(e){e.Float32="f32",e.UInt8="ui8"}(o||(o={}))},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";var r=n(39);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new r(e),t(n.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o(function(t){e=t}),cancel:e}},e.exports=o},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";var r=n(1),o=n(72),i=n(40),a=n(21),s=n(71),l=n(70);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!s(e.url)&&(e.url=l(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||a.adapter)(e).then(function(t){return u(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(u(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(1);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=o},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(o)&&s.push("path="+o),r.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o(){this.message="String contains an invalid character"}o.prototype=new Error,o.prototype.code=5,o.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,n,i=String(e),a="",s=0,l=r;i.charAt(0|s)||(l="=",s%1);a+=l.charAt(63&t>>8-s%1*8)){if((n=i.charCodeAt(s+=.75))>255)throw new o;t=t<<8|n}return a}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(1),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,a={};return e?(r.forEach(e.split("\n"),function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}}),a):a}},function(e,t,n){"use strict";var r=n(1);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var a=[];r.forEach(t,function(e,t){null!==e&&void 0!==e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))}))}),i=a.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";var r=n(41);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,u=[],c=!1,f=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&h())}function h(){if(!c){var e=s(d);c=!0;for(var t=u.length;t;){for(l=u,u=[];++f<t;)l&&l[f].run();f=-1,t=u.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(21),o=n(1),i=n(74),a=n(73);function s(e){this.defaults=e,this.interceptors={request:new i,response:new i}}s.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head","options"],function(e){s.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){s.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=s},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";var r=n(1),o=n(43),i=n(84),a=n(21);function s(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var l=s(a);l.Axios=i,l.create=function(e){return s(r.merge(a,e))},l.Cancel=n(39),l.CancelToken=n(69),l.isCancel=n(40),l.all=function(e){return Promise.all(e)},l.spread=n(68),e.exports=l,e.exports.default=l},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(44),i=function(){function e(){}return e.getMultiple=function(t,n){var r=e.apiUrl+"/"+t;return o.default({method:"get",url:r,headers:{}}).then(function(e){return e.data.reverse().map(n)})},e.getById=function(t,n,r){var i=e.apiUrl+"/"+t+"/"+n;return o.default({method:"get",url:i,headers:{}}).then(function(e){return r(e.data)})},e.getDatasets=function(){return e.getMultiple(f.resource,function(e){return new f(e)})},e.getAnalysis=function(t){return e.getById(c.resource,t,function(e){return new c(e)})},e.getDataset=function(t){return e.getById(f.resource,t,function(e){return new f(e)})},e.getJob=function(t){return e.getById(s.resource,t,function(e){return new s(e)})},e.apiUrl="",e}();t.Api=i;var a=function(){function e(e){this._clientProps=e,this._savedProps=JSON.parse(JSON.stringify(e))}return Object.defineProperty(e.prototype,"name",{get:function(){return this._clientProps.name},set:function(e){this._clientProps.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._clientProps.description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._savedProps._id.$oid},enumerable:!0,configurable:!0}),e.prototype.save=function(){return null},e}(),s=function(e){function t(t){return e.call(this,t)||this}return r(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._savedProps.job_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jobId",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jobType",{get:function(){return this._savedProps.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"auther",{get:function(){return this._savedProps.author},enumerable:!0,configurable:!0}),t.prototype.getDefinition=function(){var e=this;return new Promise(function(t,n){e._savedProps.code?t(e._savedProps.code):i.getJob(e.id).then(function(n){e._savedProps=JSON.parse(JSON.stringify(n._savedProps)),t(e._savedProps.code)})})},t.resource="jobs",t}(a);t.Job=s;var l,u,c=function(e){function t(t){return e.call(this,t)||this}return r(t,e),Object.defineProperty(t.prototype,"analysisId",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"datasetId",{get:function(){return this._savedProps.datasetId.$oid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"analysisType",{get:function(){var e=this._clientProps.analysisType;return u[e]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this._clientProps.code},set:function(e){this._clientProps.code=e},enumerable:!0,configurable:!0}),t.prototype.createRun=function(e){var t=i.apiUrl+"/jobs";return o.default({method:"post",url:t,headers:{},data:{name:e||this.name,code:'import time; print("hello"); time.sleep(10)',type:"RDD",args:""}}).then(function(e){return new s(e.data)})},t.prototype.getRuns=function(e){var t=e?"&withStatus="+e:"",n=i.apiUrl+"/jobs?analysisId="+this.analysisId+t+"}";return o.default({method:"get",url:n,headers:{}}).then(function(e){return e.data.map(function(e){return new s(e)})})},t.resource="analyses",t}(a);t.Analysis=c,function(e){e[e.RUNNING=0]="RUNNING",e[e.FINISHED=1]="FINISHED",e[e.FAILED=2]="FAILED"}(l||(l={})),t.RunStatusType=l,function(e){e[e.JUPYTER=0]="JUPYTER",e[e.PATIENT=1]="PATIENT",e[e.POPULATION=2]="POPULATION",e[e.PARSER=3]="PARSER"}(u||(u={})),t.AnalysisType=u;var f=function(e){function t(t){return e.call(this,t)||this}return r(t,e),Object.defineProperty(t.prototype,"datasetId",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sampleCount",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype.getAnalyses=function(){var e=i.apiUrl+"/analyses?datasetId="+this.datasetId;return o.default({method:"get",url:e,headers:{}}).then(function(e){return e.data.map(function(e){return new c(e)})})},t.prototype.createAnalysis=function(e,t){var n=i.apiUrl+"/analyses";return o.default({method:"post",url:n,headers:{},data:{name:"New Analysis",code:t,analysisType:u[e],datasetId:this.datasetId}}).then(function(e){return new c(e.data)})},t.resource="datasets",t}(a);t.Dataset=f},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(45)),r(n(35)),r(n(34)),r(n(15)),r(n(3)),r(n(33))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(88))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(89)),r(n(61)),r(n(46))}]);
//# sourceMappingURL=index.js.map